"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8707],{3959:function(e,t,r){r.d(t,{r:function(){return a}});var i=r(75766),n=r(68949);class a{setBreakpoint(e){for(let t of(this.breakpoints.push({lineNumber:e}),this.debuggers))t.setBreakpoint(e)}removeBreakpoint(e){for(let t of(this.breakpoints=this.breakpoints.filter(t=>t.lineNumber!==e),this.debuggers))t.removeBreakpoint(e)}setActiveLine(e){this.activeLine=e}addDebugger(e){return this.debuggers.add(e),()=>this.debuggers.delete(e)}constructor(){(0,i._)(this,"activeLine",0),(0,i._)(this,"breakpoints",[]),(0,i._)(this,"debuggers",new Set),(0,n.ky)(this)}}},88707:function(e,t,r){r.d(t,{IK:function(){return b},d$:function(){return v},ir:function(){return p}});var i=r(38966),n=r.n(i),a=r(67090),s=r(98291),d=r(54619),o=r(23928),l=r(95700),u=r(3026),c=r(57564);function m(e){return""!==e?parseInt(e,8):0}var f=r(5301),h=r(3959);let g=a.V5.model({name:a.V5.string,size:a.V5.number,serverId:a.V5.maybe(a.V5.string)}).volatile(()=>({buffer:null,progress:0,modified:!1,uploading:!1,downloading:!1,uploadFailed:!1,abort:new AbortController})).views(e=>({get transferring(){return e.uploading||e.downloading}})).actions(e=>({updateProgress(t){e.progress=t},completeUpload(t){e.uploading=!1,t?e.serverId=t:(e.uploadFailed=!0,e.modified=!1)},setBuffer(t){e.buffer=null!=t?t:null,e.downloading=!1},setPristine(){e.modified=!1}})).actions(e=>({async upload(t,r){if(!e.serverId&&!e.uploading){(0,u.DT)(r).then(t=>e.setBuffer(t)),e.uploading=!0,e.modified=!0;try{let i=await (0,o.cT)(t,r,{abortSignal:e.abort.signal,onProgress:t=>e.updateProgress(t.loaded/t.total)});e.completeUpload(i.fileId)}catch(t){console.error(t),e.completeUpload()}}},async afterCreate(){if(e.serverId){e.downloading=!0;try{let t=await (0,o.Sv)(e.serverId,{abortSignal:e.abort.signal,onProgress:t=>e.updateProgress(t.loaded/e.size)});e.setBuffer(t)}catch(t){console.error(t),e.setBuffer()}}},beforeDestroy(){e.abort.abort()}})),p="sdcard/",v=a.V5.model({name:a.V5.string,content:a.V5.string}).volatile(e=>({originalName:e.name,originalContent:e.content,deleted:!1,editorState:null,errors:[],debugger:new h.r})).views(e=>({get type(){return(0,d.r5)(e.name)},get modified(){return e.content!==e.originalContent||e.originalName!==e.name}})).actions(e=>({update(t){e.content=t},rename(t){e.name=t},setPristine(){e.originalContent=e.content,e.originalName=e.name},setEditorState(t){e.editorState=t}})),b=a.V5.model({name:a.V5.optional(a.V5.string,""),id:a.V5.maybe(a.V5.string),parentId:a.V5.maybe(a.V5.string),files:a.V5.array(v),serverFiles:a.V5.array(g),owner:a.V5.maybe(a.V5.string),ownerUsername:a.V5.maybe(a.V5.string),locked:a.V5.maybe(a.V5.boolean),unlisted:a.V5.optional(a.V5.boolean,!1),updated:a.V5.maybe(a.V5.Date),hearts:a.V5.optional(a.V5.number,0),userLiked:a.V5.optional(a.V5.boolean,!1)}).volatile(()=>({binaryFiles:[],filesDeleted:!1,chips:[],diagramInstance:f.S0.create(),lastDiagramContent:"",tempId:"temp-".concat(Math.random().toString(36).substring(2))})).views(e=>({get diagram(){var t;let r=e.files.find(e=>"diagram"===e.type);if(!r)return null;if((null==r?void 0:r.content)!==e.lastDiagramContent)try{(0,a.Xx)(e.diagramInstance,JSON.parse(null!==(t=null==r?void 0:r.content)&&void 0!==t?t:"null")),e.lastDiagramContent||e.diagramInstance.undoManager.reset()}catch(e){return console.warn("Failed to parse diagram",e),null}return e.diagramInstance},get readme(){return e.files.find(e=>"readme"===e.type)},get modified(){return e.files.some(e=>e.modified)||e.serverFiles.some(e=>e.modified)||e.filesDeleted},findFile:t=>e.files.find(e=>e.name===t),get isDBProject(){return e.id&&/^[0-9]+$/.test(e.id)},get url(){return e.id?(0,d.gd)(e.id):null},get sdCardFiles(){return e.serverFiles.filter(e=>e.name.startsWith(p))}})).views(e=>({chipExists(t){var r;return e.chips.some(e=>e.name===t)||e.files.some(e=>e.name==="".concat(t,".chip.json"))||(null===(r=e.diagram)||void 0===r?void 0:r.dependencies.get("chip-".concat(t,")")))!==void 0},get architecture(){var t,r,i;let n=null===(r=e.diagram)||void 0===r?void 0:null===(t=r.board)||void 0===t?void 0:t.mcuType;return n&&(null===(i=l.v[n])||void 0===i?void 0:i.arch)},get projectType(){var n,a,s,d;let t=null===(a=e.diagram)||void 0===a?void 0:null===(n=a.findMCU())||void 0===n?void 0:n.attrs.get("env"),r=null===(d=e.diagram)||void 0===d?void 0:null===(s=d.findMCU())||void 0===s?void 0:s.attrs.get("builder");if(null==t?void 0:t.startsWith("kaluma"))return"kaluma";if(null==t?void 0:t.startsWith("micropython"))return"micropython";if(null==t?void 0:t.startsWith("circuitpython"))return"circuitpython";if(null==r?void 0:r.includes("rust"))return"rust";if((null==r?void 0:r.includes("sdk"))||(null==t?void 0:t.includes("zephyr")))return"sdk";return"arduino"}})).actions(e=>({addFile(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.files.find(e=>e.name===t);if(n){if(i)return n.update(r),n;throw Error("File ".concat(t," already exists in project"))}let a=e.files.push({name:t,content:r,modified:!0});return e.files[a-1]},addBinaryFile(t,r){e.binaryFiles.push({name:t,content:r})},updateFile(t,r){let i=e.files.find(e=>e.name===t);null==i||i.update(r)},renameFile(t,r){var i;null===(i=e.findFile(t))||void 0===i||i.rename(r),t.endsWith(".ino")&&t===e.name&&(e.name=r)},removeFile(t){let r=e.findFile(t);r&&(r.deleted=!0,e.files.remove(r),e.filesDeleted=!0)},uploadFile(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=i+(0,u.pC)(r),s=e.serverFiles.find(e=>e.name===n);s&&(0,a.ob)(s);let d=g.create({name:n,size:r.size});d.upload(t,r),e.serverFiles.push(d)},removeServerFile(e){(0,a.ob)(e)},setName(t){e.name=t},changeId(t){e.id=t},changeOwner(t){e.owner!==t&&(e.ownerUsername=void 0,e.owner=t)},setPristine(){e.files.forEach(e=>e.setPristine()),e.serverFiles.forEach(e=>e.setPristine()),e.filesDeleted=!1},setLocked(t){e.locked=t},setUnlisted(t){e.unlisted=t},updateHearts(t){e.hearts=t},updateUserLike(t){e.userLiked=t},setChips(t){e.chips=t},setGCCErrors(t,r){for(let t of e.files)t.errors=[];let{errors:i,remainingOutput:n}=(0,s.qK)(t),a=e.files[0];for(let t of Object.keys(i)){let r=e.files.find(e=>e.name===t);r?r.errors=i[t]:a.errors.push(...i[t])}(t=(0,s.zf)(n)).length>0&&!r&&a.errors.push({type:"error",startLineNumber:1,endLineNumber:1,endColumn:1,startColumn:1,message:t})},syncDiagram(){let{diagram:t}=e;if(t){var r,i;e.lastDiagramContent=n()({...i=(0,a.vM)(t),parts:(i.parts||[]).map(e=>{let t={...e};return t.hide||delete t.hide,t.rotate||delete t.rotate,t})},null,2,100),null===(r=e.findFile("diagram.json"))||void 0===r||r.update(e.lastDiagramContent)}return e.diagram}})).actions(e=>({async updateFromServer(t){if(!e.id)return;let{userLiked:r}=await (0,o._L)(t,e.id);e.updateUserLike(r)},async loadEgg(t){let i=r.e(2655).then(r.bind(r,27885)),n=await fetch("https://wokwi.com/api/external/hatchery?egg=".concat(encodeURIComponent(t))),a=await n.arrayBuffer(),s=(await i).inflate(a);for(let t of function*(e){let t=new c.B(e);for(;t.remaining>512;){let e=t.readChars(100),r=m(t.readChars(8)),i=m(t.readChars(8)),n=m(t.readChars(8)),a=m(t.readChars(12)),s=m(t.readChars(12)),d=m(t.readChars(8)),o=t.readChars(1),l=t.readChars(100),u=t.readChars(6),c=t.readChars(2),f="ustar"===u&&"00"===c,h=t.readChars(32),g=t.readChars(32),p=t.readChars(8),v=t.readChars(8),b=t.readChars(155);if(t.skip(12),!e&&!a&&!b)continue;let y=t.readBytes(a);a%512!=0&&t.skip(512-a%512),yield{name:f&&b?"".concat(b,"/").concat(e):e,mode:r,owner:i,group:n,size:a,lastModified:s,checksum:d,type:o,linkName:l,ownerName:f?h:"",groupName:f?g:"",devMajor:f?p:"",devMinor:f?v:"",data:y}}}(s)){let r="app/"+t.name.split("/").slice(1).join("/");if(r.endsWith(".png")||r.endsWith(".mpy"))e.addBinaryFile(r,t.data);else{let i=new TextDecoder().decode(t.data);e.files.find(e=>e.name===r)?e.updateFile(r,i):e.addFile(r,i)}}}}))},98291:function(e,t,r){r.d(t,{qK:function(){return d},zf:function(){return o},GS:function(){return s}});var i=r(20014);let n="/sketch/",a="sketch.ino";function s(e,t){return e.split(n+a).join(t)}function d(e){let t=[...(0,i.parseString)(e),...function(e){let t=/(\n|^)(\/sketch\/[^:/]+\.S):(\d+): (Warning|Error): (.+)(\s*\n|$)/g,r=[],i=t.exec(e);for(;i;)r.push({filename:i[2],line:parseInt(i[3],10),type:i[4].toLowerCase(),text:i[5],column:1,tokenLength:999,startIndex:i.index,endIndex:i.index+i[0].length}),t.lastIndex--,i=t.exec(e);return r}(e)],r={},s=null;r[a]=[],t.sort((e,t)=>e.startIndex==t.startIndex?"note"==e.type?1:-1:e.startIndex-t.startIndex);let d="";for(let i of t){var o,l,u,c;let{filename:t,line:m,column:f,tokenLength:h,text:g,type:p,startIndex:v,endIndex:b}=i,y=e.substring(null!==(u=null===(o=s)||void 0===o?void 0:o.endIndex)&&void 0!==u?u:0,v),C=/\r?\n?.+: In function '.+':\s*$/.exec(y),x=null!==(c=null==C?void 0:null===(l=C[0])||void 0===l?void 0:l.replace(/^\s*/g,""))&&void 0!==c?c:"";if(C&&(y=y.substr(0,C.index)),s?s.message+=y:d=y,"note"===p&&s&&s.startLineNumber===m&&s.startColumn===f){s.message+="\n"+g,s.endIndex=b;continue}if(t.startsWith(n)){let e=t.substring(n.length);s={type:p,startLineNumber:m,endLineNumber:m,startColumn:f,endColumn:f+(h||1),message:x+g,startIndex:v,endIndex:b},r[e]||(r[e]=[]),r[e].push(s)}else{let e=t.replace(/\/arduino\/hardware\/avr\/[0-9.]+\/cores/g,"");r[a].push({type:p,startLineNumber:1,endLineNumber:1,startColumn:1,endColumn:1,message:"".concat(e,":").concat(m,": ").concat(x+g),startIndex:v,endIndex:b})}}return s&&(s.message+=e.substr(s.endIndex).replace(/Error during build: exit status 1/,"").replace(/\s+$/,"")),{errors:r,remainingOutput:d}}function o(e){let t=e.replace(/.+\n.+\n[ \t]*#\s*pragma message "FastLED version 3\.\d+\.\d+".*\n.+/,"").trim();return"Error during build: exit status 1"===t?"":t}},95700:function(e,t,r){r.d(t,{v:function(){return i}});let i={atmega328p:{arch:"avr",family:"avr"},atmega2560:{arch:"avr",family:"avr"},attiny85:{arch:"avr",family:"avr"},esp32:{arch:"xtensa",family:"esp32"},"esp32-s2":{arch:"xtensa",family:"esp32"},"esp32-s3":{arch:"riscv",family:"esp32"},"esp32-c3":{arch:"riscv",family:"esp32"},"esp32-c6":{arch:"riscv",family:"esp32"},"esp32-h2":{arch:"riscv",family:"esp32"},rp2040:{arch:"arm",family:"rp2"},stm32c031c6:{arch:"arm",family:"stm32"},stm32f103c8:{arch:"arm",family:"stm32"},stm32l031k6:{arch:"arm",family:"stm32"},stm32l432kc:{arch:"arm",family:"stm32"}}},57564:function(e,t,r){r.d(t,{B:function(){return n}});var i=r(75766);class n{readUint8(){return this.buf[this.index++]}readUint16(){let{index:e}=this,t=this.buf[e],r=this.buf[e+1];return this.index+=2,r<<8|t}readUint32(){let{index:e}=this,t=this.buf[e],r=this.buf[e+1],i=this.buf[e+2],n=this.buf[e+3];return this.index+=4,(n<<24|i<<16|r<<8|t)>>>0}readInt32(){return 0|this.readUint32()}readBytes(e){let t=this.buf.subarray(this.index,this.index+e);return this.index+=e,t}readChars(e){let t=this.readBytes(e),r=t.indexOf(0);return r>=0&&(t=t.subarray(0,r)),this.decoder.decode(t)}readNullTerminated(){let e=this.buf.indexOf(0,this.index);e<0&&(e=this.buf.length);let t=this.decoder.decode(this.buf.subarray(this.index,e));return this.index=e+1,t}skip(e){this.index+=e}get currentOffset(){return this.index}get remaining(){let e=this.buf.length-this.index;return e>0?e:0}constructor(e){(0,i._)(this,"buf",void 0),(0,i._)(this,"index",void 0),(0,i._)(this,"decoder",void 0),this.buf=e,this.index=0,this.decoder=new TextDecoder}}}}]);