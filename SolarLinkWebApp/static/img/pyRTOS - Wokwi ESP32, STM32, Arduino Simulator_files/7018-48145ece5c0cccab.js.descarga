"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7018],{93735:function(o,h,u){u.d(h,{j:function(){return tU}});let m={getProps:()=>({}),syncInitialState(o){o.dispatchEvent(new InputEvent("input"))},events:{input:o=>{let h=o.target;return{type:"change",x:h.xValue,y:h.yValue}},"button-press":()=>({type:"press"}),"button-release":()=>({type:"release"})}};function w(o){return!!o||void 0}let C={events:{"button-press":()=>({type:"reset-press"}),"button-release":()=>({type:"reset-release"})},getProps:o=>o?{ledPower:w(o.ledPower>.05),led13:w(o.led13>.05),ledRX:w(o.ledRX>.05),ledTX:w(o.ledTX>.05)}:{}},S={getProps(o){var h;return{hasSignal:w(null===(h=o)||void 0===h?void 0:h.playing)}}},P={getProps:()=>({}),syncInitialState(o){let h=()=>o.dispatchEvent(new InputEvent("input"));h();let u=new MutationObserver(o=>{o.forEach(o=>{"attributes"===o.type&&h()})});u.observe(o,{attributes:!0})},events:{input:o=>{let h=o.target;if(h instanceof HTMLElement){let o=parseFloat(h.getAttribute("temperature")||""),u=parseFloat(h.getAttribute("humidity")||"");return{temperature:isNaN(o)?24:o,humidity:isNaN(u)?40:u}}}}},D={getProps:()=>({})},I={getProps:o=>o?{ledPower:w(o.ledPower>.05),led1:w(o.led1>.05)}:{}},N={getProps:o=>o?{ledPower:w(o.ledPower>.05),led1:w(o.led>.05)}:{}},A={getProps:()=>({}),syncInitialState(o){let h=()=>o.dispatchEvent(new InputEvent("input",{detail:parseFloat(o.getAttribute("distance")||"400")}));h();let u=new MutationObserver(o=>{o.forEach(o=>{"attributes"===o.type&&h()})});u.observe(o,{attributes:!0})},events:{input:o=>{let h=o.detail;if(null!=h)return{distance:h}}}},B=128,E=128,U={getProps:()=>({}),applyUpdate(o,h){let u=h.getContext("2d");if(!u)return;let m=u.getImageData(0,0,E,B),{data:w}=m,{pixels:C,invert:S}=o;for(let o=0;o<B;o++)for(let h=0;h<E;h++){let u=C[o*E+h],P=S?~u:u,D=(o*m.width+h)*4;w[D+0]=(63488&P)>>8,w[D+1]=(2016&P)>>3,w[D+2]=(31&P)<<3,w[D+3]=255}u.putImageData(m,0,0)}},O=240,L=320,M={getProps:()=>({}),applyUpdate(o,h){var u;let m=null===(u=h.canvas)||void 0===u?void 0:u.getContext("2d");if(!m)return;let w=m.getImageData(0,0,O,L),{data:C}=w,{pixels:S,invert:P,bgr:D}=o;for(let o=0;o<L;o++)for(let h=0;h<O;h++){let u=S[o*O+h],m=P?~u:u,I=(o*w.width+h)*4,N=(63488&m)>>8,A=(31&m)<<3;C[I+0]=D?N:A,C[I+1]=(2016&m)>>3,C[I+2]=D?A:N,C[I+3]=255}m.putImageData(w,0,0)},simulationStopped(o){var h;let u=null===(h=o.canvas)||void 0===h?void 0:h.getContext("2d");u&&u.clearRect(0,0,O,L)}},V={getProps:()=>({})},F={getProps:()=>({}),events:{"button-press":o=>{if(o instanceof CustomEvent&&"number"==typeof o.detail.irCode)return{address:0,command:o.detail.irCode}}}},J={getProps:()=>({}),events:{"rotate-cw":()=>({type:"rotate-cw"}),"rotate-ccw":()=>({type:"rotate-ccw"}),"button-press":()=>({type:"press"}),"button-release":()=>({type:"release"})}};var W=u(25333),G=u(87933);let H={getProps:o=>o?{cursor:w(o.cursor),blink:w(o.blink),cursorX:o.cursorX,cursorY:o.cursorY}:{},applyUpdate(o,h){h.characters=o.value,h.backlight=o.backlight,h.dataset.lastFont!==o.font&&(h.dataset.lastFont=o.font,h.dataset.cgram="0",h.font="A02"===o.font?G.W:W.G);let u=o.cgramUpdateCount.toString();if(h.dataset.lastCgramUpdate!=u){let m=h.font.slice(0),w=o.cgram.slice(0,64);m.set(w,0),m.set(w,64),h.font=m,h.dataset.cgram=u}},simulationStopped(o){o.characters=new Uint8Array(80).fill(32),o.backlight=!1}},X={getProps:o=>null!=o?{value:w(o>=.01),brightness:o}:{}},Q={getProps:()=>({}),applyUpdate(o,h){if("function"==typeof h.setPixel)for(let u=0;u<o.length;u++){let m=o[u],w=(255&m)/255,C=(m>>8&255)/255,S=(m>>16&255)/255;h.setPixel(u,{r:C,g:S,b:w})}},simulationStopped(o){for(let h=0;h<o.pixels;h++)o.setPixel(h,{r:0,g:0,b:0})}},Z={getProps:o=>o?{samples:o.samples,activeChannels:o.activeChannels}:{}},$={getProps:()=>({}),applyUpdate(o,h){h.updatePixels(o.pixels)},simulationStopped(o){o.updatePixels()}},Y={getProps:()=>({}),events:{"button-press":o=>{if(o instanceof CustomEvent)return{type:"press",row:o.detail.row,column:o.detail.column}},"button-release":o=>{if(o instanceof CustomEvent)return{type:"release",row:o.detail.row,column:o.detail.column}}}},tt={getProps:o=>o?{led1:w(o.ledOn)}:{}},te={getProps(o){var h;let u=null===(h=o)||void 0===h?void 0:h[0];return null!=u?{b:(255&u)/255,r:(u>>8&255)/255,g:(u>>16&255)/255}:{}}};var ti=u(30852);function tn(o,h,u){return"serpentine"===u?(o,u)=>o%2==0?o*h+u:o*h+(h-u-1):(o,u)=>o*h+u}let tr={getProps:()=>({}),applyUpdate(o,h){var u;let m=h.getContext("2d");if(!m)return;let{cols:w,rows:C,pixels:S,layout:P,brightness:D,colorFormat:I}=o,N=tn(C,w,P),A=null!==(u=parseInt(h.dataset.pixsize||"",10))&&void 0!==u?u:1,B="circle"===h.dataset.pixtype,E=h=>isNaN(o.gamma)?h:(h/255)**o.gamma*255;for(let o=0;o<C;o++)for(let h=0;h<w;h++){let u,w,C;let P=S[N(o,h)];if(I===ti.q.RGBA){let o=P>>24&255,h=D*(o/255);u=h*(255&P),w=h*(P>>8&255),C=h*(P>>16&255)}else C=D*E(255&P),u=D*E(P>>8&255),w=D*E(P>>16&255);if(m.fillStyle="rgb(".concat(u,", ").concat(w,", ").concat(C,")"),B){let u=A/2;m.beginPath(),m.ellipse(h*A+u,o*A+u,u,u,0,0,360),m.fill()}else m.fillRect(h*A,o*A,A,A)}},simulationStopped(o){let h=o.getContext("2d");h&&(h.fillStyle="rgb(0, 0, 0)",h.clearRect(0,0,o.width,o.height))}};var ta=u(70413);let to={getProps:()=>({}),applyUpdate(o,h){var u;let m=h.getContext("2d");if(!m)return;let{pixels:w}=o,C="circle"===h.dataset.pixtype,S=null!==(u=parseInt(h.dataset.pixsize||"",10))&&void 0!==u?u:1;for(let o=0;o<ta.Cb;o++)for(let h=0;h<ta.bf;h++){let u=w[o*ta.bf+h],P=255&u,D=u>>8&255,I=u>>16&255;if(m.fillStyle="rgb(".concat(I,", ").concat(D,", ").concat(P,")"),C){let u=S/2;m.beginPath(),m.ellipse(h*S+u,o*S+u,u,u,0,0,360),m.fill()}else m.fillRect(h*S,o*S,S,S)}}},tl={getProps:()=>({}),applyUpdate(o,h){let{cols:u,rows:m,pixels:w,layout:C,brightness:S}=o,P=S/255,D=tn(m,u,C);if("function"==typeof h.setPixel){h.dataset.dirty="true";for(let o=0;o<m;o++)for(let m=0;m<u;m++){let u=w[D(o,m)],C=P*(255&u),S=P*(u>>8&255),I=P*(u>>16&255);h.setPixel(o,m,{r:S,g:I,b:C})}}},simulationStopped(o){if("true"===o.dataset.dirty){for(let h=0;h<o.rows;h++)for(let u=0;u<o.cols;u++)o.setPixel(h,u,{r:0,g:0,b:0});delete o.dataset.dirty}}},th={getProps:()=>({}),applyUpdate(o,h){var u,m;let w=null===(u=(m=h).getPort)||void 0===u?void 0:u.call(m);if(!w||this.lastValue===o)return;this.lastValue=o;let C=new Uint8Array(3*o.length);for(let h=0;h<o.length;h++){let u=o[h],m=255&u,w=u>>8&255,S=u>>16&255;C[3*h]=w,C[3*h+1]=S,C[3*h+2]=m}if(w.writable.locked)console.log("Serial NeoPixel: Skipped a frame");else{h.setTransmitting(!0);let o=w.writable.getWriter();o.write(C).then(()=>{o.releaseLock()})}}},td={getProps:o=>o?{ledPower:w(o.ledOn),ledDO:w(o.ledDigitalOut)}:{}},tu={getProps:o=>o?{led:o.led}:{}},tc={getProps:()=>({min:"0",max:"1023",step:"1"}),syncInitialState(o){o.dispatchEvent(new InputEvent("input",{detail:o.value}))},events:{input:o=>{let h=o.detail;if(null!=h)return{value:h}}}},tp={getProps:()=>({}),syncInitialState(o){o.wokwiListeners||(o.addEventListener("wokwi-keydown",()=>{o.pressed=!0,o.dispatchEvent(new CustomEvent("button-press"))}),o.addEventListener("wokwi-keyup",()=>{o.pressed=!1,o.dispatchEvent(new CustomEvent("button-release"))}),o.wokwiListeners=!0)},events:{"button-press":()=>({type:"press"}),"button-release":()=>({type:"release"})}},tv={getProps:o=>null!=o?{ledRed:o.r,ledGreen:o.g,ledBlue:o.b}:{}},tg={getProps:()=>({}),events:{dial:o=>o instanceof CustomEvent?{type:"dial",digit:o.detail.digit}:null}};var tf=u(75766);class tm{get angle(){return this.servo.angle}set angle(o){this.targetAngle=o,o!==this.angle?null==this.raf&&(this.lastAnimationTime=new Date().getTime(),this.animate()):this.stop()}stop(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}constructor(o){(0,tf._)(this,"servo",void 0),(0,tf._)(this,"rpm",void 0),(0,tf._)(this,"raf",void 0),(0,tf._)(this,"targetAngle",void 0),(0,tf._)(this,"lastAnimationTime",void 0),(0,tf._)(this,"animate",void 0),this.servo=o,this.rpm=60,this.raf=null,this.targetAngle=this.servo.angle,this.lastAnimationTime=0,this.animate=()=>{let o=new Date().getTime(),h=o-this.lastAnimationTime,u=360*h*this.rpm/60/1e3,m=this.targetAngle-this.angle,w=Math.min(Math.abs(m),u);w&&(this.servo.angle=this.angle+w*(m>0?1:-1),this.lastAnimationTime=o),m?this.raf=requestAnimationFrame(this.animate):this.raf=null}}}let t_=Symbol("animator"),tw={getProps:()=>({}),applyUpdate(o,h){h[t_]||(h[t_]=new tm(h)),h[t_].angle=o}},tb={getProps:o=>null!=o?{values:JSON.stringify(o.segments),colonValue:w(o.colon>.05)}:{values:"[]"}},tC={getProps:()=>({}),events:{input:(o,h)=>{let u=o.detail;null!=u&&h.setFloatVar("value",u)}}},tk={getProps:()=>({}),applyUpdate(o,h){h.setPixels(o)},simulationStopped(o){o.setPixels(new Uint32Array(0))}},tS={getProps:()=>({}),applyUpdate(o,h){if(!h)return;let u=h.imageData,{pixels:m,invert:w,displayOn:C,reverseRows:S,scrollOffset:P,startLine:D}=o,{data:I,width:N,height:A}=u;for(let o=0;o<A;o++)for(let h=0;h<N;h++){let B=o+P+D,E=(S?A-1-B:B)%A,U=Math.floor(E/8)*N+h,O=m[U]&1<<E%8?!w:w,L=(o*u.width+h)*4;I.fill(O?255:0,L,L+3),I[L+3]=C?255:0}h.redraw()},simulationStopped(o){var h,u,m;null===(h=o.imageData)||void 0===h||h.data.fill(0),null===(u=(m=o).redraw)||void 0===u||u.call(m)}},tP={getProps:o=>o?{ledPower:o.ledPower,ledRed:o.ledRed,ledGreen:o.ledGreen,ledBlue:o.ledBlue}:{}},tD={getProps:()=>({}),applyUpdate(o,h){let u=h.getContext("2d");if(!u)return;let{pixels:m}=o,w=u.getImageData(0,0,h.clientWidth,h.clientHeight);new Uint32Array(w.data.buffer).set(m),u.putImageData(w,0,0)}},tI={getProps:o=>null!=o?{values:JSON.stringify(o.segments)}:{values:"[]"}},tN={getProps:()=>({}),syncInitialState(o){o.dispatchEvent(new InputEvent("switch-change",{detail:-1}))},events:{"switch-change":o=>({values:o.target.values})}};function tA(o){switch(o.display){case"angle":return{value:o.angle.toFixed(1),units:"degrees"};case"steps":return{value:Math.round(o.steps).toString(),units:"steps"};case"none":return{value:"",units:""}}}let tT={getProps:o=>o?{angle:o.angle,...tA(o)}:{angle:0}},tR={getProps:o=>null!=o?{values:JSON.stringify(o.segments),colonValue:w(o.colon),brightness:o.brightness}:{values:"[]"}},tB={getProps(o){var h,u,m,w;return{outerHandAngle:null!==(m=null===(h=o)||void 0===h?void 0:h.angle1)&&void 0!==m?m:0,innerHandAngle:null!==(w=null===(u=o)||void 0===u?void 0:u.angle2)&&void 0!==w?w:0}}},tE={getProps:o=>o||{}},tU={"wokwi-led":X,"wokwi-buzzer":S,"wokwi-dht22":P,"wokwi-lcd1602":H,"wokwi-lcd2004":H,"wokwi-led-ring":Q,"wokwi-arduino-mega":C,"wokwi-arduino-nano":C,"wokwi-arduino-uno":C,"wokwi-dip-switch-8":tN,"wokwi-esp32-devkit-v1":I,"wokwi-ssd1306":tS,"wokwi-ds1307":D,"wokwi-franzininho":N,"wokwi-hc-sr04":A,"wokwi-ir-receiver":V,"wokwi-ir-remote":F,"wokwi-membrane-keypad":Y,"wokwi-pi-pico":tu,"wokwi-pushbutton":tp,"wokwi-rotary-dialer":tg,"wokwi-7segment":tb,"wokwi-neopixel":te,"wokwi-neopixel-canvas":tr,"wokwi-apa102-matrix":tr,"wokwi-led-matrix":tl,"wokwi-il9163":U,"wokwi-ili9341":M,"wokwi-neopixel-matrix":tl,"wokwi-neopixel-serial":th,"wokwi-servo":tw,"wokwi-slide-switch":tC,"wokwi-splendida":tk,"wokwi-max7219-matrix":$,"wokwi-potentiometer":tc,"wokwi-slide-potentiometer":tc,"wokwi-analog-joystick":m,"wokwi-tv":tD,"wokwi-logic-analyzer":Z,"wokwi-photoresistor-sensor":td,"wokwi-ky-040":J,"wokwi-mpu6050":tt,"wokwi-rgb-led":tv,"wokwi-tinypico":tP,"wokwi-hub75-matrix":to,"wokwi-led-bar-graph":tI,"wokwi-stepper-motor":tT,"wokwi-tm1637-7segment":tR,"wokwi-biaxial-stepper":tB,"wokwi-relay-module":tE}},37018:function(o,h,u){u.d(h,{F:function(){return od},G:function(){return A}});var m,w,C,S,P,D,I,N,A,B=u(75766),E=u(70655),U=u(68949),O=u(67090),L=u(36065),M=u(64306);let V={ili9341:(o,h)=>{let{pixels:u,invert:m,bgr:w}=o,{data:C,width:S,height:P}=h;for(let o=0;o<P;o++)for(let P=0;P<S;P++){let D=u[o*S+P],I=m?~D:D,N=(o*h.width+P)*4,A=(63488&I)>>8,B=(31&I)<<3;C[N+0]=w?A:B,C[N+1]=(2016&I)>>3,C[N+2]=w?B:A,C[N+3]=255}},ssd1306:(o,h)=>{let{pixels:u,invert:m,displayOn:w,reverseRows:C,scrollOffset:S,startLine:P}=o,{data:D,width:I,height:N}=h;for(let o=0;o<N;o++)for(let A=0;A<I;A++){let B=o+S+P,E=(C?N-1-B:B)%N,U=Math.floor(E/8)*I+A,O=u[U]&1<<E%8?!m:m,L=(o*h.width+A)*4;D.fill(O?255:0,L,L+3),D[L+3]=w?255:0}}};function F(o,h){o&&"object"==typeof o.pixels&&o.pixels instanceof Uint8Array&&h.data.set(o.pixels)}function J(o){var h,u;let m={};for(let w of null!==(h=o.displays)&&void 0!==h?h:[])m[w.id]=null!==(u=V[w.chip])&&void 0!==u?u:F;return{applyUpdate(o,h){let{canvases:u}=h;if(u)for(let h of Object.keys(o)){var w;let C=u[h],S=null===(w=C)||void 0===w?void 0:w.getContext("2d"),P=m[h];if(!C||!S||!P)continue;let D=S.getImageData(0,0,C.width,C.height);P(o[h],D),S.putImageData(D,0,0)}},simulationStopped(o){let{canvases:h}=o;if(h)for(let o of Object.values(h)){var u;let h=null===(u=o)||void 0===u?void 0:u.getContext("2d");o&&h&&h.clearRect(0,0,o.width,o.height)}},getProps:o=>o?{ledValues:o}:{}}}var W=u(20050);class G{update(){return this.updated?(this.updated=!1,this._pixels):null}reset(){this._pixels.fill(0)}constructor(o,h=1){(0,B._)(this,"pins",void 0),(0,B._)(this,"pixels",void 0),(0,B._)(this,"_pixels",void 0),(0,B._)(this,"index",void 0),(0,B._)(this,"frame",void 0),(0,B._)(this,"value",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"zeroCounter",void 0),this.pins=o,this.pixels=h,this._pixels=new Uint32Array(this.pixels),this.index=0,this.frame=0,this.value=0,this.updated=!1,this.zeroCounter=0;let u=new W.g({clk:o.clock,mosi:o.data,ss:o.ss});u.onTransmit=o=>{if(o)this.zeroCounter=0;else if(this.zeroCounter++,this.zeroCounter>=4){this.index=0,this.frame=0;return}if(this.frame||(o=o<<3&255|(1&o?7:0)),this.value=this.value<<8|o,3===this.frame){let{index:o,_pixels:h,value:u}=this;o<h.length&&(h[o]=u,this.updated=!0),this.index++,this.frame=0}else this.frame++}}}let H=2;class X{update(){let o=this.apa102Decoder.update();if(o){let h=o[0],u=(h>>>24)/255,m=h>>16&255,w=h>>8&255,C=255&h,S=Math.pow(C/256*u,1/H),P=Math.pow(w/256*u,1/H),D=Math.pow(m/256*u,1/H);return{value:{r:S,g:P,b:D}}}return null}reset(){this.apa102Decoder.reset()}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"apa102Decoder",void 0),this.clock=o,this.apa102Decoder=new G({data:h.get("DI"),clock:h.get("CI")},1)}}(0,B._)(X,"pinNames",["DI","CI","VCC","GND","DO","CO"]);var Q=u(25025),Z=u(96094),$=u(67938),Y=u(34814);let tt=10,te=253;!function(o){o[o.Idle=0]="Idle",o[o.SetWriteCount=1]="SetWriteCount",o[o.SetReadCount=2]="SetReadCount",o[o.Write=3]="Write",o[o.GetReadAvailable=4]="GetReadAvailable",o[o.GetReadLength=5]="GetReadLength",o[o.Read=6]="Read"}(m||(m={}));class ti{onRxByte(o){if(o===tt){if(!this.rxBufIdx)return;let o=new TextDecoder().decode(this.rxBuf.subarray(0,this.rxBufIdx));this.processCommand(o),this.rxBufIdx=0}else this.rxBufIdx<this.rxBuf.length&&(this.rxBuf[this.rxBufIdx++]=o)}sendResponse(o){let h=new TextEncoder().encode(o);this.i2cMode||this.tx.isBusy?this.txQueue.push(...h):(this.tx.transmit(h[0]),this.txQueue.push(...h.subarray(1)))}async processCommand(o){let h=await fetch("https://wokwi.com/api/external/blues?r=".concat(encodeURIComponent(o))),u=await h.json(),m="string"==typeof u?u:JSON.stringify(u);this.sendResponse(m+"\r\n")}update(){return null}reset(){this.rxBufIdx=0,this.txQueue.splice(0,this.txQueue.length)}constructor(o,h,u,w){(0,B._)(this,"clock",void 0),(0,B._)(this,"vars",void 0),(0,B._)(this,"rx",void 0),(0,B._)(this,"tx",void 0),(0,B._)(this,"i2c",void 0),(0,B._)(this,"rxBuf",void 0),(0,B._)(this,"rxBufIdx",void 0),(0,B._)(this,"txQueue",void 0),(0,B._)(this,"i2cMode",void 0),(0,B._)(this,"i2cState",void 0),(0,B._)(this,"i2cWriteCount",void 0),(0,B._)(this,"i2cReadCount",void 0),this.clock=o,this.vars=w,this.rxBuf=new Uint8Array(1024),this.rxBufIdx=0,this.txQueue=[],this.i2cMode=!1,this.i2cState=m.Idle,this.i2cWriteCount=0,this.i2cReadCount=0,this.rx=new $.g(o,h.get("RX_P"),9600),this.tx=new Y.x(o,h.get("TX_P"),9600),this.i2c=new Z.A({scl:h.get("SCL_P"),sda:h.get("SDA_P")},23),this.rx.subscribe(o=>{for(let h of(this.i2cMode=!1,o))this.onRxByte(h)}),this.tx.onTxComplete=()=>{let o=this.txQueue.shift();null!=o&&this.tx.transmit(o)},this.i2c.onConnect=(o,h)=>(this.i2cMode=!0,h?(this.i2cState=m.SetWriteCount,this.i2cReadCount=0):this.i2cState=m.GetReadAvailable,!0),this.i2c.onWriteByte=o=>{switch(this.i2cState){case m.SetWriteCount:return this.i2cWriteCount=o,this.i2cState=o?m.Write:m.SetReadCount,!0;case m.SetReadCount:return this.i2cReadCount=o,this.i2cState=m.Idle,!0;case m.Write:if(this.i2cWriteCount)return this.onRxByte(o),this.i2cWriteCount--,!0;return!1;default:return!1}},this.i2c.onReadByte=()=>{switch(this.i2cState){case m.GetReadAvailable:return this.i2cState=m.GetReadLength,(0,Q.u)(this.txQueue.length-this.i2cReadCount,0,te);case m.GetReadLength:return this.i2cState=m.Read,this.i2cReadCount;case m.Read:var o;if(!this.i2cReadCount)return 0;return this.i2cReadCount--,null!==(o=this.txQueue.shift())&&void 0!==o?o:0;default:return 0}}}}(0,B._)(ti,"pinNames",["VCC","GND","RX_P","TX_P","SCL_P","SDA_P"]);var tn=u(15191);class tr{get frequency(){return 8e7}get ticks(){return this.nanos*this.frequency/1e9}get nanos(){return this.clock.cpuNanos}schedule(o,h){return this.clock.addEvent(h,o),o}unschedule(o){return this.clock.createEvent(o).unschedule(),!0}createEvent(o){return this.clock.createEvent(o)}skipToNextEvent(){}constructor(o){(0,B._)(this,"clock",void 0),this.clock=o}}var ta=u(57564),to=u(54964);let tl="https://wokwi.github.io/firmware-assets/esp-at/esp32-c3-at-2.3.0.0.wokwi";class th{static async downloadAT(){let o=await fetch(tl);return new Uint8Array(await o.arrayBuffer())}async init(o){let{wifi:h}=o,m=u.e(2206).then(u.bind(u,92206));th.snapshotPromise||(th.snapshotPromise=th.downloadAT());let{ESP32C3:w}=await m,C=new w({flashSizeMB:4,clock:new tr(this.clock)});this.loadSnapshot(C,await th.snapshotPromise),this.initUart(C),this.initWiFi(C,h),this.initNVS(C),this.esp32=C,this.clock.addEvent(100,this.next)}initUart(o){o.uart[0].onTX=()=>{o.uart[0].txComplete()};let h=new Y.x(this.clock,this.pins.get("U0TXD")),u=new $.g(this.clock,this.pins.get("U0RXD")),m=o.uart[1];h.baudRate=115200,u.baudRate=115200,m.onTX=o=>{h.transmit(o)},h.onTxComplete=()=>m.txComplete(),u.subscribe(o=>{m.feedByte(o[0])})}initWiFi(o,h){let{wifi:u}=o;o.wifi.setMacAddress(new tn.o("24:0a:c4:00:01:10").bytes),u.onTX=u=>{let{channel:m}=o.wifi;this.clock.addEvent(1e5,()=>{h.medium.transmit({channel:m,data:u})})},h.medium.listen(o=>{u.sendFrame(o.data,(0,to.a)())})}initNVS(o){let h=65536;o.flash.fill(255,h,h+57344),o.flash.set([252,255,255,255,0,0,0,0,254,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,132,45,186,185,250,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,1,255,113,211,175,4,110,118,115,46,110,101,116,56,48,50,49,49,0,0,0,0,1,255,255,255,255,255,255,255,1,1,1,255,61,2,179,83,111,112,109,111,100,101,0,0,0,0,0,0,0,0,0,0,1],h)}update(){return null}reset(){}loadSnapshot(o,h){let u=new ta.B(h);if("WOKWI SNAPSHOT\r\n"!==u.readChars(16))throw Error("Invalid data");let m=u.readUint32();if(m>=65536)throw Error("Invalid data");let w=JSON.parse(u.readChars(m));if(1!==w.v)throw Error("Invalid version");if(w.chip!==o.id)throw Error("Incompatible MCU");for(;u.currentOffset<h.byteLength;){let h=u.readUint32(),m=u.readUint32(),w=u.readUint32();u.readUint32();let C=u.readChars(m),S=u.readBytes(w);switch(C){case"ROM":o.loadROM(S);break;case"FLASH":o.flash.set(S,h);break;case"SRAM":o.sram.data.set(S,h);break;case"IRAM":o.iramCache.data.set(S,h);break;case"MMU":o.mmuTableMemory.data.set(S);break;case"CORE":{let u=o.cores[h];u.restoreStateLegacy(new Uint32Array(new Uint8Array(S).buffer))}}}}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"pins",void 0),(0,B._)(this,"esp32",void 0),(0,B._)(this,"next",void 0),this.clock=o,this.pins=h,this.next=()=>{let o=this.esp32.cores[0];(!o.idle||o.nextInterrupt)&&o.runInstruction(),this.clock.addEvent(100,this.next)}}}(0,B._)(th,"pinNames",["GND","U0TXD","GPIO2","CH_EN","GPIO0","RESET","U0RXD","VCC"]),(0,B._)(th,"snapshotPromise",void 0);var td=u(57121),tu=u(82463),tc=u(25321);let tp=56,tv=256,tg=2,tf=3,tm=4,t_=5,tw=6,tb=7,tC=8,tk=9,tS=14,tP=128,tD=133,tI=134,tN=135,tA=136,tT=137,tR=145,tB=146,tE=147,tU=148,tO=149,tL=150,tM=163,tV=164,tF=165,tJ=166,tW=168,tG=175,tH=188,tq=17,tK=6,tj=[tP,tD,tI,tN,tA,tT,tR,tB,tE,tU,tO,tL,tV,tF,tH];var tz=new WeakMap;class tX{onEvent(o){let h=o.touches.slice(0,2);this.registers[tg]=h.length;for(let o=0;o<h.length;o++){let u=h[o],m=o?tk-tf:0,w=u.x,C=u.y,S="press"===u.eventType?0:"release"===u.eventType?1:2;this.registers[m+tf]=S<<6|w>>8,this.registers[m+tm]=255&w,this.registers[m+t_]=o<<4|C>>8,this.registers[m+tw]=255&C,this.registers[m+tb]=Math.floor(255*u.force),this.registers[m+tC]=128}}update(){return null}reset(){this.addr=0,this.registers.fill(0);for(let o=tf;o<=tS;o++)this.registers[o]=255;this.registers[tP]=40,this.registers[tI]=1,this.registers[tN]=10,this.registers[tA]=8,this.registers[tT]=40,this.registers[tR]=10,this.registers[tB]=25,this.registers[tE]=25,this.registers[tU]=25,this.registers[tO]=25,this.registers[tL]=50,this.registers[tM]=tK,this.registers[tV]=1,this.registers[tF]=0,this.registers[tJ]=16,this.registers[tW]=tq,this.registers[tG]=1,this.registers[tH]=1}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"registers",void 0),(0,B._)(this,"addr",void 0),(0,tu._)(this,tz,{writable:!0,value:void 0}),this.clock=o,this.registers=new Uint8Array(tv),this.addr=0,(0,tc._)(this,tz,!1);let u=new Z.A({scl:h.get("SCL"),sda:h.get("SDA")},tp);this.reset(),u.onConnect=()=>((0,tc._)(this,tz,!0),!0),u.onReadByte=()=>{let o=this.registers[this.addr];return this.addr=(this.addr+1)%tv,o},u.onWriteByte=o=>{if((0,td._)(this,tz))return this.addr=o,(0,tc._)(this,tz,!1),!0;let h=!0,{addr:u}=this;return tj.includes(u)&&(this.registers[u]=o),this.addr=(this.addr+1)%tv,h}}}(0,B._)(tX,"pinNames",["VCC","GND","SCL","SDA","INT"]);let tQ=0,tZ=1,t$=16,tY=17,t0=32,t1=33,t2=38,t5=40,t3=41,t6=42,t8=43,t4=44,t7=45,t9=54,et=58,ee=177,ei=178,es=179,er=180,ea=182,eo=192,eh=193,ed=194,eu=195,ec=196,ep=197,ev=199,eg=224,ef=225,em=242,e_=128,ew=64,eb=32,ey=4,eC={[t2]:1,[t9]:1,[eh]:1,[er]:1,[ep]:2,[ev]:1,[et]:1,[em]:1,[eo]:2,[ed]:2,[eu]:2,[ec]:2,[ea]:2,[ee]:3,[ei]:3,[t6]:4,[t8]:4,[es]:6,[t7]:9,[eg]:15,[ef]:15};class ek{static toRGBA(o,h){let u=240,m=320,{pixels:w,invert:C,bgr:S}=o;for(let o=0;o<m;o++)for(let m=0;m<u;m++){let P=w[o*u+m],D=C?~P:P,I=(o*u+m)*4,N=(63488&D)>>8,A=(31&D)<<3;h[I+0]=S?N:A,h[I+1]=(2016&D)>>3,h[I+2]=S?A:N,h[I+3]=255}}update(){if(!this.updated)return null;{this.updated=!1;let{pixels:o,invert:h,bgr:u}=this;return{value:{pixels:o,invert:h,bgr:u}}}}snapshot(){this.update()}get value(){return""}reset(){this.displayOn=!1,this.activeColumn=0,this.activePage=0,this.columnStart=0,this.columnEnd=239,this.pageStart=0,this.pageEnd=319}processCommand(o,h){if(h&&(this.currentCommandIndex&&!this.commandProcessed&&console.warn("Unknown ILI9341 Command",this.currentCommand[0].toString(16),this.currentCommand.slice(1,this.currentCommandIndex)),this.commandMode=!0,this.commandProcessed=!1,this.currentCommandIndex=0,this.currentCommandLength=1+(eC[o]||0)),this.currentCommand[this.currentCommandIndex]=o,this.currentCommandIndex++,this.currentCommandIndex<this.currentCommandLength||this.commandProcessed)return;let u=this.currentCommand[0];this.commandProcessed=!0;let m=!1;switch(u){case tQ:break;case t$:case t5:this.displayOn=!1,m=!0;break;case tY:case t3:this.displayOn=!0,m=!0;break;case t0:this.invert=!1,m=!0;break;case t1:this.invert=!0,m=!0;break;case t4:this.commandMode=!1,this.highByte=!0;break;case t9:this.bgr=!!(8&this.currentCommand[1]),this.scanningDirection=252&this.currentCommand[1];break;case t6:case t8:{let o=this.currentCommand[1]<<8|this.currentCommand[2],h=this.currentCommand[3]<<8|this.currentCommand[4],m=u===t8;(this.scanningDirection&eb?!m:m)?(this.activePage=o,this.pageStart=o,this.pageEnd=h):(this.activeColumn=o,this.columnStart=o,this.columnEnd=h)}break;case eo:case tZ:case et:case ep:break;default:this.commandProcessed=!1}m&&this.displayOn&&(this.updated=!0)}processData(o){if(this.commandMode){this.processCommand(o,!1);return}if(this.highByte){this.highByte=!1,this.highByteValue=o;return}let h=this.highByteValue<<8|o,u=this.activeColumn,m=this.activePage,w=!!(this.scanningDirection&e_)!=!!(this.scanningDirection&ey),C=!!(this.scanningDirection&ew)==!!(this.scanningDirection&ey);this.scanningDirection&eb?(u=w?this.width-1-u:u,m=C?this.height-1-m:m):(u=C?this.width-1-u:u,m=w?this.height-1-m:m);let S=m*this.width+u;this.pixels[S]=h,this.scanningDirection&eb?(this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart))):(this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart))),this.updated=!0,this.highByte=!0}constructor(o,h){(0,B._)(this,"width",240),(0,B._)(this,"height",320),(0,B._)(this,"pixels",new Uint16Array(this.height*this.width)),(0,B._)(this,"displayOn",!1),(0,B._)(this,"updated",!1),(0,B._)(this,"invert",!1),(0,B._)(this,"bgr",!1),(0,B._)(this,"activeColumn",0),(0,B._)(this,"activePage",0),(0,B._)(this,"columnStart",0),(0,B._)(this,"columnEnd",0),(0,B._)(this,"pageStart",0),(0,B._)(this,"pageEnd",0),(0,B._)(this,"scanningDirection",0),(0,B._)(this,"highByte",!0),(0,B._)(this,"highByteValue",0),(0,B._)(this,"commandMode",!1),(0,B._)(this,"commandProcessed",!1),(0,B._)(this,"currentCommandIndex",0),(0,B._)(this,"currentCommandLength",0),(0,B._)(this,"currentCommand",new Uint8Array(64));let u=h.get("D/C");this.reset();let m=new W.g({mosi:h.get("MOSI"),miso:h.get("MISO"),clk:h.attached("SCK")?h.get("SCK"):h.get("CLK"),ss:h.get("CS")});m.onTransmit=o=>{let h=u.value;return h?this.processData(o):this.processCommand(o,!0),0}}}(0,B._)(ek,"pinNames",["D/C","CS","SCK","MOSI","MISO"]);let eS=2.8;class ex{update(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{updateTime:h,frameNanos:u}=this,m=this.clock.cpuNanos-h,w=this.lastState;if(m<u){var C,S;let{subframes:o}=this;null===(C=(S=this).listener)||void 0===C||C.call(S),w=o.reduce((o,h)=>o+h)/o.length}let P=Math.pow(w,1/this.gamma);if(this.prevValue!==P){let o={value:P};return this.prevValue=P,o}return o?{value:this.lastState}:null}reset(){this.lastState=0}constructor(o,h,u){var m,w,C,S;(0,B._)(this,"clock",void 0),(0,B._)(this,"frameNanos",void 0),(0,B._)(this,"subframeNanos",void 0),(0,B._)(this,"updateTime",void 0),(0,B._)(this,"lastState",void 0),(0,B._)(this,"subframe",void 0),(0,B._)(this,"subframes",void 0),(0,B._)(this,"subframesIndex",void 0),(0,B._)(this,"onTime",void 0),(0,B._)(this,"listener",void 0),(0,B._)(this,"gamma",void 0),(0,B._)(this,"prevValue",void 0),this.clock=o,this.updateTime=0,this.lastState=0,this.subframe=0,this.subframes=new Float64Array(8),this.subframesIndex=0,this.onTime=0,this.prevValue=null;let P=parseFloat(null!==(C=null===(m=u)||void 0===m?void 0:m.get("fps"))&&void 0!==C?C:""),D=P>.1?P:80,I=8;this.frameNanos=Math.floor(1e9/(D/I)),this.subframeNanos=Math.floor(this.frameNanos/I),this.subframe=Math.floor(o.cpuNanos/this.frameNanos);let N=parseFloat(null!==(S=null===(w=u)||void 0===w?void 0:w.get("gamma"))&&void 0!==S?S:"");this.gamma=N>.1?N:eS;let A=h.get("A"),E=h.get("C");if(!A||!E)return;let U=()=>{let o=A.value?1:0,h=E.value?0:1;return A.driven&&E.driven?o*h:0};this.listener=()=>{let{cpuNanos:h}=o,{subframes:u,updateTime:m,lastState:w,subframeNanos:C}=this,S=Math.floor(h/C),P=S-this.subframe;if(P){if(P<u.length){w&&(this.onTime+=C-m%C);let o=this.onTime/C;for(let h=0;h<P;h++)u[this.subframesIndex]=0==h?o:this.lastState,this.subframesIndex=(this.subframesIndex+1)%u.length}else u.fill(w?1:0);this.onTime=w?C-m%C:0}else w&&(this.onTime+=h-m);this.subframe=S,this.lastState=U(),this.updateTime=o.cpuNanos},this.listener(),A.onStateChange(this.listener),E.onStateChange(this.listener)}}(0,B._)(ex,"pinNames",["A","C"]);let eP=128,eD=64,eI=32,eN=33,eA=34,eT=129,eR=141,eB=160,eE=161,eU=164,eO=165,eL=166,eM=167,eV=168,eF=174,eJ=175,eW=192,eG=200,eH=211,eq=213,eK=217,ej=218,ez=219,eX=227,eQ=38,eZ=39,e$=41,eY=42,e0=46,e1=47,e2=163,e5=0,e3=1,e6=2,e8={[eT]:1,[eQ]:6,[eZ]:6,[e$]:5,[eY]:5,[e2]:2,[eI]:1,[eN]:2,[eA]:2,[eV]:1,[eH]:1,[ej]:1,[eq]:1,[eK]:1,[ez]:1,[eR]:1},e4={0:5,1:64,2:128,3:256,4:3,5:4,6:25,7:2},e7=37e4;class e9{update(){if(this.scrollActive&&this.clock.cpuMillis>this.nextScrollTime&&(this.scroll(),this.calculateNextScroll()),this.updated){this.updated=!1;let{pixels:o,invert:h,displayOn:u,reverseRows:m,contrast:w,scrollOffset:C,startLine:S}=this;return{value:{pixels:o,invert:h,displayOn:u,reverseRows:m,contrast:w,scrollOffset:C,startLine:S}}}return null}toImageData(o){let{pixels:h,invert:u,displayOn:m,reverseRows:w,scrollOffset:C,width:S,height:P}=this,{data:D}=o;for(let I=0;I<P;I++)for(let N=0;N<S;N++){let A=I+C,B=(w?P-1-A:A)%P,E=Math.floor(B/8)*S+N,U=h[E]&1<<B%8?!u:u,O=(I*o.width+N)*4;D.fill(U?255:0,O,O+3),D[O+3]=m?255:0}}snapshot(){this.update()}get value(){return""}reset(){this.memoryMode=e6,this.contrast=127,this.clockDivider=1,this.multiplexRatio=63,this.phase1=2,this.phase2=2,this.scrollActive=!1,this.currentCommandIndex=0,this.activeColumn=0,this.columnStart=0,this.columnEnd=127,this.activePage=0,this.pageStart=0,this.pageEnd=7,this.startLine=0,this.invert=!1}i2cConnect(){return this.controlByte=!0,!0}i2cReadByte(){return 255}i2cWriteByte(o){return this.controlByte?(this.commandMode=!(o&eD),this.continuousMode=!(o&eP),this.controlByte=!1):(this.commandMode?this.processCommand(o):this.processData(o),this.continuousMode||(this.controlByte=!0)),!0}processCommand(o){if(this.currentCommand[this.currentCommandIndex]=o,this.currentCommandIndex||(this.currentCommandLength=1+(e8[o]||0)),this.currentCommandIndex++,this.currentCommandIndex<this.currentCommandLength)return;let h=this.currentCommand[0],u=!1;switch(h){case eT:this.contrast=this.currentCommand[1],u=!0;break;case eF:this.displayOn=!1,this.updated=!0;break;case eJ:this.displayOn=!0,this.updated=!0;break;case eL:this.invert=!1,u=!0;break;case eM:this.invert=!0,u=!0;break;case eX:break;case eI:this.memoryMode=3&this.currentCommand[1];break;case eN:this.columnStart=127&this.currentCommand[1],this.columnEnd=127&this.currentCommand[2],this.activeColumn=this.columnStart;break;case eA:this.pageStart=7&this.currentCommand[1],this.pageEnd=7&this.currentCommand[2],this.activePage=this.pageStart;break;case e0:this.scrollOffset=0,this.scrollActive=!1;break;case e1:this.scrollActive=!0,this.calculateNextScroll();break;case eQ:case eZ:this.scrollVertical=!1,this.scrollRight=h===eQ,this.scrollStartPage=7&this.currentCommand[2],this.scrollSpeed=7&this.currentCommand[3],this.scrollEndPage=7&this.currentCommand[4];break;case e$:case eY:this.scrollRight=h===e$,this.scrollStartPage=7&this.currentCommand[2],this.scrollSpeed=7&this.currentCommand[3],this.scrollEndPage=7&this.currentCommand[4],this.verticalOffset=63&this.currentCommand[5],this.scrollVertical=this.verticalOffset>0;break;case eq:this.clockDivider=1+(15&this.currentCommand[1]);break;case eK:this.phase1=15&this.currentCommand[1],this.phase2=this.currentCommand[1]>>4&15;break;case eW:this.reverseRows=!0,u=!0;break;case eG:this.reverseRows=!1,u=!0;break;case eB:this.segmentRemap=!1;break;case eE:this.segmentRemap=!0;break;case eR:case eH:case eV:case ej:case ez:case e2:case eO:case eU:break;default:if(h<=15){this.activeColumn=240&this.activeColumn|h;break}if(h>=16&&h<=31){this.activeColumn=15&this.activeColumn|(15&h)<<4;break}if(h>=64&&h<=127){this.startLine=63&h,u=!0;break}if(h>=176&&h<=183){this.activePage=7&h;break}console.warn("Unknown SSD1306 Command",h.toString(16),this.currentCommand.slice(1,this.currentCommandIndex))}u&&this.displayOn&&(this.updated=!0),this.currentCommandIndex=0}processData(o){let h=this.segmentRemap?this.activeColumn:this.width-1-this.activeColumn,u=this.activePage*this.width+h;switch(this.pixels[u]=o,this.memoryMode){case e5:this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart));break;case e3:this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart));break;default:this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart)}this.updated=!0}i2cDisconnect(){}scroll(){let o=this.width;for(let h=this.scrollStartPage;h<=this.scrollEndPage;h++){let u=h*o;if(this.scrollRight){let h=this.pixels[u+o-1];this.pixels.set(this.pixels.slice(u,u+o-1),u+1),this.pixels[u]=h}else{let h=this.pixels[u];this.pixels.set(this.pixels.slice(u+1,u+o),u),this.pixels[u+o-1]=h}this.updated=!0}this.scrollVertical&&(this.scrollOffset=(this.scrollOffset+this.verticalOffset)%this.height)}get scrollFrameTime(){return 1e3*e4[this.scrollSpeed]/this.frameFrequency}calculateNextScroll(){this.nextScrollTime=this.clock.cpuMillis+this.scrollFrameTime}get frameFrequency(){let o=this.phase1+this.phase2+50;return e7/(this.clockDivider*o*(1+this.multiplexRatio))}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"width",void 0),(0,B._)(this,"height",void 0),(0,B._)(this,"pixels",void 0),(0,B._)(this,"displayOn",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"scrollActive",void 0),(0,B._)(this,"contrast",void 0),(0,B._)(this,"invert",void 0),(0,B._)(this,"reverseRows",void 0),(0,B._)(this,"segmentRemap",void 0),(0,B._)(this,"clockDivider",void 0),(0,B._)(this,"multiplexRatio",void 0),(0,B._)(this,"phase1",void 0),(0,B._)(this,"phase2",void 0),(0,B._)(this,"nextScrollTime",void 0),(0,B._)(this,"activeColumn",void 0),(0,B._)(this,"columnStart",void 0),(0,B._)(this,"columnEnd",void 0),(0,B._)(this,"activePage",void 0),(0,B._)(this,"pageStart",void 0),(0,B._)(this,"pageEnd",void 0),(0,B._)(this,"memoryMode",void 0),(0,B._)(this,"startLine",void 0),(0,B._)(this,"scrollRight",void 0),(0,B._)(this,"scrollVertical",void 0),(0,B._)(this,"scrollStartPage",void 0),(0,B._)(this,"scrollEndPage",void 0),(0,B._)(this,"scrollSpeed",void 0),(0,B._)(this,"verticalOffset",void 0),(0,B._)(this,"scrollOffset",void 0),(0,B._)(this,"controlByte",void 0),(0,B._)(this,"continuousMode",void 0),(0,B._)(this,"commandMode",void 0),(0,B._)(this,"currentCommandIndex",void 0),(0,B._)(this,"currentCommandLength",void 0),(0,B._)(this,"currentCommand",void 0),this.clock=o,this.width=128,this.height=64,this.pixels=new Uint8Array(this.width*this.height/8),this.displayOn=!1,this.updated=!1,this.scrollActive=!1,this.contrast=0,this.invert=!1,this.reverseRows=!1,this.segmentRemap=!1,this.clockDivider=0,this.multiplexRatio=0,this.phase1=0,this.phase2=0,this.nextScrollTime=0,this.activeColumn=0,this.columnStart=0,this.columnEnd=0,this.activePage=0,this.pageStart=0,this.pageEnd=0,this.memoryMode=0,this.startLine=0,this.scrollRight=!1,this.scrollVertical=!1,this.scrollStartPage=0,this.scrollEndPage=0,this.scrollSpeed=0,this.verticalOffset=0,this.scrollOffset=0,this.controlByte=!0,this.continuousMode=!0,this.commandMode=!1,this.currentCommandIndex=0,this.currentCommandLength=0,this.currentCommand=new Uint8Array(8);let m=h.attached("SA0")&&h.get("SA0").value?1:0,w=60|m,C=parseInt(u.get("i2cAddress")||u.get("i2c-address")||"0",16)||w,S=new Z.A({scl:h.attached("SCL")?h.get("SCL"):h.get("CLK"),sda:h.attached("SDA")?h.get("SDA"):h.get("DATA")},C);S.setHandler(this),this.reset(),this.snapshot()}}function it(o,h,u){let m=h(o),w=()=>{let w=h(o);w!==m&&(m=w,u(w))};for(let h of o)h.onValueChange(w);u(m)}(0,B._)(e9,"pinNames",["CLK","DATA","SCL","SDA","SA1"]);var ie=u(37991);class ii{update(){return null}reset(){}constructor(o,h){(0,B._)(this,"clock",void 0),this.clock=o;let u=h.get("IN"),m=h.get("UIO");m.onValueChange(o=>{u.setState(o?ie.J.High:ie.J.Low)}),it([h.get("OUT"),h.get("OE")],o=>{let[h,u]=o;return u.value?h.value?ie.J.High:ie.J.Low:ie.J.HighZ},o=>{m.setState(o)})}}(0,B._)(ii,"pinNames",["IN","OUT","OE","UIO"]);let is=["CLK","RST_N","IN0","IN1","IN2","IN3","IN4","IN5","IN6","IN7"],ir=["RST_N"];class ia{update(){return null}reset(){}constructor(o,h){for(let u of((0,B._)(this,"clock",void 0),this.clock=o,is)){let o=h.get(u),m=h.get("EXT".concat(u));m.setState(ir.includes(u)?ie.J.PullUp:ie.J.PullDown),o.setState(m.value?ie.J.High:ie.J.Low),m.onValueChange(h=>{o.setState(h?ie.J.High:ie.J.Low)})}}}(0,B._)(ia,"pinNames",[...is,...is.map(o=>"EXT".concat(o))]);let io=["OUT0","OUT1","OUT2","OUT3","OUT4","OUT5","OUT6","OUT7"];class il{update(){return null}reset(){}constructor(o,h){for(let u of((0,B._)(this,"clock",void 0),this.clock=o,io)){let o=h.get(u),m=h.get("EXT".concat(u));m.setState(o.value?ie.J.High:ie.J.Low),o.onValueChange(o=>{m.setState(o?ie.J.High:ie.J.Low)})}}}(0,B._)(il,"pinNames",[...io,...io.map(o=>"EXT".concat(o))]);let ih=400,iu=800,ic=850,ip=450,iv=230,ig=5e4;class im{checkLastBit(){23===this.bitIndex&&(this._pixels[this.pixelIndex]=this.currentValue|(this.detectOne?1:0),this.pendingUpdate=!0)}feedBit(o){if(o&&(this.currentValue|=1<<23-this.bitIndex),this.bitIndex++,24===this.bitIndex&&(this._pixels[this.pixelIndex++]=this.currentValue,this.pendingUpdate=!0,this.bitIndex=0,this.currentValue=0),this.pixelIndex>=this.pixels.length)for(let o of(this.overflow=!0,this.listeners))o(this._pixels)}resetState(){this.detectZero=!1,this.detectOne=!1,this.overflow=!1,this.bitIndex=0,this.currentValue=0,this.pixelIndex=0}reset(){this.resetState(),this.pendingUpdate=!1,this.lastUpdated=0,this.updated=!1}update(){if(this.lastUpdated<this.clock.cpuNanos&&(this.lastUpdated=this.clock.cpuNanos,this.updated=this.pendingUpdate,this.pendingUpdate)){let o=this.clock.cpuNanos-this.lastTimestamp;!this.overflow&&23===this.bitIndex&&this.detectZero&&!this.lastState&&o>=ic-iv&&(this._pixels[this.pixelIndex]=this.currentValue),this.pendingUpdate=!1}return this.updated?this._pixels:null}resize(o){if(this._pixels.length<o){let h=new Uint32Array(o);h.set(this._pixels),this._pixels=h}}subscribe(o){return this.listeners.add(o),()=>this.listeners.delete(o)}get pixels(){return this._pixels}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"_pixels",void 0),(0,B._)(this,"pixelIndex",void 0),(0,B._)(this,"currentValue",void 0),(0,B._)(this,"bitIndex",void 0),(0,B._)(this,"lastState",void 0),(0,B._)(this,"lastTimestamp",void 0),(0,B._)(this,"detectZero",void 0),(0,B._)(this,"detectOne",void 0),(0,B._)(this,"overflow",void 0),(0,B._)(this,"pendingUpdate",void 0),(0,B._)(this,"lastUpdated",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"listeners",void 0),this.clock=h,this._pixels=new Uint32Array(1),this.pixelIndex=0,this.currentValue=0,this.bitIndex=0,this.lastState=!1,this.lastTimestamp=0,this.detectZero=!1,this.detectOne=!1,this.overflow=!1,this.pendingUpdate=!1,this.lastUpdated=0,this.updated=!1,this.listeners=new Set,o.onValueChange(o=>{let m=h.cpuNanos-this.lastTimestamp;!this.overflow&&this.lastState&&(m>=ih-iv&&m<=ih+iv&&(this.detectZero=!0),m>=iu-iv&&m<=iu+iv&&(this.detectOne=!0),this.checkLastBit()),this.lastState||(this.detectZero&&m>=ic-iv?this.feedBit(0):this.detectOne&&m>=ip-iv&&this.feedBit(1),m>=ig&&this.resetState(),this.detectZero=!1,this.detectOne=!1),this.overflow&&u&&u.setState(o?ie.J.High:ie.J.Low),this.lastState=o,this.lastTimestamp=h.cpuNanos})}}let i_=2;class iw{update(){let o=this.decoder.update();if(o){let h=o[0],u=(255&h)/255,m=(h>>8&255)/255,w=(h>>16&255)/255,C=Math.pow(m,1/i_),S=Math.pow(w,1/i_),P=Math.pow(u,1/i_);return{value:{r:C,g:S,b:P}}}return null}reset(){this.decoder.reset()}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"decoder",void 0),this.clock=o;let u=h.attached("DO")?h.get("DO"):void 0;this.decoder=new im(h.get("DI"),o,u)}}(0,B._)(iw,"pinNames",["DI","VCC","DO"]);let ib={"0603":ex,apa102:X,ws2812:iw},iy={ssd1306:e9,ili9341:ek},iC={ft6206:tX};function ik(o,h){var u;function m(o,u){let m=new Map;for(let{name:o,target:w}of h){let[h,C]=w.split(":");h===u&&C&&m.set(C,o)}return{get(h){var w;return o.get(null!==(w=m.get(h))&&void 0!==w?w:"".concat(u,":").concat(h))},attached(h){let u=m.get(h);return!!u&&o.attached(u)}}}return u=class{onEvent(o){for(let{id:m,controller:w}of this.controllers)if(m===o.id){var h,u;null===(h=(u=w).onEvent)||void 0===h||h.call(u,o)}}async init(o){await Promise.all(this.controllers.map(h=>{var u,m;let{controller:w}=h;return null===(u=(m=w).init)||void 0===u?void 0:u.call(m,o)}))}update(){let o=!1;for(let{id:h,controller:u}of this.controllers){let m=u.update();m&&(this.values[h]=m.value,o=!0)}return o?{value:this.values}:null}reset(o){for(let{controller:h}of this.controllers)h.reset(o)}constructor(h,u,w,C,S){var P,D,I;(0,B._)(this,"clock",void 0),(0,B._)(this,"controllers",void 0),(0,B._)(this,"values",void 0),this.clock=h,this.controllers=[],this.values={};let N=new Map;for(let h of null!==(P=o.leds)&&void 0!==P?P:[]){let o={get(o){var m;return u.get(null!==(m=h.pins[o])&&void 0!==m?m:"".concat(h.id,":").concat(o))},attached(o){let m=h.pins[o];return!!m&&u.attached(m)}},m=ib[h.type];m&&this.controllers.push({id:h.id,controller:new m(this.clock,o,N,C,S)})}for(let h of null!==(D=o.chips)&&void 0!==D?D:[]){switch(h.type){case"tinytapeout-input":{let o=m(u,h.id);this.controllers.push({id:h.id,controller:new ia(this.clock,o)});break}case"tinytapeout-output":{let o=m(u,h.id);this.controllers.push({id:h.id,controller:new il(this.clock,o)});break}case"tinytapeout-bidirectional-io":{let o=m(u,h.id);this.controllers.push({id:h.id,controller:new ii(this.clock,o)});break}case"blues-notecard":{let o=m(u,h.id);this.controllers.push({id:h.id,controller:new ti(this.clock,o,N,C)});break}case"esp-01":{let o=m(u,h.id);this.controllers.push({id:h.id,controller:new th(this.clock,o)})}}if(h.type.startsWith("github:")){let o=m(u,h.id),P=S[h.type];if(P){let u=new Map;for(let[o,m]of w.entries())if(o.includes(".")){let[w,C]=o.split(".");w===h.id&&u.set(C,m)}else u.set(o,m);this.controllers.push({id:h.id,controller:new P(this.clock,o,u,C,S)})}}}for(let P of null!==(I=o.displays)&&void 0!==I?I:[]){let o=iy[P.chip];if(!o)continue;let D=new o(h,m(u,P.id),w,C,S);if(this.controllers.push({id:P.id,controller:D}),P.touch){let o=iC[P.touch.chip];if(!o)continue;let w=new o(h,m(u,P.touch.id),N,C,S);this.controllers.push({id:P.touch.id,controller:w})}}}},(0,B._)(u,"pinNames",Object.keys(o.pins)),u}let iS={"esp32-s2":{intentctf:{firmware:"https://urish.github.io/intent-ctf-firmware/intent-ctf-$VERSION.bin",defaultVersion:"1.0.0"}}};function ix(o){if("GND"===o)return M.bq;if(o.startsWith("power(")){let h=parseFloat(o.split(/[()]/)[1]);return{type:"power",voltage:h}}return o}function iP(o,h,u){let m=(0,L.Qc)(h),w=[];for(let[o,{target:h}]of Object.entries(m.pins))if("string"==typeof h)w.push({name:o,target:h});else if(h instanceof Array)for(let u=0;u<h.length;u++)w.push({name:o,target:h[u]});if(m.mcu){var C,S;function P(o){var h,u,w;return null!==(w=null===(u=m.environments)||void 0===u?void 0:null===(h=u[o])||void 0===h?void 0:h.fqbn)&&void 0!==w?w:m.fqbn}let h=null!==(C=iS[m.mcu])&&void 0!==C?C:{};M.tj[o]={name:m.name,mcuType:m.mcu,hexiBoard:P,pins:w.map(o=>{let{name:h,target:u}=o;return{name:h,target:ix(u)}}),environments:{...h,...null!==(S=m.environments)&&void 0!==S?S:{}}},M.dH.push(o)}let D=u.startsWith("https://")?u:URL.createObjectURL(new Blob([u],{type:"image/svg+xml"}));return{board:m,svgURL:D,adapter:J(m),controller:ik(m,w)}}var iD=u(93735);let iI={0:16,1:8,2:4,3:2,4:1,5:1,6:1,7:1},iN=[[1,1,0],[-1,1,1],[-1,-1,0],[1,-1,1]];class iA{update(){return null}home(){this.stepIndex=8}reset(){this.home()}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"stepIndex",void 0),(0,B._)(this,"microsteps",void 0),(0,B._)(this,"enable",void 0),(0,B._)(this,"amValue",void 0),(0,B._)(this,"apValue",void 0),(0,B._)(this,"bmValue",void 0),(0,B._)(this,"bpValue",void 0),this.clock=o,this.stepIndex=8,this.microsteps=16,this.enable=!1,this.amValue=ie.J.Low,this.apValue=ie.J.Low,this.bmValue=ie.J.Low,this.bpValue=ie.J.Low;let u=h.get("1A"),m=h.get("1B"),w=h.get("2B"),C=h.get("2A"),S=h.get("MS1"),P=h.get("MS2"),D=h.get("MS3"),I=h.get("STEP"),N=h.get("DIR"),A=h.get("RESET"),E=h.get("SLEEP"),U=h.get("ENABLE");S.state=ie.J.PullDown,P.state=ie.J.PullDown,D.state=ie.J.PullDown,E.state=ie.J.PullUp,U.state=ie.J.PullDown;let O=()=>{m.state=this.enable?this.amValue:ie.J.HighZ,u.state=this.enable?this.apValue:ie.J.HighZ,C.state=this.enable?this.bmValue:ie.J.HighZ,w.state=this.enable?this.bpValue:ie.J.HighZ},L=()=>{let o=15&this.stepIndex,[h,u,m]=iN[this.stepIndex>>4&3],w=m?o>3:o<12,C=m?o<12:o>3;this.apValue=h>=0?ie.J.High:ie.J.Low,this.amValue=w?h>=0?ie.J.Low:ie.J.High:this.apValue,this.bpValue=u>=0?ie.J.High:ie.J.Low,this.bmValue=C?u>=0?ie.J.Low:ie.J.High:this.bpValue};I.onValueChange(o=>{if(o){let o=N.value;this.stepIndex=(this.stepIndex+(o?this.microsteps:-this.microsteps)+64)%64,L(),O()}}),L(),it([A,E],()=>!A.value||!E.value,o=>{o&&this.home()}),it([A,E,U],()=>E.value&&A.value&&!U.value,o=>{this.enable=o,O()}),it([S,P,D],()=>(D.value?4:0)|(P.value?2:0)|(S.value?1:0),o=>{this.microsteps=iI[o]})}}(0,B._)(iA,"pinNames",["ENABLE","MS1","MS2","MS3","RESET","SLEEP","STEP","DIR","GND","VDD","1B","1A","2A","2B","GND","VMOT"]);class iT{get connected(){return this.connectedValue}set connected(o){if(this.connectedValue!==o){let{pin1:h,pin2:u}=this;this.connectedValue=o,o?(h.node.bridges.add(u),u.node.bridges.add(h),h.node.updateBridges()):(h.node.bridges.delete(u),u.node.bridges.delete(h),h.node.updateBridges(),u.node.updateBridges())}}constructor(o,h,u=!1){(0,B._)(this,"pin1",void 0),(0,B._)(this,"pin2",void 0),(0,B._)(this,"connectedValue",void 0),this.pin1=o,this.pin2=h,this.connectedValue=!1,this.connectedValue=u}}var iR=new WeakMap;class iB{get connected(){return this.state}set connected(o){if(o===this.state)return;if(this.state=o,0===this.clock.cpuNanos){this.bridge.connected=o;return}let h=22e5,u=1+2*Math.floor(100*Math.random()),m=2*h/u,w=66,C=0;for(let o=0;o<u;o++)C+=w+Math.round(Math.random()*(m-w)),this.clock.addEvent(C,this.toggle);(0,tc._)(this,iR,C+w)}get bounceDuration(){return(0,td._)(this,iR)}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"bridge",void 0),(0,B._)(this,"state",void 0),(0,tu._)(this,iR,{writable:!0,value:void 0}),(0,B._)(this,"toggle",void 0),this.clock=o,this.bridge=h,this.state=!1,(0,tc._)(this,iR,0),this.toggle=()=>{this.bridge.connected=!this.bridge.connected}}}function iE(o,h,u,m){let w=new iT(h,u);return m?new iB(o,w):w}class iU{onEvent(o){let{bridge:h}=this;switch(o.type){case"press":h&&(h.connected=!0);break;case"release":h&&(h.connected=!1);break;case"change":this.horz.node.analogPort.writeNormalized(.5+o.x/2),this.vert.node.analogPort.writeNormalized(.5+o.y/2)}}update(){return null}reset(){}constructor(o,h,u){(0,B._)(this,"bridge",void 0),(0,B._)(this,"horz",void 0),(0,B._)(this,"vert",void 0);let m=h.get("SEL"),w=h.get("GND"),C="0"!==u.get("bounce");this.vert=h.get("VERT"),this.horz=h.get("HORZ"),this.bridge=iE(o,m,w,C)}}(0,B._)(iU,"pinNames",["VCC","VERT","HORZ","SEL","GND"]);var iO=u(30852);class iL{update(){let o=this.apa102Decoder.update();return o?{value:{pixels:o.slice(0,this.rows*this.cols),rows:this.rows,cols:this.cols,brightness:this.brightness,layout:this.layout,colorFormat:iO.q.RGBA}}:null}reset(){this.apa102Decoder.reset()}constructor(o,h,u){var m;(0,B._)(this,"clock",void 0),(0,B._)(this,"apa102Decoder",void 0),(0,B._)(this,"rows",void 0),(0,B._)(this,"cols",void 0),(0,B._)(this,"layout",void 0),(0,B._)(this,"brightness",void 0),this.clock=o,this.rows=parseInt(u.get("rows")||"8",10)||8,this.cols=parseInt(u.get("cols")||"8",10)||8,this.layout=u.get("matrixLayout")||"";let w=parseFloat(null!==(m=u.get("matrixBrightness"))&&void 0!==m?m:"1");this.brightness=w>=.01?w:1;let C=this.rows*this.cols;this.apa102Decoder=new G({data:h.get("DI"),clock:h.get("CI")},C)}}(0,B._)(iL,"pinNames",["DI","CI","VCC","GND","DO","CO"]);class iM{onEvent(o){switch(o.type){case"reset-press":this.resetBridge.connected=!0;break;case"reset-release":this.resetBridge.connected=!1}}update(){let o=this.led13Controller.update();o&&(this.value.led13=o.value,this.updated=!0);let h=this.txController.update();h&&(this.value.ledTX=h.value,this.updated=!0);let u=this.rxController.update();u&&(this.value.ledRX=u.value,this.updated=!0);let m=this.updated?{value:{...this.value}}:null;return this.updated=!1,m}reset(o){this.led13Controller.reset(),this.txController.reset(),this.rxController.reset(),this.value.led13=0,this.value.ledRX=0,this.value.ledTX=0,o&&(this.value.ledPower=0),this.updated=!0}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"led13Controller",void 0),(0,B._)(this,"rxController",void 0),(0,B._)(this,"txController",void 0),(0,B._)(this,"resetBridge",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.updated=!0,this.value={ledPower:1,ledRX:0,ledTX:0,led13:0};let u=new Map;u.set("A",h.get("13")),u.set("C",h.get("GND")),this.led13Controller=new ex(this.clock,u);let m=new Map;m.set("A",h.get("5V")),m.set("C",h.get("0")),this.rxController=new ex(this.clock,m);let w=new Map;w.set("A",h.get("5V")),w.set("C",h.get("1")),this.txController=new ex(this.clock,w),this.resetBridge=iE(o,h.get("GND"),h.get("RESET"),!1)}}(0,B._)(iM,"pinNames",["0","1","13","GND","5V","RESET"]);class iV{get(o){var h;return this.pins.get(null!==(h=this.pinMap[o])&&void 0!==h?h:o)}attached(o){var h;return this.pins.attached(null!==(h=this.pinMap[o])&&void 0!==h?h:o)}constructor(o,h){(0,B._)(this,"pins",void 0),(0,B._)(this,"pinMap",void 0),this.pins=o,this.pinMap=h}}let iF=0,iJ=16384,iW=32768,iG=49152,iH=200,iq=5e3,iK=Math.round(1e9/(iq/60*iH));function ij(o,h){let u=o<h?o:h,m=o>h?o:h,w=u+65536-m<m-u;return Math.round(w?(u+65536+m)/2:(u+m)/2)}function iz(o){return!isNaN(o)&&o>1e-9}class iX{finishStep(){let{nextDelta:o,changeTime:h}=this;if(o){let u=this.clock.cpuNanos-h,m=Math.round(o*Math.min(u/iK,1));this.steps+=m/16384,this.toffset=this.toffset+m&65535,this.updated=!0,this.nextDelta-=m}}update(){if(this.finishStep(),this.updated){let{steps:o}=this,h=o*this.gearRatio;return this.updated=!1,{value:{steps:o,angle:h/iH*360%360,display:this.display}}}return null}reset(){this.updated=!0}constructor(o,h,u){var m,w,C=this;(0,B._)(this,"clock",void 0),(0,B._)(this,"display",void 0),(0,B._)(this,"gearRatio",void 0),(0,B._)(this,"steps",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"toffset",void 0),(0,B._)(this,"nextDelta",void 0),(0,B._)(this,"changeTime",void 0),(0,B._)(this,"event",void 0),this.clock=o,this.display="none",this.gearRatio=1,this.steps=0,this.updated=!0,this.toffset=ij(iF,iG),this.nextDelta=0,this.changeTime=-1,this.event=o.createEvent(()=>this.finishStep());let S=h.get("A-"),P=h.get("A+"),D=h.get("B-"),I=h.get("B+"),N=function(){let h=arguments.length>0&&void 0!==arguments[0]&&arguments[0],u=S.driven&&P.driven&&S.value!==P.value,m=D.driven&&I.driven&&D.value!==I.value,w=P.value?iF:iW,N=I.value?iJ:iG,A=u&&m?ij(w,N):u?w:N;if(C.finishStep(),u||m){let{toffset:u}=C,m=A-u&65535,w=u-A&65535,S=m<w?m:-w;h?C.toffset=A:(C.nextDelta=S,C.changeTime=o.cpuNanos,C.event.schedule(iK))}};for(let o of[S,P,D,I])o.onStateChange(N);N(!0);let A=null!==(m=u.get("display"))&&void 0!==m?m:"";switch(A){case"angle":this.display=A;break;case"steps":case"":this.display="steps";break;default:this.display="none"}let E=null!==(w=u.get("gearRatio"))&&void 0!==w?w:"";if(E.includes(":")){let o=E.split(":"),h=o.map(o=>parseFloat(o));iz(h[0])&&iz(h[1])&&(this.gearRatio=h[1]/h[0])}else{let o=parseFloat(E);iz(o)&&(this.gearRatio=o)}}}(0,B._)(iX,"pinNames",["A-","A+","B-","B+"]);class iQ{update(){let o=this.stepper1.update(),h=this.stepper2.update();if(o&&(this.value.angle1=o.value.angle),h){var u;this.value.angle2=null===(u=h)||void 0===u?void 0:u.value.angle}return o||h?{value:this.value}:null}reset(){this.stepper1.reset(),this.stepper2.reset()}constructor(o,h){(0,B._)(this,"stepper1",void 0),(0,B._)(this,"stepper2",void 0),(0,B._)(this,"value",{angle1:0,angle2:0});let u=new iV(h,{"A-":"A1-","A+":"A1+","B-":"B1-","B+":"B1+"});this.stepper1=new iX(o,u,new Map);let m=new iV(h,{"A-":"A2-","A+":"A2+","B-":"B2-","B+":"B2+"});this.stepper2=new iX(o,m,new Map)}}(0,B._)(iQ,"pinNames",["A1-","A1+","B1-","B1+","A2-","A2+","B2-","B2+"]);let iZ=10;class i${setVolume(o){this.gainNode.gain.value=o}feed(o){if(this.prevValue===o)return;let h=this.clock.cpuNanos/1e9,{sampleRate:u}=this.context,m=Math.floor(h*u)-this.playedSamples;m-this.lastSample>u/20?(this.lastSample=m,m=0):this.lastSample=m,m>this.chunk.length&&(this.playedSamples+=this.chunk.length,this.node=new AudioBufferSourceNode(this.context,{buffer:this.chunkBuffer}),this.node.connect(this.gainNode),this.node.start(),m%=this.chunk.length,this.chunkBuffer=new AudioBuffer({length:u/iZ,numberOfChannels:1,sampleRate:u}),this.chunk=this.chunkBuffer.getChannelData(0),this.chunk.fill(this.prevValue,0,m)),this.chunk.fill(o,m),this.prevValue=o,this.active=!0}update(){let{active:o}=this;return(this.active=!1,o!==this.lastValue)?(this.lastValue=o,{playing:o}):null}reset(){}pause(){}resume(){}constructor({pin1:o,pin2:h,volume:u,clock:m}){var w,C,S,P;(0,B._)(this,"clock",void 0),(0,B._)(this,"context",new AudioContext),(0,B._)(this,"gainNode",this.context.createGain()),(0,B._)(this,"chunkBuffer",new AudioBuffer({length:this.context.sampleRate/iZ,numberOfChannels:1,sampleRate:this.context.sampleRate})),(0,B._)(this,"chunk",this.chunkBuffer.getChannelData(0)),(0,B._)(this,"node",null),(0,B._)(this,"prevValue",0),(0,B._)(this,"playedSamples",0),(0,B._)(this,"lastSample",0),(0,B._)(this,"active",!1),(0,B._)(this,"lastValue",!1),(0,B._)(this,"value",null),this.clock=m,this.gainNode.connect(this.context.destination),u>.01&&this.setVolume(u),this.prevValue=(null===(w=o)||void 0===w?void 0:w.value)!==!!(null===(C=h)||void 0===C?void 0:C.value)?1:0,null===(S=o)||void 0===S||S.onValueChange(()=>{var u;this.feed(!!(null===(u=h)||void 0===u?void 0:u.value)!==o.value?1:0)}),null===(P=h)||void 0===P||P.onValueChange(()=>{var u;this.feed(!!(null===(u=o)||void 0===u?void 0:u.value)!==h.value?1:0)})}}class iY{setVolume(o){this.gainNode.gain.value=o}feed(o){if(o===this.lastValue)return;this.lastValue=o;let h=this.clock.cpuNanos/1e9,u=Math.round(1/(h-this.prevTime));if(this.prevTime=this.lastTime,this.lastTime=h,u<20){this.oscillator&&(this.oscillator.stop(),this.oscillator=null);return}let m=Math.abs(u-this.freq),w=Math.abs(this.freq-this.prevFreq);this.prevFreq=this.freq,this.freq=u,m<10&&w<10&&(this.oscillator?this.oscillator.frequency.setValueAtTime(u,this.context.currentTime):(this.oscillator=new OscillatorNode(this.context,{type:"square",frequency:u}),this.oscillator.connect(this.gainNode),this.oscillator.start()))}update(){let o=this.clock.cpuNanos/1e9;this.oscillator&&o-this.lastTime>.05&&this.oscillator&&(this.oscillator.stop(),this.oscillator=null);let h=this.lastTime>=0&&o-this.lastTime<.5;return this.playing!==h?(this.playing=h,{playing:h}):null}reset(){this.pause(),this.freq=0,this.playing=!1,this.lastTime=0,this.lastValue=null}pause(){this.oscillator?(this.freq=this.oscillator.frequency.value,this.oscillator.stop(),this.oscillator=null):this.freq=0}resume(){this.freq&&!this.oscillator&&(this.oscillator=new OscillatorNode(this.context,{type:"square",frequency:this.freq}),this.oscillator.connect(this.gainNode),this.oscillator.start())}constructor({pin1:o,pin2:h,volume:u,clock:m}){var w,C,S,P;(0,B._)(this,"context",new AudioContext),(0,B._)(this,"gainNode",this.context.createGain()),(0,B._)(this,"clock",void 0),(0,B._)(this,"prevTime",0),(0,B._)(this,"lastTime",0),(0,B._)(this,"freq",0),(0,B._)(this,"prevFreq",0),(0,B._)(this,"oscillator",null),(0,B._)(this,"lastValue",null),(0,B._)(this,"playing",!1),(0,B._)(this,"value",null),this.clock=m,this.gainNode.connect(this.context.destination),u>.01&&this.setVolume(u),this.lastValue=(null===(w=o)||void 0===w?void 0:w.value)!==!!(null===(C=h)||void 0===C?void 0:C.value)?1:0,null===(S=o)||void 0===S||S.onValueChange(()=>{var u;this.feed(!!(null===(u=h)||void 0===u?void 0:u.value)!==o.value?1:0)}),null===(P=h)||void 0===P||P.onValueChange(()=>{var u;this.feed(!!(null===(u=o)||void 0===u?void 0:u.value)!==h.value?1:0)})}}class i0{update(){let o=this.backend.update();return o?{value:o}:null}reset(){this.backend.reset()}pause(){this.backend.pause()}resume(){this.backend.resume()}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"backend",void 0),this.clock=o;let m={clock:o,volume:parseFloat(u.get("volume")||"1"),pin1:h.get("1"),pin2:h.get("2")},w=u.get("mode");this.backend="accurate"===w?new i$(m):new iY(m)}}(0,B._)(i0,"pinNames",["1","2"]);var i1=u(79838);class i2{update(){return null}reset(){}constructor(o,h,u){var m;(0,B._)(this,"clock",void 0),this.clock=o;let w=h.get("CLK"),C=(0,i1.Z)(null!==(m=u.get("frequency"))&&void 0!==m?m:"0")||1e4,S=1e9/C/2,P=!1;w.state=ie.J.Low;let D=o.createEvent(()=>{P=!P,w.state=P?ie.J.High:ie.J.Low,D.schedule(S)});D.schedule(S)}}(0,B._)(i2,"pinNames",["CLK"]);let i5=1e3,i3=1e3*i5,i6=1e3*i3;class i8{reset(){}update(){return this.updated?(this.updated=!1,{value:{ledPower:1,led1:this.pinIn.value?1:0}}):null}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"pinIn",void 0),(0,B._)(this,"bridgeNO",void 0),(0,B._)(this,"bridgeNC",void 0),this.clock=o,this.updated=!0,this.pinIn=h.get("IN");let m=h.get("NO"),w=h.get("NC"),C=h.get("COM");this.bridgeNO=iE(o,m,C,!1),this.bridgeNC=iE(o,w,C,!1);let S="pnp"===u.get("transistor"),P=o.createEvent(()=>{let o=this.pinIn.value!==S;o?(this.bridgeNO.connected=!0,this.bridgeNC.connected=!1):(this.bridgeNO.connected=!1,this.bridgeNC.connected=!0)});this.pinIn.onValueChange(()=>{P.schedule(5*i3),this.updated=!0}),P.schedule(1)}}(0,B._)(i8,"pinNames",["IN","NO","NC","COM","VCC","GND"]);var i4=new WeakMap;class i7{get busy(){return(0,td._)(this,i4)}transmit(o){let h=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{clock:u,pin:m}=this;(0,tc._)(this,i4,!0);let w=h,C=()=>{m.setState(w?this.highState:ie.J.Low),w=!w;let h=o.shift();h?u.addEvent(h,C):(0,tc._)(this,i4,!1)};C()}constructor(o,h,u=ie.J.PullUp){(0,B._)(this,"clock",void 0),(0,B._)(this,"pin",void 0),(0,B._)(this,"highState",void 0),(0,tu._)(this,i4,{writable:!0,value:void 0}),this.clock=o,this.pin=h,this.highState=u,(0,tc._)(this,i4,!1)}}let i9=1,st=100,se=30*i5,si=80*i5,sn=50*i5,sr=27*i5,sa=70*i5,so=50*i5,sl=(o,h)=>{let u=Math.abs(Math.round(10*o)),m=Math.round(10*h),w=o<0?128:0;return[m>>8,255&m,w|u>>8,255&u]},sh={DHT11:(o,h)=>[Math.floor(h),0,Math.floor(o),0],DHT12(o,h){let u=o<0?128:0;return[Math.round(h),Math.round(10*h)%10,u|Math.round(o),Math.round(10*o)%10]},DHT21:sl,DHT22:sl};class sd{transmit(){let{pulseTransmitter:o}=this;if(!o)return;let h=sh[this.type](this.temperature,this.humidity),u=255&h.reduce((o,h)=>o+h);h.push(u);let m=[se,si,si];for(let o of h)for(let h=7;h>=0;h--){let u=!!(o&1<<h);m.push(sn,u?sa:sr)}m.push(so),this.pulseTransmitter.transmit(m)}onEvent(o){this.temperature=o.temperature,this.humidity=o.humidity}reset(){this.lastTimestamp=0}update(){return null}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"temperature",void 0),(0,B._)(this,"humidity",void 0),(0,B._)(this,"lastTimestamp",void 0),(0,B._)(this,"type",void 0),(0,B._)(this,"pulseTransmitter",void 0),this.clock=o,this.temperature=24,this.humidity=40,this.lastTimestamp=0,this.type="DHT22";let u=h.get("SDA");this.pulseTransmitter=new i7(o,u),u.setState(ie.J.PullUp),u.onValueChange(h=>{let u=o.cpuMillis-this.lastTimestamp;!this.pulseTransmitter.busy&&h&&u>=i9&&u<=st&&this.transmit(),this.lastTimestamp=o.cpuMillis})}}(0,B._)(sd,"pinNames",["SDA"]);class su{onEvent(o){let{bridges:h}=this;for(let u=0;u<h.length;u++)h[u].connected=!!o.values[u]}update(){return null}reset(){}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"bridges",void 0),this.clock=o,this.bridges=[];for(let o=1;o<=8;o++){let u=h.get("".concat(o,"a")),m=h.get("".concat(o,"b"));this.bridges.push(new iT(u,m,!1))}}}(0,B._)(su,"pinNames",["1a","1b","2a","2b","3a","3b","4a","4b","5a","5b","6a","6b","7a","7b","8a","8b"]);let sc=104,sv=64,sg=0,sf=1,sm=2,s_=3,sw=4,sb=5,sy=6,sC=7,sk=8,sS=56,sx=o=>o/10<<4|o%10,sP=o=>(15&o)+(o>>4)*10;function sD(o){return/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}.\d{3}Z)?/.test(o)}class sI{get date(){return this.halted?this.lastDate:new Date(new Date().getTime()-this.delta)}set date(o){this.lastDate=o,this.delta=new Date().getTime()-o.getTime()}readRegister(o){let{date:h}=this;switch(o){case sg:return sx(h.getSeconds())|(this.halted?128:0);case sf:return sx(h.getMinutes());case sm:return sx(h.getHours());case s_:return h.getDay()+1;case sw:return sx(h.getDate());case sb:return sx(h.getMonth()+1);case sy:return sx(h.getFullYear()-2e3);case sC:return this.controlRegister;default:return this.nvram[o-sk]}}writeRegister(o,h){let u=new Date(this.date);switch(o){case sg:this.halted=!!(128&h),u.setSeconds(sP(127&h)),this.date=u;return;case sf:u.setMinutes(sP(h)),this.date=u;return;case sm:u.setHours(sP(h)),this.date=u;return;case s_:return;case sw:this.lastDay=sP(h),this.dayLastUpdated=this.clock.cpuNanos,u.setDate(this.lastDay),this.date=u;return;case sb:u.setMonth(sP(h)-1),this.lastDay&&this.clock.cpuNanos-this.dayLastUpdated<i6&&u.setDate(this.lastDay),this.date=u;return;case sy:u.setFullYear(2e3+sP(h)),this.date=u;return;case sC:this.controlRegister=h;return;default:this.nvram[o-sk]=h}}i2cConnect(){return this.isFirstByte=!0,!0}i2cReadByte(){this.isFirstByte=!1;let o=this.readRegister(this.addr);return this.addr=(this.addr+1)%sv,o}i2cWriteByte(o){return this.isFirstByte?(this.addr=o,this.isFirstByte=!1):(this.writeRegister(this.addr,o),this.addr=(this.addr+1)%sv),!0}i2cDisconnect(){}update(){return null}reset(){this.isFirstByte=!0,this.addr=0}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"addr",void 0),(0,B._)(this,"isFirstByte",void 0),(0,B._)(this,"halted",void 0),(0,B._)(this,"nvram",void 0),(0,B._)(this,"lastDate",void 0),(0,B._)(this,"lastDay",void 0),(0,B._)(this,"dayLastUpdated",void 0),(0,B._)(this,"controlRegister",void 0),(0,B._)(this,"delta",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.addr=0,this.isFirstByte=!1,this.halted=!1,this.nvram=new Uint8Array(sS),this.lastDate=new Date,this.lastDay=0,this.dayLastUpdated=0,this.controlRegister=3,this.delta=0,this.value=null;let m=new Z.A({scl:h.get("SCL"),sda:h.get("SDA")},sc);m.setHandler(this);let w=u.get("initTime");"0"===w?this.lastDate=new Date(2e3,0,1,0,0,0,0):w&&sD(w)&&(this.lastDate=new Date(w)),this.delta=new Date().getTime()-this.lastDate.getTime()}}(0,B._)(sI,"pinNames",["SCL","SDA"]);class sN{update(){let o=this.ledController.update();return o&&(this.value.led1=o.value,this.updated=!0),this.updated?{value:{...this.value}}:null}reset(o){this.ledController.reset(),o&&(this.value.ledPower=0),this.updated=!0}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"ledController",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.updated=!0,this.value={led1:0,ledPower:1};let u=new Map,m=h.get("D2"),w=h.get("GND");u.set("A",m),u.set("C",w),this.ledController=new ex(this.clock,u)}}(0,B._)(sN,"pinNames",["D2","GND"]);let sA=4;class sT{update(){return null}reset(){}constructor(o,h){var u,m;(0,B._)(this,"nextOutput",Math.random()>=.5),(0,B._)(this,"lastNegEdge",0),(0,B._)(this,"outputEvent",void 0);let w=h.get("CLK"),C=h.get("D"),S=h.attached("S")?h.get("S"):null,P=h.attached("R")?h.get("R"):null,D=h.get("Q"),I=h.get("NOTQ");this.outputEvent=o.createEvent(()=>{var o,h;(null===(o=P)||void 0===o?void 0:o.value)?this.nextOutput=!1:(null===(h=S)||void 0===h?void 0:h.value)&&(this.nextOutput=!0);let{nextOutput:u}=this;D.setState(u?ie.J.High:ie.J.Low),I.setState(u?ie.J.Low:ie.J.High)}),null===(u=S)||void 0===u||u.onValueChange(o=>{o&&this.outputEvent.schedule(sA)}),null===(m=P)||void 0===m||m.onValueChange(()=>{this.outputEvent.schedule(sA)}),w.onValueChange(h=>{h&&o.cpuNanos-this.lastNegEdge>=sA?(this.nextOutput=C.value,this.outputEvent.schedule(sA)):this.lastNegEdge=o.cpuNanos}),this.outputEvent.schedule(sA)}}(0,B._)(sT,"pinNames",["D","CLK","Q","NOTQ","S","R"]);let sR=4;class sB{update(){return null}reset(){}constructor(o,h){(0,B._)(this,"nextOutput",Math.random()>=.5),(0,B._)(this,"lastNegEdge",0),(0,B._)(this,"outputEvent",void 0);let u=h.get("CLK"),m=h.get("Q"),w=h.get("S"),C=h.get("R"),S=h.get("NOTQ");this.outputEvent=o.createEvent(()=>{let{nextOutput:o}=this;m.setState(o?ie.J.High:ie.J.Low),S.setState(o?ie.J.Low:ie.J.High)}),u.onValueChange(h=>{if(!h||o.cpuNanos-this.lastNegEdge<sR){this.lastNegEdge=o.cpuNanos;return}w.value&&C.value?this.nextOutput=!this.nextOutput:w.value?this.nextOutput=!0:C.value&&(this.nextOutput=!1),this.outputEvent.schedule(sR)}),this.outputEvent.schedule(sR)}}(0,B._)(sB,"pinNames",["S","CLK","R","Q","NOTQ"]);class sE{update(){let o=this.ledController.update();return o&&(this.value.led=o.value,this.updated=!0),this.updated?{value:{...this.value}}:null}reset(o){this.ledController.reset(),this.value.led=0,o&&(this.value.ledPower=0),this.updated=!0}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"ledController",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.updated=!0,this.value={led:0,ledPower:1};let u=new Map,m=h.get("PB1"),w=h.get("GND");m&&w&&(u.set("A",m),u.set("C",w)),this.ledController=new ex(this.clock,u)}}(0,B._)(sE,"pinNames",["PB1","GND"]);class sU{onEvent(o){this.distance=o.distance}update(){return null}reset(){}constructor(o,h){(0,B._)(this,"distance",400);let u=h.get("ECHO"),m=h.get("TRIG");u.setState(ie.J.Low),m.onValueChange(h=>{if(!h){let h=1e3,m=300*h,w=Math.round(58.82*this.distance*h);o.addEvent(m,()=>{u.setState(ie.J.High)}),o.addEvent(m+w,()=>{u.setState(ie.J.Low)})}})}}(0,B._)(sU,"pinNames",["ECHO","TRIG"]);class sO{update(){return null}reset(){}constructor(o,h){(0,B._)(this,"value",0);let u=h.get("PL"),m=[h.get("D0"),h.get("D1"),h.get("D2"),h.get("D3"),h.get("D4"),h.get("D5"),h.get("D6"),h.get("D7")],w=h.get("Q7"),C=h.get("Q7_N"),S=()=>{C.state=1&this.value?ie.J.Low:ie.J.High,w.state=1&this.value?ie.J.High:ie.J.Low},P=()=>{u.value||(this.value=(m[0].value?128:0)|(m[1].value?64:0)|(m[2].value?32:0)|(m[3].value?16:0)|(m[4].value?8:0)|(m[5].value?4:0)|(m[6].value?2:0)|(m[7].value?1:0),S())};for(let o of(u.onValueChange(P),m))o.onValueChange(P);let D=h.get("CP"),I=h.get("CE"),N=h.get("DS"),A=!1,E=()=>{let h=D.value||I.value;!A&&h&&u.value&&(this.value=(N.value?128:0)|this.value>>1,o.addEvent(0,S)),A=h};D.onValueChange(E),I.onValueChange(E)}}(0,B._)(sO,"pinNames",["PL","CP","D4","D5","D6","D7","Q7_N","GND","Q7","DS","D0","D1","D2","D3","CE","VCC"]);class sL{updateOutput(){let{outputValue:o}=this;for(let h of this.outputs)h.setState(1&o?ie.J.High:ie.J.Low),o>>=1}update(){return null}reset(){}constructor(o,h){(0,B._)(this,"outputs",[]),(0,B._)(this,"enable",!1),(0,B._)(this,"clear",!1),(0,B._)(this,"inputValue",0),(0,B._)(this,"outputValue",0);let u=h.get("DS"),m=h.get("Q7S");h.get("SHCP").onValueChange(o=>{if(o){var h;let o=null!==(h=u.value)&&void 0!==h&&h;this.inputValue=this.inputValue<<1|(o?1:0)}!o&&m&&(m.state=128&this.inputValue?ie.J.High:ie.J.Low)}),h.get("STCP").onValueChange(o=>{o&&(this.outputValue=this.clear?0:this.inputValue,this.enable&&this.updateOutput())});let w=h.get("OE");this.enable=!w.value,w.onValueChange(o=>{if(this.enable=!o,o)for(let o of this.outputs)o.setState(ie.J.HighZ);else this.updateOutput()});let C=h.get("MR");for(let o of(this.clear=!!h.attached("MR")&&!C.value,C.onValueChange(o=>{this.clear=!o,this.inputValue=0}),[0,1,2,3,4,5,6,7]))this.outputs[o]=h.get("Q".concat(o))}}(0,B._)(sL,"pinNames",["Q1","Q2","Q3","Q4","Q5","Q6","Q7","GND","Q7S","MR","SHCP","STCP","OE","DS","Q0","VCC"]);var sM=u(70413),sV=u(44982);let sF=0,sJ=1,sW=16,sG=17,sH=32,sq=33,sK=40,sj=41,sz=42,sX=43,sQ=44,sZ=54,s$=58,sY=177,s0=178,s1=179,s2=180,s5=182,s3=192,s6=193,s8=194,s4=195,s7=196,s9=197,nt=224,ne=225,ni=128,ns=64,nn=32,nr={[sZ]:1,[s6]:1,[s2]:1,[s9]:1,[s$]:1,[s8]:2,[s4]:2,[s7]:2,[s5]:2,[sY]:3,[s0]:3,[sz]:4,[sX]:4,[s3]:3,[s1]:6,[nt]:16,[ne]:16};class na{update(){if(!this.updated)return null;{this.updated=!1;let{pixels:o,invert:h}=this;return{value:{pixels:o,invert:h}}}}snapshot(){this.update()}get value(){return""}reset(){this.displayOn=!1,this.activeColumn=0,this.activePage=0,this.columnStart=0,this.columnEnd=127,this.pageStart=0,this.pageEnd=7}fixBlackDisplayPageOffsets(){128&this.scanningDirection&&(this.activePage-=32,this.pageStart-=32),128&this.scanningDirection&&(this.pageEnd-=32)}processCommand(o){if(this.commandMode=!0,this.currentCommand[this.currentCommandIndex]=o,this.currentCommandIndex||(this.currentCommandLength=1+(nr[o]||0)),this.currentCommandIndex++,this.currentCommandIndex<this.currentCommandLength)return;let h=this.currentCommand[0],u=!1;switch(h){case sF:break;case sW:case sK:this.displayOn=!1,u=!0;break;case sG:case sj:this.displayOn=!0,u=!0;break;case sH:this.invert=!1,u=!0;break;case sq:this.invert=!0,u=!0;break;case sQ:this.commandMode=!1,this.highByte=!0;break;case sZ:this.scanningDirection=252&this.currentCommand[1];break;case sz:case sX:{let o=this.currentCommand[1]<<8|this.currentCommand[2],u=this.currentCommand[3]<<8|this.currentCommand[4],m=h===sX;(this.scanningDirection&nn?!m:m)?(this.activePage=o,this.pageStart=o,this.pageEnd=u,this.blackDisplay&&this.fixBlackDisplayPageOffsets()):(this.activeColumn=o,this.columnStart=o,this.columnEnd=u)}break;case s3:case sJ:case s$:case s9:break;default:console.warn("Unknown IL9163 Command",h.toString(16),this.currentCommand.slice(1,this.currentCommandIndex))}u&&this.displayOn&&(this.updated=!0),this.currentCommandIndex=0}processData(o){if(this.commandMode){this.processCommand(o);return}if(this.highByte){this.highByte=!1,this.highByteValue=o;return}let h=this.highByteValue<<8|o,u=this.activeColumn,m=this.activePage;this.scanningDirection&nn?(u=this.scanningDirection&ns?this.width-1-u:u,m=this.scanningDirection&ni?this.height-1-m:m):(u=this.scanningDirection&ni?this.width-1-u:u,m=this.scanningDirection&ns?this.height-1-m:m);let w=m*this.width+u;this.pixels[w]=h,this.scanningDirection&nn?(this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart,this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart))):(this.activeColumn++,this.activeColumn>this.columnEnd&&(this.activeColumn=this.columnStart,this.activePage++,this.activePage>this.pageEnd&&(this.activePage=this.pageStart))),this.updated=!0,this.highByte=!0}constructor(o,h){(0,B._)(this,"width",128),(0,B._)(this,"height",128),(0,B._)(this,"pixels",new Uint16Array(this.height*this.width)),(0,B._)(this,"blackDisplay",!0),(0,B._)(this,"displayOn",!1),(0,B._)(this,"updated",!1),(0,B._)(this,"invert",!1),(0,B._)(this,"activeColumn",0),(0,B._)(this,"activePage",0),(0,B._)(this,"columnStart",0),(0,B._)(this,"columnEnd",0),(0,B._)(this,"pageStart",0),(0,B._)(this,"pageEnd",0),(0,B._)(this,"scanningDirection",0),(0,B._)(this,"highByte",!0),(0,B._)(this,"highByteValue",0),(0,B._)(this,"commandMode",!1),(0,B._)(this,"currentCommandIndex",0),(0,B._)(this,"currentCommandLength",0),(0,B._)(this,"currentCommand",new Uint8Array(8));let u=h.get("D/C");this.reset();let m=new W.g({mosi:h.get("SDA"),clk:h.get("SCL"),ss:h.get("CS")});m.onTransmit=o=>{let h=u.value;return h?this.processData(o):this.processCommand(o),0}}}(0,B._)(na,"pinNames",["D/C","CS","SDA","SCL"]);let no=9*i3,nl=4.5*i3,nh=526.5*i5,nd=526.5*i5,nu=1687.5*i5;class nc{static find(o){return nc.instances.get(o)}onEvent(o){let{transmitter:h}=this,u=255&o.command,m=255&o.address,w=m|(255&~m)<<8|u<<16|(255&~u)<<24,C=[no,nl];for(let o=0;o<32;o++)C.push(nh,w&1<<o?nu:nd);C.push(nh),h.transmit(C,!1)}update(){return null}reset(){}constructor(o,h){(0,B._)(this,"transmitter",void 0);let u=h.get("DAT");u.setState(ie.J.PullUp),this.transmitter=new i7(o,u),nc.instances.set(o,this)}}(0,B._)(nc,"instances",new WeakMap),(0,B._)(nc,"pinNames",["DAT"]);class np{onEvent(o){var h;null===(h=nc.find(this.clock))||void 0===h||h.onEvent(o)}update(){return null}reset(){}constructor(o){(0,B._)(this,"clock",void 0),this.clock=o}}(0,B._)(np,"pinNames",[]);var nv=u(46888);let ng=1e6;class nf{onEvent(o){switch(o.type){case"press":this.switch.connected=!0;break;case"release":this.switch.connected=!1;break;case"rotate-cw":this.rotate(this.clk,this.dt);break;case"rotate-ccw":this.rotate(this.dt,this.clk)}}rotate(o,h){if(0!==this.currentState){var u,m;null===(u=this.firstPin)||void 0===u||u.setState(ie.J.PullUp),null===(m=this.secondPin)||void 0===m||m.setState(ie.J.PullUp),this.firstPin=o,this.secondPin=h,this.currentState=0,this.rotateEvent.schedule(1e3);return}this.firstPin=o,this.secondPin=h,this.rotateNext()}reset(){}update(){return null}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"switch",void 0),(0,B._)(this,"clk",void 0),(0,B._)(this,"dt",void 0),(0,B._)(this,"rotateEvent",void 0),(0,B._)(this,"currentState",void 0),(0,B._)(this,"firstPin",void 0),(0,B._)(this,"secondPin",void 0),(0,B._)(this,"rotateNext",void 0),this.clock=o,this.currentState=0,this.rotateNext=()=>{var o,h,u,m;switch(this.currentState){case 0:null===(o=this.firstPin)||void 0===o||o.setState(ie.J.Low),this.rotateEvent.schedule((0,nv.r)(2*ng,8*ng)),this.currentState++;break;case 1:null===(h=this.secondPin)||void 0===h||h.setState(ie.J.Low),this.rotateEvent.schedule((0,nv.r)(2*ng,19*ng)),this.currentState++;break;case 2:null===(u=this.firstPin)||void 0===u||u.setState(ie.J.PullUp),this.rotateEvent.schedule((0,nv.r)(100,5*ng)),this.currentState++;break;case 3:null===(m=this.secondPin)||void 0===m||m.setState(ie.J.PullUp),this.currentState=0}},this.switch=new iT(h.get("SW"),h.get("GND")),this.clk=h.get("CLK"),this.dt=h.get("DT"),this.clk.state=ie.J.PullUp,this.dt.state=ie.J.PullUp,this.rotateEvent=this.clock.createEvent(this.rotateNext)}}(0,B._)(nf,"pinNames",["CLK","DT","SW","VCC","GND"]);let nm=80,n_=64,nw=40,nb=1,ny=2,nC=4,nk=8,nS=16,nx=32,nP=64,nD=128,nI=2,nN=1,nA=4,nT=2,nR=1,nB=8,nE=4,nU=16;class nO{reset(){this.cgram.fill(0),this.ddram.fill(0),this.cgramUpdateCount=0,this.addr=0,this.writeCGRam=!1,this.firstByte=!0,this.registerValue=0,this.shift=0,this.incrementMode=!0,this.shiftMode=!1,this.displayOn=!1,this.blinkOn=!1,this.cursorOn=!1,this.backlight=!1,this.is8bit=!0,this.updated=!0}update(){return this.updated?(this.updated=!1,{value:this.snapshot()}):null}snapshot(){let{rows:o,cols:h,shift:u,ddram:m}=this,w=new Uint8Array(o*h),C=[0,nw,h,nw+h];if(this.displayOn)for(let S=0;S<o;S++)for(let o=0;o<h;o++){let P=(o+nw-u)%nw;w[S*h+o]=m[C[S]+P]}else w.fill(32);let{cursorOn:S,blinkOn:P,backlight:D,cgram:I,cgramUpdateCount:N,addr:A}=this,B=(A+nw+u)%nw,E=A>=nw?1:0;return o>2&&B>h&&(B-=h,E+=2),this.cgramUpdateCount++,{cursor:S,blink:P,cursorX:B,cursorY:E,value:w,backlight:D,cgram:I,cgramUpdateCount:N,font:this.font}}get value(){return""}readByte(o){let h=(this.busy?128:0)|127&this.addr,u=o?this.readData(!this.firstByte):h;return this.is8bit?u:this.firstByte?(this.firstByte=!1,240&u):(this.firstByte=!0,(15&u)<<4)}readData(o){if(this.writeCGRam){let h=this.cgram[this.addr],u=(1&h)<<4|(2&h)<<2|4&h|(8&h)>>2|(16&h)>>4;return o&&(this.addr=(this.addr+1)%n_),u}{let h=this.ddram[this.addr];if(o){let o=this.incrementMode?1:-1;this.addr=(this.addr+nm+o)%nm}return h}}feedByte(o,h){if(!this.is8bit){if(this.firstByte){this.registerValue=o,this.firstByte=!1;return}o=this.registerValue|o>>4,this.firstByte=!0}h?this.writeData(o):this.executeCommand(o),this.updated=!0}writeData(o){if(this.writeCGRam){let h=(1&o)<<4|(2&o)<<2|4&o|(8&o)>>2|(16&o)>>4;this.cgram[this.addr]=h,this.addr=(this.addr+1)%n_,this.cgramUpdateCount++}else{this.ddram[this.addr]=o;let h=this.incrementMode?1:-1;this.addr=(this.addr+nm+h)%nm,this.shiftMode&&(this.shift=(this.shift+h)%nw)}}executeCommand(o){if(o&nD){let h=127&o;this.addr=h<nw?h:h-24,this.addr>=nm&&(this.addr=0),this.writeCGRam=!1}else if(o&nP)this.addr=63&o,this.writeCGRam=!0;else if(o&nx)this.is8bit=!!(o&nU);else if(o&nS){let h=!!(o&nE),u=!!(o&nB),m=h?1:-1;this.addr=(this.addr+nm+m)%nm,u&&(this.shift=(this.shift+m)%nw),this.writeCGRam=!1}else o&nk?(this.displayOn=!!(o&nA),this.blinkOn=!!(o&nR),this.cursorOn=!!(o&nT)):o&nC?(this.incrementMode=!!(o&nI),this.shiftMode=!!(o&nN)):o&ny?(this.writeCGRam=!1,this.addr=0,this.shift=0):o&nb&&(this.ddram.fill(32),this.incrementMode=!0,this.addr=0,this.shift=0,this.writeCGRam=!1)}setBacklight(o){o!==this.backlight&&(this.backlight=o,this.updated=!0)}attachToPins(o){let h=o.enable,u=o.rw;u.setState(ie.J.PullDown);let{a:m,k:w}=o;m&&w&&it([m,w],()=>m.value&&!w.value&&(m.driven||w.driven),o=>{this.setBacklight(o)}),h&&h.onValueChange(h=>{var m,w,C,S,P,D,I,N,A,B,E,U,O,L,M,V,F;if(h&&!u.value){let h=((null===(m=o.d0)||void 0===m?void 0:m.value)?1:0)|((null===(w=o.d1)||void 0===w?void 0:w.value)?2:0)|((null===(C=o.d2)||void 0===C?void 0:C.value)?4:0)|((null===(S=o.d3)||void 0===S?void 0:S.value)?8:0)|((null===(P=o.d4)||void 0===P?void 0:P.value)?16:0)|((null===(D=o.d5)||void 0===D?void 0:D.value)?32:0)|((null===(I=o.d6)||void 0===I?void 0:I.value)?64:0)|((null===(N=o.d7)||void 0===N?void 0:N.value)?128:0);this.feedByte(h,o.rs.value)}if(h&&u.value){let h=this.readByte(o.rs.value);null===(A=o.d0)||void 0===A||A.setState(1&h?ie.J.High:ie.J.Low),null===(B=o.d1)||void 0===B||B.setState(2&h?ie.J.High:ie.J.Low),null===(E=o.d2)||void 0===E||E.setState(4&h?ie.J.High:ie.J.Low),null===(U=o.d3)||void 0===U||U.setState(8&h?ie.J.High:ie.J.Low),null===(O=o.d4)||void 0===O||O.setState(16&h?ie.J.High:ie.J.Low),null===(L=o.d5)||void 0===L||L.setState(32&h?ie.J.High:ie.J.Low),null===(M=o.d6)||void 0===M||M.setState(64&h?ie.J.High:ie.J.Low),null===(V=o.d7)||void 0===V||V.setState(128&h?ie.J.High:ie.J.Low)}if(!h){let h=[o.d0,o.d1,o.d2,o.d3,o.d4,o.d5,o.d6,o.d7];for(let o of h)null===(F=o)||void 0===F||F.setState(ie.J.PullDown)}})}constructor(){(0,B._)(this,"ddram",new Uint8Array(nm)),(0,B._)(this,"cgram",new Uint8Array(n_)),(0,B._)(this,"cgramUpdateCount",0),(0,B._)(this,"addr",0),(0,B._)(this,"writeCGRam",!1),(0,B._)(this,"busy",!1),(0,B._)(this,"firstByte",!0),(0,B._)(this,"registerValue",0),(0,B._)(this,"updated",!1),(0,B._)(this,"shift",0),(0,B._)(this,"incrementMode",!0),(0,B._)(this,"shiftMode",!1),(0,B._)(this,"displayOn",!1),(0,B._)(this,"blinkOn",!1),(0,B._)(this,"cursorOn",!1),(0,B._)(this,"backlight",!1),(0,B._)(this,"is8bit",!0),(0,B._)(this,"font",void 0),(0,B._)(this,"cols",16),(0,B._)(this,"rows",2),this.reset()}}class nL extends nO{i2cConnect(){return!0}i2cReadByte(){return this.readMode?this.inputMask&this.inputValue:this.inputMask}i2cWriteByte(o){let h=240&o,u=!!(1&o),m=!!(2&o),w=!!(4&o),C=!!(8&o);this.inputMask=o,this.readMode=w&&m,this.setBacklight(C);let S=w&&!this.prevEnable;if(S&&!this.readMode&&this.feedByte(h,u),S&&this.readMode){let o=this.readByte(u);this.inputValue=240&o|7}return this.prevEnable=w,!0}i2cDisconnect(){}constructor(o,h){super(),(0,B._)(this,"prevEnable",!1),(0,B._)(this,"readMode",!1),(0,B._)(this,"inputMask",0),(0,B._)(this,"inputValue",255);let u=new Z.A({scl:o.get("SCL"),sda:o.get("SDA")},h);u.setHandler(this)}}class nM{update(){var o,h;return null!==(h=null===(o=this.controller)||void 0===o?void 0:o.update())&&void 0!==h?h:null}reset(){var o;null===(o=this.controller)||void 0===o||o.reset()}constructor(o,h,u){(0,B._)(this,"controller",void 0);let m=parseInt(u.get("i2cAddress")||u.get("i2c-address")||"0",16)||39,w="i2c"===u.get("pins"),C=u.get("variant")||"A00";w?this.controller=new nL(h,m):(this.controller=new nO,this.controller.attachToPins({a:h.attached("A")?h.get("A"):null,k:h.attached("K")?h.get("K"):null,v0:h.attached("V0")?h.get("V0"):null,rs:h.get("RS"),rw:h.get("RW"),enable:h.get("E"),d0:h.get("D0"),d1:h.get("D1"),d2:h.get("D2"),d3:h.get("D3"),d4:h.get("D4"),d5:h.get("D5"),d6:h.get("D6"),d7:h.get("D7")})),this.controller.font=C}}(0,B._)(nM,"pinNames",["A","K","V0","RS","RW","E","D0","D1","D2","D3","D4","D5","D6","D7","SCL","SDA"]);class nV extends nM{constructor(o,h,u){super(o,h,u),this.controller&&(this.controller.rows=4,this.controller.cols=20)}}(0,B._)(nV,"pinNames",nM.pinNames);let nF=10;class nJ{update(){let o=!1;for(let u=0;u<this.leds.length;u++){var h;let m=null===(h=this.leds[u])||void 0===h?void 0:h.update();m&&(this.value.segments[u]=m.value,o=!0)}return o?{value:this.value}:null}reset(){for(let h of this.leds){var o;null===(o=h)||void 0===o||o.reset()}}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"leds",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.leds=[],this.value={segments:[]};for(let u=1;u<=nF;u++){let m=new Map;m.set("A",h.get("A".concat(u))),m.set("C",h.get("C".concat(u))),this.leds.push(new ex(o,m))}}}(0,B._)(nJ,"pinNames",["A1","A2","A3","A4","A5","A6","A7","A8","A9","A10","C1","C2","C3","C4","C5","C6","C7","C8","C9","C10"]);let nW={red:80,green:55,blue:75,standby:5};class nG{update(){this.ws2812Decoder.update();let o=this.clock.cpuMillis-this.lastUpdate;if(o>1e3){let h={fps:this.frames?this.frames/(o/1e3):1e3/(this.clock.cpuMillis-this.lastFrame),milliWatts:this.power};return this.lastUpdate=this.clock.cpuMillis,this.power=this.lastPower,this.frames=0,{value:h}}return null}reset(){this.frames=0,this.lastUpdate=0,this.lastFrame=0,this.lastPower=this.standbyPower,this.power=this.lastPower}constructor(o,h,u){var m;(0,B._)(this,"clock",void 0),(0,B._)(this,"lastUpdate",void 0),(0,B._)(this,"frames",void 0),(0,B._)(this,"lastFrame",void 0),(0,B._)(this,"power",void 0),(0,B._)(this,"lastPower",void 0),(0,B._)(this,"pixelCount",void 0),(0,B._)(this,"standbyPower",void 0),(0,B._)(this,"ws2812Decoder",void 0),this.clock=o,this.lastUpdate=0,this.frames=0,this.lastFrame=0,this.power=0,this.lastPower=0,this.pixelCount=parseInt(null!==(m=u.get("pixels"))&&void 0!==m?m:"",10)||0,this.standbyPower=this.pixelCount*nW.standby,this.reset();let w=h.get("DIN");this.ws2812Decoder=new im(w,o),this.ws2812Decoder.resize(this.pixelCount),this.ws2812Decoder.subscribe(h=>{for(let o of(this.lastPower=this.standbyPower,h)){let h=255&o,u=o>>8&255,m=o>>16&255;this.lastPower+=(u*nW.red+m*nW.green+h*nW.blue)/256}this.power=Math.max(this.power,this.lastPower),this.frames++,this.lastFrame=o.cpuMillis})}}(0,B._)(nG,"pinNames",["DIN"]);let nH=["D0","D1","D2","D3","D4","D5","D6","D7"],nq="!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~";function nK(o){switch(o){case"level":return w.Level;case"edge":return w.Edge;default:return w.Off}}!function(o){o[o.Off=0]="Off",o[o.Level=1]="Level",o[o.Edge=2]="Edge"}(w||(w={}));class nj{trace(o,h){let u=this.traceNames.indexOf(o);u<0&&(u=this.traceNames.length,this.traceNames.push(o)),this.traces[this.sampleIndex]=h,this.samples[this.sampleIndex]=u+32<<1,this.sampleTimes[this.sampleIndex++]=this.clock.cpuNanos}dumpPinValues(){let{samples:o,sampleTimes:h,clock:u}=this;for(let m=0;m<this.pins.length;m++){let w=this.pins[m];w&&(h[this.sampleIndex]=u.cpuNanos,o[this.sampleIndex++]=m<<1|(w.value?1:0))}}setupTrigger(o,h){switch(o){case w.Off:this.triggered=!0;break;case w.Level:this.triggered=this.triggerPin.value===h,this.triggerPin.onValueChange(o=>{this.triggered=o===h,o&&this.dumpPinValues()});break;case w.Edge:this.triggered=!1,this.triggerPin.onValueChange(o=>{o!==h||this.triggered||(this.triggered=!0,this.dumpPinValues())})}}update(){let{updated:o,activeChannels:h}=this;return this.activeChannels||(this.updated=!1),this.activeChannels=0,o?{value:{activeChannels:h,samples:this.sampleIndex}}:null}finalize(){let{sampleIndex:o,sampleTimes:h,samples:u,pins:m}=this;if(o<h.length){this.sampleTimes[this.sampleIndex]=this.clock.cpuNanos;let o=parseInt(Object.keys(m)[0],10);u[this.sampleIndex++]=o<<1|(m[o].value?1:0)}}reset(){if(this.updated=!0,this.sampleIndex){this.finalize();let o=this.channelNames.length,h=nq.slice(o,o+this.traceNames.length),u=["$version Generated by Wokwi.com $end","$date ".concat(new Date().toUTCString()," $end"),"$timescale 1ns $end","$scope module logic $end",...this.channelNames.map((o,h)=>"$var wire 1 ".concat(nq[h]," ").concat(o," $end")),...this.traceNames.map((o,u)=>"$var real 64 ".concat(h[u]," ").concat(o," $end")),"$upscope $end","$enddefinitions $end"],{samples:m,sampleTimes:w,sampleIndex:C}=this;C&&0!==w[0]&&u.push("#0");for(let o=0;o<C;o++){let C=1&m[o],S=m[o]>>1;if(u.push("#".concat(w[o].toFixed(0))),S<32){let o=nq[S];u.push("".concat(C).concat(o))}else{let m=S-32,w=h[m];u.push("r".concat(this.traces[o]," ").concat(w))}}u.push("");let S=new Blob([u.join("\n")],{type:"application/octet-stream"}),P=window.URL.createObjectURL(S),D=document.createElement("a");D.href=P,D.download=this.filename+".vcd",D.style.display="none",document.body.appendChild(D),D.click(),D.remove()}this.sampleIndex=0}constructor(o,h,u){var m,w,C,S,P,D;(0,B._)(this,"clock",void 0),(0,B._)(this,"pins",void 0),(0,B._)(this,"triggerPin",void 0),(0,B._)(this,"samples",void 0),(0,B._)(this,"filename",void 0),(0,B._)(this,"sampleTimes",void 0),(0,B._)(this,"sampleIndex",void 0),(0,B._)(this,"channelNames",void 0),(0,B._)(this,"traceNames",void 0),(0,B._)(this,"traces",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"activeChannels",void 0),(0,B._)(this,"triggered",void 0),this.clock=o,this.pins=[],this.sampleIndex=0,this.channelNames=[],this.traceNames=[],this.traces=[],this.updated=!1,this.activeChannels=0,this.triggered=!1;let I=parseInt(null!==(C=u.get("bufferSize"))&&void 0!==C?C:"0",10)||1e6;this.filename=(null===(m=u.get("filename"))||void 0===m?void 0:m.replace(/[\\/:"*?<>|]/g,""))||"wokwi-logic",this.samples=new Uint8Array(I),this.sampleTimes=new Float64Array(I),this.updated=!0,this.triggerPin=h.get(null!==(S=u.get("triggerPin"))&&void 0!==S?S:"D7");let N=nK(null!==(P=u.get("triggerMode"))&&void 0!==P?P:"off"),A="low"!==u.get("triggerLevel");this.setupTrigger(N,A);let E=null!==(D=null===(w=u.get("channelNames"))||void 0===w?void 0:w.split(",").map(o=>o.trim()))&&void 0!==D?D:[],{samples:U,sampleTimes:O}=this;for(let u=0;u<nH.length;u++){let m=h.get(nH[u]);if(h.attached(nH[u])){let h=this.channelNames.length;this.pins[u]=m,this.channelNames.push(E[u]||nH[u]),this.triggered&&(O[this.sampleIndex]=0,U[this.sampleIndex++]=h<<1|(m.value?1:0));let w=m===this.triggerPin;m.onValueChange(m=>{(this.triggered||w)&&(this.activeChannels|=1<<u,this.updated=!0,this.sampleIndex<O.length&&(O[this.sampleIndex]=o.cpuNanos,U[this.sampleIndex++]=h<<1|(m?1:0)))})}}nj.instance=this}}function nz(o){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["A","B"],u="OUT";class m{update(){return null}reset(){}constructor(m,w){(0,B._)(this,"clock",void 0),this.clock=m;let C=h.map(o=>w.get(o)),S=w.get(u);it(C,o,o=>{S.setState(o?ie.J.High:ie.J.Low)})}}return(0,B._)(m,"pinNames",[...h,u]),m}(0,B._)(nj,"pinNames",nH),(0,B._)(nj,"instance",void 0);let nX=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15];function nQ(o){return nX[15&o]<<4|nX[o>>4&15]}class nZ{transmissionComplete(){let{inputBuffer:o,chainLength:h}=this,u=this.inputIndex%o.length,m=Math.min(Math.floor(this.inputIndex/2),h);for(let w=0;w<m;w++){(u-=2)<0&&(u+=o.length);let m=o[u];if(m>=1&&m<=8){let C=o[u+1];this.revColumns&&(C=nQ(C)),this.ram[(h-1-w)*8+m-1]=C}}}update(){return this.updated?(this.updated=!1,{value:{pixels:this.ram}}):null}reset(){this.inputIndex=0}constructor(o,h,u){(0,B._)(this,"ram",void 0),(0,B._)(this,"inputBuffer",void 0),(0,B._)(this,"chainLength",void 0),(0,B._)(this,"inputIndex",0),(0,B._)(this,"bitOutIndex",0),(0,B._)(this,"updated",!1),(0,B._)(this,"revColumns",!1);let m=h.get("CLK"),w=h.get("DIN"),C=h.get("DOUT"),S=h.get("CS"),P=h.attached("DOUT"),D=u.get("layout");if(this.revColumns="fc16"===D,this.chainLength=parseInt(u.get("chain")||"",10)||8,this.ram=new Uint8Array(8*this.chainLength),this.inputBuffer=new Uint8Array(2*this.chainLength),!S||!m||!w)return;let I=new W.g({clk:m,mosi:w,ss:S});I.onTransmit=o=>{this.inputBuffer[this.inputIndex++%this.inputBuffer.length]=o},P&&m.onValueChange(o=>{if(!S.value&&!o){let o=this.inputBuffer[this.inputIndex%this.inputBuffer.length],h=o&1<<7-this.bitOutIndex;C.setState(h?ie.J.High:ie.J.Low),this.bitOutIndex=(this.bitOutIndex+1)%8}}),S.onValueChange(o=>{o?(this.transmissionComplete(),this.updated=!0):(this.inputIndex=0,this.bitOutIndex=1)})}}(0,B._)(nZ,"pinNames",["DIN","DOUT","CS","GND","V+","CLK"]);let n$=["R1","R2","R3","R4"],nY=["C1","C2","C3","C4"];class n0{onEvent(o){let h=this.bridges.get("".concat(o.column,",").concat(o.row));h&&(h.connected="press"===o.type)}update(){return null}reset(){}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"bridges",void 0),this.clock=o,this.bridges=new Map;for(let o=0;o<nY.length;o++)for(let u=0;u<n$.length;u++){let m=h.get(n$[u]),w=h.get(nY[o]);this.bridges.set("".concat(o,",").concat(u),new iT(w,m))}}}(0,B._)(n0,"pinNames",[...n$,...nY]);class n1{async initMic(){var o,h;if(this.userMedia=await (null===(h=navigator)||void 0===h?void 0:null===(o=h.mediaDevices)||void 0===o?void 0:o.getUserMedia({audio:!0})),!this.userMedia){console.warn("Failed to initialize microphone input track!");return}this.source=this.context.createMediaStreamSource(this.userMedia);let u=this.context.createScriptProcessor(256,1,1);u.addEventListener("audioprocess",o=>{let h=o.inputBuffer.getChannelData(0),u=o.inputBuffer.duration/o.inputBuffer.length*1e9,m=0,w=()=>{var o,C;let S=Math.max(0,.5+.5*h[m]);null===(o=this.pin1)||void 0===o||o.node.analogPort.writeNormalized(S),null===(C=this.pin2)||void 0===C||C.node.analogPort.writeNormalized(S),++m<h.length&&this.clock.addEvent(u,w)};w()}),this.source.connect(u),u.connect(this.context.destination),this.captureNode=u}update(){return null}reset(){this.pause()}pause(){var o,h;null===(o=this.userMedia)||void 0===o||o.getAudioTracks().map(o=>o.stop()),null===(h=this.captureNode)||void 0===h||h.disconnect()}resume(){}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"pin1",void 0),(0,B._)(this,"pin2",void 0),(0,B._)(this,"context",void 0),(0,B._)(this,"userMedia",void 0),(0,B._)(this,"source",void 0),(0,B._)(this,"captureNode",void 0),this.clock=o,this.context=new AudioContext,this.pin1=h.get("1"),this.pin2=h.get("2"),this.initMic().catch(o=>{console.warn("Failed to initialize microphone",o)})}}(0,B._)(n1,"pinNames",["1","2"]);class n2{async createPlayer(){let{instrument:o}=await u.e(4480).then(u.bind(u,84480)),h=await o(new AudioContext,"acoustic_grand_piano");h.listenToMidi(this)}checkMessage(){for(;this.message.length>=3;){var o,h;null===(o=(h=this).onmidimessage)||void 0===o||o.call(h,{data:new Uint8Array(this.message.slice(0,3))}),this.message.splice(0,3)}}update(){return null}reset(){this.message=[]}constructor(o,h){(0,B._)(this,"onmidimessage",null),(0,B._)(this,"message",[]),this.createPlayer();let u=new $.g(o,h.get("RX"));u.subscribe(o=>{this.message.push(...o),this.checkMessage()})}}(0,B._)(n2,"pinNames",["RX"]);var n5=u(39555);class n3{update(){let o=this.ws2812Decoder.update();return o?{value:{pixels:o.slice(0,this.rows*this.cols),rows:this.rows,cols:this.cols,brightness:this.brightness,gamma:this.gamma,layout:this.layout,colorFormat:iO.q.BRG}}:null}reset(){this.ws2812Decoder.reset()}constructor(o,h,u){var m,w;(0,B._)(this,"clock",void 0),(0,B._)(this,"ws2812Decoder",void 0),(0,B._)(this,"rows",void 0),(0,B._)(this,"cols",void 0),(0,B._)(this,"layout",void 0),(0,B._)(this,"brightness",void 0),(0,B._)(this,"gamma",void 0),this.clock=o,this.rows=parseInt(u.get("rows")||"0",10)||0,this.cols=parseInt(u.get("cols")||"0",10)||0,this.layout=u.get("matrixLayout")||"";let C=parseFloat(null!==(m=u.get("matrixBrightness"))&&void 0!==m?m:"1");this.brightness=C>=.01?C:1,this.gamma=parseFloat(null!==(w=u.get("_temp_gamma"))&&void 0!==w?w:"");let S=this.rows*this.cols,P=h.get("DIN"),D=h.get("DOUT");this.ws2812Decoder=new im(P,o,D),this.ws2812Decoder.resize(S)}}(0,B._)(n3,"pinNames",["DIN","VDD","VSS","DOUT"]);class n6{update(){let o=this.ws2812Decoder.update();return o?{value:o.slice(this.pixel,this.pixel+this.pixels)}:null}reset(){this.ws2812Decoder.reset()}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"ws2812Decoder",void 0),(0,B._)(this,"pixel",void 0),(0,B._)(this,"pixels",void 0),this.clock=o,this.pixel=parseInt(u.get("pixel")||"0",10)||0,this.pixels=parseInt(u.get("pixels")||"1",10)||1;let m=h.get("DIN"),w=h.get("DOUT");this.ws2812Decoder=new im(m,o,w),this.ws2812Decoder.resize(this.pixel+this.pixels)}}(0,B._)(n6,"pinNames",["DIN","VDD","VSS","DOUT"]);let n8=["QA","QB","QC","QD","QE","QF","QG","QH"];class n4{updateOutput(){let{outputValue:o}=this;for(let h of this.outputs)h.setState(1&o?ie.J.HighZ:ie.J.Low),o>>=1}update(){return null}reset(){}constructor(o,h){(0,B._)(this,"outputs",void 0),(0,B._)(this,"enable",!1),(0,B._)(this,"clear",!1),(0,B._)(this,"inputValue",0),(0,B._)(this,"outputValue",0);let u=h.get("SI"),m=h.get("SQH");h.get("SCK").onValueChange(o=>{if(o){var h;let o=null!==(h=u.value)&&void 0!==h&&h;this.inputValue=this.inputValue<<1|(o?1:0)}!o&&m&&(m.state=128&this.inputValue?ie.J.High:ie.J.Low)}),h.get("RCK").onValueChange(o=>{o&&(this.outputValue=this.clear?0:this.inputValue,this.enable&&this.updateOutput())});let w=h.get("OE");this.enable=!w.value,w.onValueChange(o=>{if(this.enable=!o,o)for(let o of this.outputs)o.setState(ie.J.HighZ);else this.updateOutput()});let C=h.get("SCLR");this.clear=!!h.attached("SCLR")&&!C.value,C.onValueChange(o=>{this.clear=!o,this.inputValue=0}),this.outputs=n8.map(o=>h.get(o))}}(0,B._)(n4,"pinNames",[...n8,"GND","SQH","SCLR","SCK","RCK","OE","SI","VCC"]);let n7=24,n9=3950;class rt{onEvent(o){let{temperature:h}=o;this.temperature=h,this.out.node.analogPort.writeNormalized(this.analogValue)}get analogValue(){let o=273.15,h=1e4,u=25+o,m=this.temperature+o,w=h*Math.exp(this.beta*(1/m-1/u));return w/(w+1e4)}update(){return null}reset(){}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"value",void 0),(0,B._)(this,"out",void 0),(0,B._)(this,"beta",void 0),(0,B._)(this,"temperature",void 0),this.clock=o,this.value=null,this.temperature=24,this.out=h.get("OUT");let m=parseFloat(u.get("temperature")||"");this.temperature=isNaN(m)?n7:m;let w=parseFloat(u.get("beta")||"");this.beta=!isNaN(w)&&w?w:n9,this.out.node.analogPort.writeNormalized(this.analogValue)}}(0,B._)(rt,"pinNames",["OUT"]);var re=u(7436);let ri=["P0","P1","P2","P3","P4","P5","P6","P7"],rs=32;class rn{readValue(){let o=0;for(let h=0;h<this.ioPins.length;h++)o|=this.ioPins[h].value?1<<h:0;return o}update(){return null}reset(){for(let o of this.ioPins)o.state=ie.J.PullUp;this.inputMask=255,this.prevValue=this.readValue(),this.intPin.state=ie.J.HighZ}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"firstWriteByte",void 0),(0,B._)(this,"ioPins",void 0),(0,B._)(this,"intPin",void 0),(0,B._)(this,"inputMask",void 0),(0,B._)(this,"prevValue",void 0),this.clock=o,this.firstWriteByte=!1,this.inputMask=0,this.prevValue=0;let u=h.get("A0"),m=h.get("A1"),w=h.get("A2"),C=new Z.A({scl:h.get("SCL"),sda:h.get("SDA")});for(let o of((0,re.u)(C,rs,[u,m,w]),this.ioPins=ri.map(o=>h.get(o)),this.intPin=h.get("INT"),this.reset(),this.ioPins))o.onValueChange(()=>{let o=this.readValue();(o^this.prevValue)&this.inputMask&&(this.intPin.state=ie.J.Low)});C.onConnect=()=>(this.firstWriteByte=!0,!0),C.onReadByte=()=>(this.intPin.state=ie.J.HighZ,this.readValue()),C.onWriteByte=o=>{if(!this.firstWriteByte)return!1;this.inputMask=o;for(let h=0;h<this.ioPins.length;h++)this.ioPins[h].state=o&1<<h?ie.J.PullUp:ie.J.Low;return this.firstWriteByte=!1,this.intPin.state=ie.J.HighZ,!0}}}(0,B._)(rn,"pinNames",["A0","A1","A2","GND","INT",...ri,"SCL","SDA","VCC"]);var rr=u(68720);class ra{update(){let o=this.ledController.update();return o&&(this.value.led=o.value,this.updated=!0),this.updated?{value:{...this.value}}:null}reset(){this.ledController.reset(),this.value.led=0,this.updated=!0}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"ledController",void 0),(0,B._)(this,"updated",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.updated=!0,this.value={led:0};let u=new Map,m=h.get("TP5"),w=h.get("GND");u.set("A",m),u.set("C",w),this.ledController=new ex(this.clock,u)}}(0,B._)(ra,"pinNames",["TP5","GND"]);class ro{onEvent(o){"motion"===o.type&&(!this.active||this.retrigger)&&(this.active||!(this.clock.cpuMillis<this.inhibitTimeout))&&(this.active=!0,this.motionTimeout=this.clock.cpuNanos+1e9*this.delayTime,this.inhibitTimeout=this.clock.cpuMillis+(this.delayTime+this.inhibitTime)*1e3,this.outPin.setState(ie.J.High),this.clock.addEvent(1e9*this.delayTime+10,()=>{this.clock.cpuNanos>this.motionTimeout&&(this.outPin.setState(ie.J.Low),this.active=!1)}))}update(){return null}reset(){}constructor(o,h,u){var m,w;(0,B._)(this,"clock",void 0),(0,B._)(this,"outPin",void 0),(0,B._)(this,"retrigger",void 0),(0,B._)(this,"delayTime",void 0),(0,B._)(this,"inhibitTime",void 0),(0,B._)(this,"active",void 0),(0,B._)(this,"motionTimeout",void 0),(0,B._)(this,"inhibitTimeout",void 0),this.clock=o,this.active=!1,this.motionTimeout=0,this.inhibitTimeout=0,this.outPin=h.get("OUT"),this.outPin.setState(ie.J.Low),this.retrigger="0"!==u.get("retrigger"),this.delayTime=parseFloat(null!==(m=u.get("delayTime"))&&void 0!==m?m:"5")||5,this.inhibitTime=parseFloat(null!==(w=u.get("inhibitTime"))&&void 0!==w?w:"1.2")||1.2}}(0,B._)(ro,"pinNames",["OUT"]);class rl{onEvent(o){let{value:h}=o;this.sig.node.analogPort.writeNormalized(h/1023)}update(){return null}reset(){}constructor(o,h,u,m){(0,B._)(this,"clock",void 0),(0,B._)(this,"value",void 0),(0,B._)(this,"sig",void 0),this.clock=o,this.value=null,this.sig=h.get("SIG"),m.initFloat("position",0),m.listen("position",o=>{this.sig.node.analogPort.writeNormalized(o)})}}(0,B._)(rl,"pinNames",["SIG"]);class rh{update(){return null}reset(){}constructor(o,h){(0,B._)(this,"clock",void 0),this.clock=o,h.get("GND").setState(ie.J.Low),h.get("VCC").setState(ie.J.High)}}(0,B._)(rh,"pinNames",["GND","VCC"]);class rd{onEvent(o){let{bridge:h}=this;h.connected="press"===o.type}update(){return null}reset(){}constructor(o,h,u,m){(0,B._)(this,"bridge",void 0);let w=h.get("1"),C=h.get("2"),S="0"!==u.get("bounce");this.bridge=iE(o,w,C,S),m.initFloat("pressed",0),m.listen("pressed",o=>{this.bridge.connected=!!o})}}(0,B._)(rd,"pinNames",["1","2"]);let ru=1e6,rc=5*ru,rp=15*ru;class rv{updatePoles(){let{currentState:o}=this;this.no1Bridge.connected=o,this.no2Bridge.connected=o,this.nc1Bridge.connected=!o,this.nc2Bridge.connected=!o}update(){return null}reset(){this.currentState=!1,this.nextState=!1,this.updatePoles()}constructor(o,h,u){(0,B._)(this,"no1Bridge",void 0),(0,B._)(this,"nc1Bridge",void 0),(0,B._)(this,"no2Bridge",void 0),(0,B._)(this,"nc2Bridge",void 0),(0,B._)(this,"currentState",!1),(0,B._)(this,"nextState",!1);let m=h.get("COIL1"),w=h.get("COIL2"),C=h.get("P1"),S=h.get("P2"),P="1"===u.get("bounce");this.no1Bridge=iE(o,C,h.get("NO1"),P),this.nc1Bridge=iE(o,C,h.get("NC1"),P),this.no2Bridge=iE(o,S,h.get("NO2"),P),this.nc2Bridge=iE(o,S,h.get("NC2"),P);let D=o.createEvent(()=>{this.currentState=this.nextState,this.updatePoles()}),I=()=>{let o=m.driven&&w.driven&&m.value!=w.value,h=o?rc:rp;this.nextState=o,o!==this.currentState&&D.schedule(h)};m.onStateChange(I),w.onStateChange(I),this.updatePoles()}}function rg(o){switch(o.state){case ie.J.High:return ie.J.PullUp;case ie.J.Low:return ie.J.PullDown;default:return ie.J.HighZ}}(0,B._)(rv,"pinNames",["COIL1","COIL2","P1","NO1","NC1","P2","NO2","NC2"]);class rf{update(){return null}reset(){}constructor(o,h){let u=h.get("1"),m=h.get("2");u.setState(rg(m)),m.setState(rg(u)),u.onStateChange(()=>{m.setState(rg(u))}),m.onStateChange(()=>{u.setState(rg(m))})}}(0,B._)(rf,"pinNames",["1","2"]);class rm{createLED(o,h,u){let m=new Map;m.set("A",u?o:h),m.set("C",u?h:o);let w=new Map,C=this.attrs.get("fps");return C&&w.set("fps",C),new ex(this.clock,m,w)}update(){let o=this.r.update(),h=this.g.update(),u=this.b.update();return(o&&(this.value.r=o.value),h&&(this.value.g=h.value),u&&(this.value.b=u.value),o||h||u)?{value:this.value}:null}reset(){this.r.reset(),this.g.reset(),this.b.reset()}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"attrs",void 0),(0,B._)(this,"r",void 0),(0,B._)(this,"g",void 0),(0,B._)(this,"b",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.attrs=u,this.value={r:0,g:0,b:0};let m="cathode"===u.get("common"),w=h.get("COM");this.r=this.createLED(h.get("R"),w,m),this.g=this.createLED(h.get("G"),w,m),this.b=this.createLED(h.get("B"),w,m)}}(0,B._)(rm,"pinNames",["COM","R","G","B"]);class r_{update(){let{dial:o,pulse:h}=this;return this.dialing&&(this.pulses?this.pulsing?(h.setState(ie.J.HighZ),this.pulsing=!1,this.pulses--):(h.setState(ie.J.Low),this.pulsing=!0):(o.setState(ie.J.HighZ),this.dialing=!1)),null}reset(){this.dialing=!1,this.pulsing=!1}onEvent(o){let{digit:h}=o,{dial:u}=this;u.setState(ie.J.Low),this.pulses=h>0?h:10,this.dialing=!0,this.pulsing=!1}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"dialing",void 0),(0,B._)(this,"pulsing",void 0),(0,B._)(this,"pulses",void 0),(0,B._)(this,"dial",void 0),(0,B._)(this,"pulse",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.dialing=!1,this.pulsing=!1,this.pulses=0,this.value="",this.dial=h.get("DIAL"),this.pulse=h.get("PULSE")}}(0,B._)(r_,"pinNames",["GND","DIAL","PULSE"]);let rw=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];function rb(o){let h=0;for(let u=0;u<o.length;u++){let m=o[u];for(let o=0;o<8;o++)128&m^128&(h<<=1)&&(h^=9),m<<=1}return 127&h}function ry(o){let h=0;for(let u=0;u<o.length;u++)h=rw[(h>>8^o[u])&255]^h<<8;return 65535&h}let rC=512,rk=2;!function(o){o[o.Ready=0]="Ready",o[o.Command=1]="Command",o[o.Write=2]="Write",o[o.WriteData=3]="WriteData"}(C||(C={})),function(o){o[o.GO_IDLE_STATE=0]="GO_IDLE_STATE",o[o.SEND_OP_COND=1]="SEND_OP_COND",o[o.SEND_IF_COND=8]="SEND_IF_COND",o[o.SEND_CSD=9]="SEND_CSD",o[o.SEND_CID=10]="SEND_CID",o[o.STOP_TRANSMISSION=12]="STOP_TRANSMISSION",o[o.SEND_STATUS=13]="SEND_STATUS",o[o.SET_BLOCKLEN=16]="SET_BLOCKLEN",o[o.READ_SINGLE_BLOCK=17]="READ_SINGLE_BLOCK",o[o.READ_MULTIPLE_BLOCK=18]="READ_MULTIPLE_BLOCK",o[o.SET_BLOCK_COUNT=23]="SET_BLOCK_COUNT",o[o.WRITE_BLOCK=24]="WRITE_BLOCK",o[o.WRITE_MULTIPLE_BLOCK=25]="WRITE_MULTIPLE_BLOCK",o[o.APP_CMD=55]="APP_CMD",o[o.READ_OCR=58]="READ_OCR",o[o.CRC_ON_OFF=59]="CRC_ON_OFF",o[o.INVALID=255]="INVALID"}(S||(S={})),function(o){o[o.SET_WR_BLOCK_ERASE_COUNT=23]="SET_WR_BLOCK_ERASE_COUNT",o[o.APP_SEND_OP_COND=41]="APP_SEND_OP_COND",o[o.APP_CLR_CARD_DETECT=42]="APP_CLR_CARD_DETECT",o[o.APP_SEND_SCR=51]="APP_SEND_SCR"}(P||(P={})),function(o){o[o.Idle=1]="Idle",o[o.CRCError=8]="CRCError"}(D||(D={})),function(o){o[o.OutOfRange=128]="OutOfRange"}(I||(I={}));let rS=64,rP=128,rD=4,rI=254,rN=255,rA=128,rT=5,rR=13,rB=11;class rE{get R1Flags(){return this.idle?D.Idle:0}get uintParam(){return(this.commandBuffer[0]<<24|this.commandBuffer[1]<<16|this.commandBuffer[2]<<8|this.commandBuffer[3])>>>0}crcCheck(){let{commandBuffer:o}=this,h=rb([64|this.currentCommand,o[0],o[1],o[2],o[3]]);return o[rD]===(h<<1|1)}respond(o){this.responseBuffer.set(o),this.responseBufferIndex=0,this.responseBufferCount=o.length}processCommand(){if(this.crcEnabled&&!this.crcCheck()){this.respond([255,this.R1Flags|D.CRCError]);return}if(this.appCommand){this.appCommand=!1,this.processAppCommand();return}switch(this.currentCommand){case S.GO_IDLE_STATE:if(this.idle=!0,!this.crcCheck()){this.respond([255,this.R1Flags|D.CRCError]);return}this.respond([255,this.R1Flags]);break;case S.SEND_IF_COND:if(!this.crcCheck()){this.respond([255,this.R1Flags|D.CRCError,0,0,0,0]);return}let o=this.commandBuffer[3];this.respond([255,this.R1Flags,0,0,1,o]);break;case S.READ_OCR:this.respond([255,this.R1Flags,rP|rS,255,128,0]);break;case S.SEND_CSD:this.respond([255,this.R1Flags,rI,...this.csd]);break;case S.SEND_CID:this.respond([255,this.R1Flags,rI,...this.cid]);break;case S.SEND_STATUS:this.respond([255,this.R1Flags,this.r2Value]);break;case S.APP_CMD:this.appCommand=!0,this.respond([255,this.R1Flags]);break;case S.CRC_ON_OFF:this.crcEnabled=!!(1&this.commandBuffer[3]),this.respond([255,this.R1Flags]);break;case S.STOP_TRANSMISSION:this.respond([255,this.R1Flags]);break;case S.READ_SINGLE_BLOCK:case S.READ_MULTIPLE_BLOCK:{let o=this.uintParam;if(o>=this.storage.blockCount){this.respond([255,this.R1Flags,rA]);return}this.respond([255,this.R1Flags,255,255,255,255,rI]);let h=this.storage.readBlock(o),u=ry(h);this.responseBuffer.set(h,this.responseBufferCount),this.responseBufferCount+=512,this.responseBuffer[this.responseBufferCount++]=u>>8,this.responseBuffer[this.responseBufferCount++]=255&u;break}case S.WRITE_BLOCK:this.writeAddress=this.uintParam,this.respond([255,this.R1Flags]),this.state=C.Write;break;default:console.warn("Unimplemented SD Command: 0x".concat(this.currentCommand.toString(16)))}}processAppCommand(){switch(this.currentCommand){case P.APP_SEND_OP_COND:this.idle=!1,this.respond([255,this.R1Flags]);break;case P.APP_CLR_CARD_DETECT:this.respond([255,this.R1Flags]);break;case P.APP_SEND_SCR:this.respond([255,this.R1Flags,rI,...this.scr]);break;default:console.warn("Unimplemented SD APP Command: 0x".concat(this.currentCommand.toString(16)))}}get csd(){let o=Math.ceil(this.storage.blockCount/1024)-1,h=new Uint8Array(18);return h[0]=64,h[1]=14,h[2]=0,h[3]=90,h[4]=91,h[5]=9,h[6]=0,h[7]=o>>16&255,h[8]=o>>8&255,h[9]=255&o,h[10]=64,h[11]=128,h[12]=10,h[13]=64,h[14]=0,h[15]=0,h[16]=137,h[17]=49,h}get cid(){let o=new Uint8Array(18);return o[0]=66,o[1]=67,o[2]=77,o[3]=87,o[4]=79,o[5]=75,o[6]=87,o[7]=73,o[8]=16,o[9]=254,o[10]=202,o[11]=254,o[12]=202,o[13]=1,o[14]=185,o[15]=0,o[16]=82,o[17]=162,o}get scr(){return new Uint8Array([0,0,0,0,0,0,0,0,0,0])}constructor(o,h){(0,B._)(this,"spi",void 0),(0,B._)(this,"storage",void 0),(0,B._)(this,"state",void 0),(0,B._)(this,"currentCommand",void 0),(0,B._)(this,"commandBuffer",void 0),(0,B._)(this,"commandBufferIndex",void 0),(0,B._)(this,"responseBuffer",void 0),(0,B._)(this,"responseBufferIndex",void 0),(0,B._)(this,"responseBufferCount",void 0),(0,B._)(this,"appCommand",void 0),(0,B._)(this,"idle",void 0),(0,B._)(this,"writeAddress",void 0),(0,B._)(this,"writeBuffer",void 0),(0,B._)(this,"writeBufferIndex",void 0),(0,B._)(this,"crcEnabled",void 0),(0,B._)(this,"r2Value",void 0),(0,B._)(this,"processByte",void 0),this.spi=o,this.storage=h,this.state=C.Ready,this.currentCommand=S.INVALID,this.commandBuffer=new Uint8Array(5),this.commandBufferIndex=0,this.responseBuffer=new Uint8Array(1024),this.responseBufferIndex=0,this.responseBufferCount=0,this.appCommand=!1,this.idle=!0,this.writeAddress=0,this.writeBuffer=new Uint8Array(rC+rk),this.writeBufferIndex=0,this.crcEnabled=!1,this.r2Value=0,this.processByte=o=>{switch(this.state){case C.Ready:(192&o)==64&&(this.currentCommand=63&o,this.commandBufferIndex=0,this.state=C.Command);break;case C.Command:this.commandBuffer[this.commandBufferIndex++]=o,this.commandBufferIndex===this.commandBuffer.length&&(this.state=C.Ready,this.processCommand());break;case C.Write:o===rI?(this.state=C.WriteData,this.writeBufferIndex=0):o!==rN&&(this.state=C.Ready);break;case C.WriteData:if(this.writeBuffer[this.writeBufferIndex++]=o,this.writeBufferIndex===this.writeBuffer.length){let o=this.writeBuffer.subarray(0,rC),h=this.writeBuffer[rC]<<8|this.writeBuffer[rC+1];this.state=C.Ready,this.r2Value=0,this.crcEnabled&&h!==ry(o)?this.respond([rB]):this.writeAddress>=this.storage.blockCount?(this.r2Value=I.OutOfRange,this.respond([rR])):(this.storage.writeBlock(this.writeAddress,o),this.respond([rT,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255]))}}this.responseBufferIndex<this.responseBufferCount?(this.spi.sendByte(this.responseBuffer[this.responseBufferIndex]),this.responseBufferIndex++):this.spi.sendByte(255)},o.onTransmit=this.processByte}}let rU=16384;class rO{async init(o){var h;let{files:u}=o;(null===(h=rO.files)||void 0===h?void 0:h.length)?await this.initFS(rO.files):await this.initFS(u)}async initFS(o){let{makeFatFS:h}=await Promise.all([u.e(4102),u.e(1670)]).then(u.bind(u,41670));await h({flash:this.data,numBlocks:rU,blockSize:rC,noFat12:!0},o)}update(){return null}reset(){}readBlock(o){return this.data.subarray(o*rC,(o+1)*rC)}writeBlock(o,h){this.data.set(h,o*rC)}constructor(o,h){(0,B._)(this,"data",new Uint8Array(rU*rC)),(0,B._)(this,"sdcardProtocol",void 0),(0,B._)(this,"blockCount",rU);let u=new W.g({mosi:h.get("DI"),miso:h.get("DO"),clk:h.get("SCK"),ss:h.get("CS")},0,!0);this.sdcardProtocol=new rE(u,this)}}(0,B._)(rO,"pinNames",["CS","SCK","DI","DO","CD"]),(0,B._)(rO,"files",void 0);class rL{pull(o){return new Promise(h=>{this.currentController=o,this.currentPromise=h})}cancel(){var o,h;this.currentController=null,null===(o=(h=this).currentPromise)||void 0===o||o.call(h),this.currentPromise=null}constructor(o){(0,B._)(this,"currentPromise",null),(0,B._)(this,"currentController",null),o.subscribe(o=>{var h,u,m;null===(h=this.currentController)||void 0===h||h.enqueue(o),null===(u=(m=this).currentPromise)||void 0===u||u.call(m),this.currentPromise=null})}}class rM{write(o){this.queue.push(...o),this.encoder.isBusy||this.sendNextByte()}constructor(o){(0,B._)(this,"encoder",void 0),(0,B._)(this,"queue",void 0),(0,B._)(this,"sendNextByte",void 0),this.encoder=o,this.queue=[],this.sendNextByte=()=>{let o=this.queue.shift();null!=o&&this.encoder.transmit(o)},o.onTxComplete=this.sendNextByte}}class rV{async initSerial(o){if(void 0===navigator.serial)throw Error("Serial API not supported in this browser");let h=await navigator.serial.requestPort({});if(h.addEventListener("disconnect",()=>{this.cleanup=null}),h.readable||await h.open({baudRate:o}),h.writable){var u;let o=null===(u=h.readable)||void 0===u?void 0:u.pipeTo(new WritableStream(new rM(this.encoder)),{signal:this.abort.signal}).catch(()=>{}),m=new ReadableStream(new rL(this.decoder)).pipeTo(h.writable,{signal:this.abort.signal}).catch(()=>{});this.cleanup=async()=>{await o,await m,await h.close()}}}update(){return null}async reset(){var o,h;this.abort.abort(),null===(o=(h=this).cleanup)||void 0===o||o.call(h).catch(console.error),this.cleanup=null}constructor(o,h,u){var m;(0,B._)(this,"abort",new AbortController),(0,B._)(this,"cleanup",null),(0,B._)(this,"encoder",void 0),(0,B._)(this,"decoder",void 0);let w=parseInt(null!==(m=u.get("baud"))&&void 0!==m?m:"",10)||9600;this.encoder=new Y.x(o,h.get("TX"),w),this.decoder=new $.g(o,h.get("RX"),w),this.initSerial(w).catch(console.error)}}(0,B._)(rV,"pinNames",["RX","TX","GND"]);class rF{update(){return this.updated?(this.updated=!1,{value:this.angle}):null}reset(){}constructor(o,h){(0,B._)(this,"angle",90),(0,B._)(this,"updated",!0),(0,B._)(this,"min",544),(0,B._)(this,"max",2400),(0,B._)(this,"margin",88);let u=h.get("PWM");u.onValueChange((o,h)=>{let{nanos:u}=h;if(!o){let{min:o,max:h,margin:m}=this,w=u/1e3;if(w<o-m||w>h+m)return;let C=(0,Q.u)(w,o,h),S=(C-o)/(h-o);this.angle=Math.round(180*S),this.updated=!0}})}}(0,B._)(rF,"pinNames",["PWM"]);let rJ=["A","B","C","D","E","F","G","DP"],rW=["DIG1","DIG2","DIG3","DIG4"],rG="COM",rH="CLN";class rq{update(){let o=!1;for(let u=0;u<this.leds.length;u++){var h;let m=null===(h=this.leds[u])||void 0===h?void 0:h.update();m&&(this.value.segments[u]=m.value,o=!0)}let u=this.colonLed.update();return u&&(this.value.colon=u.value,o=!0),o?{value:this.value}:null}reset(){var o,h;for(let o of this.leds)null===(h=o)||void 0===h||h.reset();null===(o=this.colonLed)||void 0===o||o.reset()}constructor(o,h,u){(0,B._)(this,"clock",void 0),(0,B._)(this,"leds",void 0),(0,B._)(this,"colonLed",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.leds=[],this.value={segments:[],colon:0};let m=rJ.map(o=>h.get(o)),w=rW.map(o=>h.attached(o)?h.get(o):null),C="cathode"===u.get("common"),S=C?"C":"A",P=C?"A":"C";w[0]||(w[0]=h.get("COM"));for(let h=0;h<w.length;h++){let C=w[h];if(C)for(let w=0;w<m.length;w++){let D=m[w],I=new Map;I.set(S,C),I.set(P,D),this.leds[h*m.length+w]=new ex(o,I,u)}}let D=h.get(rH),I=h.get(rG),N=new Map;N.set(S,I),N.set(P,D),this.colonLed=new ex(o,N,u)}}(0,B._)(rq,"pinNames",[...rJ,...rW,rG,rH]);class rK{update(){return null}reset(){}constructor(o,h,u,m){(0,B._)(this,"clock",void 0),this.clock=o;let w=h.get("1"),C=h.get("2"),S=h.get("3"),P=1===m.readFloat("value"),D="0"!==u.get("bounce"),I=iE(o,w,C,D);I.connected=!P;let N=iE(o,C,S,D);N.connected=P,m.listen("value",o=>{let h=o?I:N,u=o?N:I;h.connected=!1;let m=h instanceof iB?h.bounceDuration:0;this.clock.addEvent(m+42e4,()=>{u.connected=!0})})}}(0,B._)(rK,"pinNames",["1","2","3"]);let rj=256;class rz{update(){let o=this.ws2812Decoder.update();return o?{value:o.slice(0,rj)}:null}reset(){var o;null===(o=this.ws2812Decoder)||void 0===o||o.reset()}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"ws2812Decoder",void 0),this.clock=o;let u=h.get("DIN"),m=h.get("DOUT");this.ws2812Decoder=new im(u,o,m),this.ws2812Decoder.resize(rj)}}(0,B._)(rz,"pinNames",["DIN","VDD","VSS","DOUT"]);let rX=2;class rQ{update(){let o=this.decoder.update();if(o){let h=o[0],u=(h>>>24)/255,m=h>>16&255,w=h>>8&255,C=255&h;return this.value.ledRed=Math.pow(C/256*u,1/rX),this.value.ledGreen=Math.pow(w/256*u,1/rX),this.value.ledBlue=Math.pow(m/256*u,1/rX),{value:this.value}}return null}reset(o){this.value.ledRed=0,this.value.ledGreen=0,this.value.ledBlue=0,o&&(this.value.ledPower=0)}constructor(o,h){(0,B._)(this,"clock",void 0),(0,B._)(this,"decoder",void 0),(0,B._)(this,"value",void 0),this.clock=o,this.value={ledPower:1,ledRed:0,ledGreen:0,ledBlue:.1},this.decoder=new G({clock:h.get("$APA_CLK"),data:h.get("$APA_DATA"),ss:h.get("$APA_PWR")})}}(0,B._)(rQ,"pinNames",["$APA_PWR","$APA_CLK","$APA_DATA","GND"]),function(o){o[o.Idle=0]="Idle",o[o.Active=1]="Active",o[o.Ack=2]="Ack"}(N||(N={}));class rZ{processCommand(o){if((192&o)==128){let h=!!(8&o),u=7&o;(h!==this.on||u!==this.brightness)&&(this.on=h,this.brightness=u,this.updated=!0);return}if((192&o)==192){this.addr=15&o;return}switch(o){case 64:this.addrAuto=!0;break;case 68:this.addrAuto=!1}}processData(o){this.addr<4&&this.bytes[this.addr]!==o&&(this.bytes[this.addr]=o,this.updated=!0),this.addrAuto&&(this.addr=(this.addr+=1)%15)}update(){if(this.updated){this.updated=!1;let o=!1;for(let h=0;h<4;h++){for(let o=0;o<7;o++)this.segments[8*h+o]=this.bytes[h]&1<<o?1:0;128&this.bytes[h]&&(o=!0)}return this.on||(this.segments.fill(0),o=!1),{value:{segments:this.segments,colon:o,brightness:this.normalizedBrightness}}}return null}get normalizedBrightness(){switch(this.brightness){case 0:return .5;case 1:return .7;default:return 1}}reset(){}constructor(o,h){(0,B._)(this,"updated",!1),(0,B._)(this,"bytes",new Uint8Array(4)),(0,B._)(this,"segments",new Uint8Array(32)),(0,B._)(this,"state",N.Idle),(0,B._)(this,"clockIndex",0),(0,B._)(this,"incomingByte",0),(0,B._)(this,"isCommand",!0),(0,B._)(this,"addrAuto",!1),(0,B._)(this,"addr",0),(0,B._)(this,"on",!1),(0,B._)(this,"brightness",0);let u=h.get("CLK"),m=h.get("DIO");u.setState(ie.J.PullUp),m.setState(ie.J.PullUp),m.onValueChange(o=>{u.value&&!o&&(this.state=N.Active,this.clockIndex=0,this.incomingByte=0),u.value&&o&&this.state!==N.Ack&&(this.state=N.Idle,this.isCommand=!0)}),u.onValueChange(o=>{if(o&&this.state===N.Active){this.incomingByte>>=1,this.incomingByte|=m.value?128:0,this.clockIndex++,8===this.clockIndex&&(this.isCommand?this.processCommand(this.incomingByte):this.processData(this.incomingByte),this.isCommand=!1,this.state=N.Ack,this.clockIndex=0,this.incomingByte=0);return}this.state==N.Ack&&(m.setState(o?ie.J.PullUp:ie.J.PullDown),o&&(this.state=N.Active))})}}(0,B._)(rZ,"pinNames",["CLK","DIO"]);class r${update(){return null}reset(){}constructor(o,h){(0,B._)(this,"clock",void 0),this.clock=o;let u=h.get("IN"),m=h.get("EN"),w=h.get("OUT");it([u,m],()=>m.value?u.value?ie.J.High:ie.J.Low:ie.J.HighZ,o=>w.setState(o))}}(0,B._)(r$,"pinNames",["IN","EN","OUT"]);let rY=768,r0=576,r5=1.0909,r3=4278190080,r6=4294967295,r8=64e3,r4=4700,r7=5200,r9=51900,ae=22;class ai{update(){return{value:{pixels:this.pixels}}}reset(){}constructor(o,h){(0,B._)(this,"lineStart",0),(0,B._)(this,"oddField",!1),(0,B._)(this,"y",0),(0,B._)(this,"lastX",0),(0,B._)(this,"pixels",new Uint32Array(r0*rY)),(0,B._)(this,"lastSync",0),(0,B._)(this,"lastVSync",0),(0,B._)(this,"nextColor",r3);let u=h.get("IN"),m=h.get("SYNC");m.onValueChange(h=>{if(h){let h=o.cpuNanos-this.lastSync;if(h>3200&&h<5800){this.y>=0&&this.pixels.fill(this.nextColor,this.y*rY+this.lastX,(this.y+1)*rY);let h=o.cpuNanos-this.lastVSync,u=this.oddField?0:1;this.y=2*Math.round(h/r8-ae)+u,this.lineStart=o.cpuNanos+r4+r7,this.lastX=0}if(h>17e3&&h<r8-2e3){let h=o.cpuNanos-this.lastVSync;h>10*r8&&(this.lastX=0,this.oddField=!this.oddField,this.lastVSync=o.cpuNanos)}}this.lastSync=o.cpuNanos}),this.pixels.fill(r3),u.onValueChange(h=>{let u=o.cpuNanos-this.lineStart;if(u>0&&this.y>=0){let o=Math.min(u/r9*rY*r5,rY),h=this.y*rY;this.pixels.fill(this.nextColor,h+this.lastX,h+o),this.lastX=o}this.nextColor=h?r6:r3})}}(0,B._)(ai,"pinNames",["IN","SYNC","GND"]);let as={"wokwi-analog-joystick":iU,"wokwi-dht22":sd,"wokwi-led":ex,"wokwi-neopixel":n6,"wokwi-led-ring":n6,"wokwi-buzzer":i0,"wokwi-led-matrix":n3,"wokwi-lcd1602":nM,"wokwi-lcd2004":nV,"wokwi-neopixel-meter":nG,"wokwi-arduino-uno":iM,"wokwi-arduino-mega":iM,"wokwi-arduino-nano":iM,"wokwi-esp32-devkit-v1":sN,"wokwi-franzininho":sE,"wokwi-mpu6050":n5._,"wokwi-midi-player":n2,"wokwi-ir-receiver":nc,"wokwi-ir-remote":np,"wokwi-il9163":na,"wokwi-ili9341":ek,"wokwi-pi-pico":ra,"wokwi-pir-motion-sensor":ro,"wokwi-pushbutton":rd,"wokwi-microsd-card":rO,"wokwi-slide-switch":rK,"wokwi-servo":rF,"wokwi-ssd1306":e9,"wokwi-max7219-matrix":nZ,"wokwi-microphone":n1,"wokwi-neopixel-matrix":n3,"wokwi-neopixel-canvas":n3,"wokwi-neopixel-strip":n6,"wokwi-neopixel-serial":n6,"wokwi-ntc-temperature-sensor":rt,"wokwi-potentiometer":rl,"wokwi-slide-potentiometer":rl,"wokwi-hc-sr04":sU,"wokwi-ds1307":sI,"wokwi-membrane-keypad":n0,"wokwi-resistor":rf,"wokwi-rotary-dialer":r_,"wokwi-7segment":rq,"wokwi-74hc165":sO,"wokwi-74hc595":sL,"wokwi-nlsf595":n4,"wokwi-tv":ai,"wokwi-logic-analyzer":nj,"wokwi-splendida":rz,"wokwi-photoresistor-sensor":rr.l,"wokwi-ky-040":nf,"wokwi-rgb-led":rm,"wokwi-serial-port":rV,"wokwi-tinypico":rQ,"wokwi-hub75-matrix":sM.al,"wokwi-apa102-matrix":iL,"wokwi-led-bar-graph":nJ,"wokwi-dip-switch-8":su,"wokwi-pcf8574":rn,"wokwi-hx711":sV.j,"wokwi-ks2e-m-dc5":rv,"wokwi-stepper-motor":iX,"wokwi-a4988":iA,"wokwi-esp-01":th,"wokwi-gnd":rh,"wokwi-vcc":rh,"wokwi-gate-not":nz(o=>{let[h]=o;return!h.value},["IN"]),"wokwi-gate-buffer":nz(o=>{let[h]=o;return h.value},["IN"]),"wokwi-gate-and-2":nz(o=>{let[h,u]=o;return h.value&&u.value}),"wokwi-gate-or-2":nz(o=>{let[h,u]=o;return h.value||u.value}),"wokwi-gate-xor-2":nz(o=>{let[h,u]=o;return h.value!=u.value}),"wokwi-gate-nand-2":nz(o=>{let[h,u]=o;return!(h.value&&u.value)}),"wokwi-mux-2":nz(o=>{let[h,u,m]=o;return m.value?u.value:h.value},["A","B","SEL"]),"wokwi-tristate-buffer":r$,"wokwi-flip-flop-d":sT,"wokwi-flip-flop-sr":sB,"wokwi-flip-flop-dsr":sT,"wokwi-clock-generator":i2,"wokwi-tm1637-7segment":rZ,"wokwi-biaxial-stepper":iQ,"wokwi-relay-module":i8},an="https://wokwi.github.io/wokwi-boards",ar="https://wokwi.com/api/external/chips",aa="wokwi-custom-board",ao=["esp32-devkit-v1","esp-01","franzininho-wifi","ili9341-cap-touch","ssd1306","pi-pico","pi-pico-w","notecarrier-a","esp32-devkit-c-v4","esp32-c3-devkitm-1","esp32-c3-rust-1","esp32-c6-devkitc-1","esp32-h2-devkitm-1","esp32-s2-devkitm-1","esp32-s3-devkitc-1","arduino-nano-esp32","mch2022-badge","st-nucleo-c031c6","st-nucleo-l031k6","st-nucleo-l432kc","stm32-bluepill","wemos-s2-mini","ds18b20","epaper-2in9","cd74hc4067","tt-block-input","tt-block-input-8","tt-block-output","tt-block-bidirectional-io"];class al{async loadFromUrl(o){let h="".concat(an,"/").concat(o),u="".concat(h,"/board.svg?v=1"),m=await (await fetch("".concat(h,"/board.json?v=13"))).text(),w="board-".concat(o),{board:C,svgURL:S,adapter:P,controller:D}=iP(w,m,u);this.boards[o]={board:C,svgURL:S},iD.j[w]=P,as[w]=D}async loadUserBoard(o,h){let{board:u,svgURL:m,adapter:w,controller:C}=iP(aa,o,h);this.boards[aa]={board:u,svgURL:m},iD.j[aa]=w,as[aa]=C}async loadBoards(o){let h=[];for(let u of o)u in this.boards||h.push(this.loadFromUrl(u));await Promise.all(h)}isBoardType(o){return o.startsWith("board-")||o===aa}get(o){if(!this.isBoardType(o))throw Error("Invalid board type: ".concat(o));let h=o.replace(/^board-/,""),u=this.boards[h];return!u&&!this.loading[o]&&ao.includes(h)&&(this.loading[o]=!0,this.loadFromUrl(h).then(()=>{this.loading[o]=!1})),u}getBoardChips(o){var h;if(!this.isBoardType(o))return[];let u=this.get(o);return((null===(h=u)||void 0===h?void 0:h.board.chips)||[]).filter(o=>o.type.includes(":"))}getChip(o){let h=this.chips[o],u="".concat(ar,"/").concat(encodeURIComponent(o));return h||this.loading[o]||(this.loading[o]=!0,fetch("".concat(u,"/chip.json")).then(o=>o.text()).then(h=>{this.chips[o]=h,this.loading[o]=!1})),h}get loaded(){return!Object.values(this.loading).some(o=>o)}constructor(){(0,B._)(this,"boards",{}),(0,B._)(this,"chips",{}),(0,B._)(this,"loading",{}),(0,U.ky)(this)}}class ah{evaluateVars(o,h,u){var m,w,C;return u.map(u=>{var S,P;return{type:null!==(m=null===(S=u.type)||void 0===S?void 0:S.name)&&void 0!==m?m:"unknown",name:null!==(w=u.name)&&void 0!==w?w:"<unknown>",value:null!==(C=null===(P=o.evaluateVariable(u,h))||void 0===P?void 0:P.toString())&&void 0!==C?C:"<unavailable>"}})}formatFilename(o){return o.startsWith("/tmp/")?o.split("/").slice(4).join(""):o}update(o){var h,u,m;this._callstack=Array.from(o.backtrace());let w=o.target.PC,C=null!==(m=null===(u=this._callstack[0])||void 0===u?void 0:null===(h=u.func)||void 0===h?void 0:h.getLocals())&&void 0!==m?m:[];this.locals=this.evaluateVars(o,w,Array.from(C)),this.globals=this.evaluateVars(o,w,Array.from(o.getGlobals()))}get callstack(){var o;let h=this._callstack.map(h=>{var u;return{pc:h.pc,file:h.file&&this.formatFilename(h.file),line:h.line,column:h.column,function:null!==(o=null===(u=h.func)||void 0===u?void 0:u.name)&&void 0!==o?o:"<unknown>"}});if(0===h.length)return h;let u=h[h.length-1];return null==u.file&&"<unknown>"===u.function?h.slice(0,-1):h}constructor(){(0,B._)(this,"_callstack",[]),(0,B._)(this,"locals",[]),(0,B._)(this,"globals",[]),(0,U.ky)(this)}}var ad=u(3959),au=u(88707),ac=u(21375),ap=u(8853),av=u(54619);let ag="https://wokwi.github.io/wokwi-circuitpython-libraries",af="".concat(ag,"/packages/7.x-mpy"),am="lib/",a_=2003529559,aw=810697065;function ab(o,h){let u=[],m=new DataView(h),w=new TextDecoder,C=0;for(;C<h.byteLength;){if(m.getUint32(C,!0)!==a_||m.getUint32(C+4,!0)!==aw){console.error("Error extracting library ".concat(o,": Bad magic!"));break}C+=8;let S=m.getUint16(C,!0);C+=4;let P=m.getUint32(C,!0);C+=4;let D=w.decode(new Uint8Array(h,C,S));C+=S;let I=new Uint8Array(h,C,P);C+=P,u.push({name:"".concat(am).concat(D),content:I})}return u}async function ay(o){let h=o.map(o=>fetch("".concat(af,"/").concat(o,".mpylib")).then(o=>o.arrayBuffer()).then(h=>ab(o,h))),u=await Promise.all(h);return[].concat(...u)}async function aC(o){let h=new Set(o.split("\n").map(o=>o.trim()).filter(o=>o.length&&!o.startsWith("#")));if(!h.size)return[];let{libs:u}=await (await fetch("".concat(ag,"/index.json"))).json(),m=Array.from(h);for(;m.length>0;){var w,C;let o=m.shift()||"",S=u.find(h=>h.name===o);if(!S)throw Error("Library not found in index: ".concat(o));for(let o of null!==(C=null===(w=S)||void 0===w?void 0:w.deps)&&void 0!==C?C:[])h.has(o)||h.add(o)}return ay(Array.from(h))}class ak{subscribe(){return()=>0}}class aS{subscribe(o){return this.listeners.add(o),()=>this.listeners.delete(o)}switchTo(o){this.unsubscriber(),this.unsubscriber=o.subscribe(o=>{this.buffer.push(...o),this.dataAvailable=!0})}update(){if(!this.dataAvailable)return;let o=new Uint8Array(this.buffer);for(let h of this.listeners)h(o);this.buffer=[],this.dataAvailable=!0}constructor(o){(0,B._)(this,"buffer",[]),(0,B._)(this,"unsubscriber",()=>0),(0,B._)(this,"dataAvailable",!1),(0,B._)(this,"listeners",new Set),this.switchTo(o)}}class ax{readUint8(o){var h,u,m;return null!==(m=null===(u=this.sim.tempRunner)||void 0===u?void 0:null===(h=u.debuggerTarget)||void 0===h?void 0:h.readUint8(o))&&void 0!==m?m:0}readUint32(o){var h,u,m;return null!==(m=null===(u=this.sim.tempRunner)||void 0===u?void 0:null===(h=u.debuggerTarget)||void 0===h?void 0:h.readUint32(o))&&void 0!==m?m:0}resolveSymbol(o){return this.symbolStore.lookup(o)}constructor(o,h){(0,B._)(this,"sim",void 0),(0,B._)(this,"symbolStore",void 0),this.sim=o,this.symbolStore=h}}var aP=u(97763),aD=u(82465),aI=u(27039),aN=u(23340);let aA='\n#include <stdint.h>\n#include <stdbool.h>\n\n#ifndef WOKWI_API_H\n#define WOKWI_API_H\n\nenum pin_value {\n  LOW = 0,\n  HIGH = 1\n};\n\nenum pin_mode {\n  INPUT = 0,\n  OUTPUT = 1,\n  INPUT_PULLUP = 2,\n  INPUT_PULLDOWN = 3,\n  ANALOG = 4,\n\n  OUTPUT_LOW = 16,\n  OUTPUT_HIGH = 17,\n};\n\nenum edge {\n  RISING = 1,\n  FALLING = 2,\n  BOTH = 3,\n};\n\nint __attribute__((export_name("__wokwi_api_version_1"))) __attribute__((weak)) __wokwi_api_version_1(void) { return 1; }\n\n#ifdef __cplusplus\nextern "C" {\n#endif\n\ntypedef int32_t pin_t;\n#define NO_PIN ((pin_t)-1)\n\ntypedef struct {\n  void *user_data;\n  uint32_t edge;\n  void (*pin_change)(void *user_data, pin_t pin, uint32_t value);\n} pin_watch_config_t;\n\nextern __attribute__((export_name("chipInit"))) void chip_init(void);\n\nextern __attribute__((import_name("pinInit"))) pin_t pin_init(const char *name, uint32_t mode);\n\nextern __attribute__((import_name("pinRead"))) uint32_t pin_read(pin_t pin);\nextern __attribute__((import_name("pinWrite"))) void pin_write(pin_t pin, uint32_t value);\nextern __attribute__((import_name("pinWatch"))) bool pin_watch(pin_t pin, const pin_watch_config_t *config);\nextern __attribute__((import_name("pinWatchStop"))) void pin_watch_stop(pin_t pin);\nextern __attribute__((import_name("pinMode"))) void pin_mode(pin_t pin, uint32_t value);\nextern __attribute__((import_name("pinADCRead"))) float pin_adc_read(pin_t pin);\nextern __attribute__((import_name("pinDACWrite"))) float pin_dac_write(pin_t pin, float voltage);\n\ntypedef uint32_t string_t;\n#define STRING_NULL 0\n\nextern __attribute__((import_name("stringGetLength"))) uint32_t string_get_length(string_t string);\nextern __attribute__((import_name("stringRead"))) uint32_t string_read(string_t string, char *buf, uint32_t buffer_size);\n\nextern __attribute__((import_name("attrInit"))) uint32_t attr_init(const char *name, uint32_t default_value);\nextern __attribute__((import_name("attrInitFloat"))) uint32_t attr_init_float(const char *name, float default_value);\nextern __attribute__((import_name("attrRead"))) uint32_t attr_read(uint32_t attr_id);\nextern __attribute__((import_name("attrReadFloat"))) float attr_read_float(uint32_t attr_id);\nextern __attribute__((import_name("attrStringInit"))) string_t attr_string_init(const char *name);\n\ntypedef struct {\n  void *user_data;\n  uint32_t address;\n  pin_t scl;\n  pin_t sda;\n  bool (*connect)(void *user_data, uint32_t address, bool connect);\n  uint8_t (*read)(void *user_data);\n  bool (*write)(void *user_data, uint8_t data);\n  void (*disconnect)(void *user_data);\n  uint32_t reserved[8];\n} i2c_config_t;\n\ntypedef uint32_t i2c_dev_t;\n\nextern __attribute__((import_name("i2cInit"))) i2c_dev_t i2c_init(const i2c_config_t *config);\n\ntypedef struct {\n  void *user_data;\n  pin_t rx;\n  pin_t tx;\n  uint32_t baud_rate;\n  void (*rx_data)(void *user_data, uint8_t byte);\n  void (*write_done)(void *user_data);\n  uint32_t reserved[8];\n} uart_config_t;\n\ntypedef uint32_t uart_dev_t;\n\nextern __attribute__((import_name("uartInit"))) uart_dev_t uart_init(const uart_config_t *config);\nextern __attribute__((import_name("uartWrite"))) bool uart_write(uart_dev_t uart, uint8_t *buffer, uint32_t count);\n\ntypedef struct {\n  void *user_data;\n  pin_t sck;\n  pin_t mosi;\n  pin_t miso;\n  uint32_t mode;\n  void (*done)(void *user_data, uint8_t *buffer, uint32_t count);\n  uint32_t reserved[8];\n} spi_config_t;\ntypedef uint32_t spi_dev_t;\n\nextern __attribute__((import_name("spiInit"))) spi_dev_t spi_init(const spi_config_t *spi_config);\nextern __attribute__((import_name("spiStart"))) void spi_start(const spi_dev_t spi, uint8_t *buffer, uint32_t count);\nextern __attribute__((import_name("spiStop"))) void spi_stop(const spi_dev_t spi);\n\ntypedef struct {\n  void *user_data;\n  void (*callback)(void *user_data);\n  uint32_t reserved[8];\n} timer_config_t;\n\ntypedef uint32_t timer_t;\n\nextern __attribute__((import_name("timerInit"))) timer_t timer_init(const timer_config_t *config);\nextern __attribute__((import_name("timerStart"))) void timer_start(const timer_t timer, uint32_t micros, bool repeat);\nextern __attribute__((import_name("timerStartNanos"))) void timer_start_ns_d(const timer_t timer, double nanos, bool repeat);\nstatic void timer_start_ns(const timer_t timer, uint64_t nanos, bool repeat) {\n  timer_start_ns_d(timer, (double)nanos, repeat);\n}\nextern __attribute__((import_name("timerStop"))) void timer_stop(const timer_t timer);\n\nextern __attribute__((import_name("getSimNanos"))) double get_sim_nanos_d(void);\n\nstatic uint64_t get_sim_nanos(void) {\n  return (uint64_t)get_sim_nanos_d();\n}\n\ntypedef uint32_t buffer_t;\nextern __attribute__((import_name("framebufferInit"))) buffer_t framebuffer_init(uint32_t *pixel_width, uint32_t *pixel_height);\nextern __attribute__((import_name("bufferRead"))) void buffer_read(buffer_t buffer, uint32_t offset, void *data, uint32_t data_len);\nextern __attribute__((import_name("bufferWrite"))) void buffer_write(buffer_t buffer, uint32_t offset, void *data, uint32_t data_len);\n\n// Experimental API - subject to change\nextern __attribute__((import_name("_symbolResolve"))) void* _symbol_resolve(char *symbol_name);\nextern __attribute__((import_name("_mcuReadMemory"))) bool _mcu_read_memory(const void *address, void *target, uint32_t size);\nextern __attribute__((import_name("_mcuReadUint32"))) uint32_t _mcu_read_uint32(const void *address);\nextern __attribute__((import_name("_mcuReadUint32"))) void* _mcu_read_ptr(const void *address);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif /* WOKWI_API_H */\n',aT={c:{sourceName:"app.c",sourcePath:"/src/app.c",builder:"clang-wasm",extension:"c",wokwiH:!0},rust:{sourceName:"lib.rs",sourcePath:"/project/lib.rs",builder:"rust-wasm",extension:"rs",wokwiH:!1},verilog:{sourceName:"wokwi.v",sourcePath:"src/wokwi.v",builder:"verilog-cxxrtl",extension:"v",wokwiH:!0}};async function aR(o,h,u,m,w,C,S,P){var D,I;console.log("[".concat(o,"] \uD83D\uDC1E Compiling custom chip...")),h instanceof Uint8Array&&(h=new TextDecoder().decode(h));let N=aT[m],A=await (0,ap.b)([{name:N.sourceName,content:h},...N.wokwiH?[{name:"wokwi-api.h",content:aA}]:[]],{builder:N.builder,buildType:w});if(!A.hex||(null===(D=A.stderr)||void 0===D?void 0:D.startsWith("Error: Command failed: clang"))){let h=o.substring(5)+".chip.".concat(N.extension),u=A.stderr.split("\n").slice(1).join("\n").split(N.sourcePath).join("/sketch/"+h);null===(I=C)||void 0===I||I(u),console.error("Build failed:",u);return}let B=(0,aP.Xs)(A.hex);return console.log("[".concat(o,"] \uD83C\uDF55 Loading custom chip...")),aB(o,B,u,P,S)}async function aB(o,h,u,m,w){var C,S;let P=await WebAssembly.compile(h),D=new WebAssembly.Memory({initial:2}),I=new aI.v(o,()=>D,u,m),N=await WebAssembly.instantiate(P,{env:{memory:D,pinInit:I.pinInit.bind(I),pinMode:I.pinMode.bind(I),pinRead:I.pinRead.bind(I),pinWrite:I.pinWrite.bind(I),pinWatch:I.pinWatch.bind(I),pinWatchStop:I.pinWatchStop.bind(I),pinADCRead:I.pinADCRead.bind(I),pinDACWrite:I.pinDACWrite.bind(I),i2cInit:I.i2cInit.bind(I),uartInit:I.uartInit.bind(I),uartWrite:I.uartWrite.bind(I),spiInit:I.spiInit.bind(I),spiStart:I.spiStart.bind(I),spiStop:I.spiStop.bind(I),stringGetLength:I.stringGetLength.bind(I),stringRead:I.stringRead.bind(I),attrInit:I.attrInit.bind(I),attrRead:I.attrRead.bind(I),attrInitFloat:I.attrInitFloat.bind(I),attrReadFloat:I.attrReadFloat.bind(I),attrStringInit:I.attrStringInit.bind(I),getSimNanos:I.getSimNanos.bind(I),timerInit:I.timerInit.bind(I),timerStart:I.timerStart.bind(I),timerStartNanos:I.timerStartNanos.bind(I),timerStop:I.timerStop.bind(I),framebufferInit:I.framebufferInit.bind(I),bufferRead:I.bufferRead.bind(I),bufferWrite:I.bufferWrite.bind(I),debugPrint:h=>{var u;let m=(0,aD.V)(D,h);null===(u=w)||void 0===u||u(m,1),console.log("[".concat(o,"] %c%s"),"color: green",m.replace(/\r?\n$/,""))},_symbolResolve:I.symbolResolve.bind(I),_mcuReadMemory:I.mcuReadMemory.bind(I),_mcuReadUint32:I.mcuReadUint32.bind(I),emscripten_notify_memory_growth(){}},wasi_snapshot_preview1:{fd_write:(h,u,m,C)=>{let S=[],P=0,I=new DataView(D.buffer);for(let o=0;o<m;o++){let h=I.getUint32(u+8*o,!0),m=I.getUint32(u+8*o+4,!0);P+=m,S.push(...new Uint8Array(I.buffer,h,m))}I.setUint32(C,P,!0);let N=new TextDecoder().decode(new Uint8Array(S)).replace(/\r?\n$/,"");w(N,h),console.log("[".concat(o,"] %c%s"),"color: green",N)},fd_close(){},fd_seek(){},fd_fdstat_get(o,h){let u=1,m=2;if(o===u||o===m){let o=new DataView(D.buffer),u=2;return o.setUint8(h,u),o.setUint32(h+8,0,!0),0}return -1},proc_exit(){}}});return N.exports.memory&&N.exports.memory instanceof WebAssembly.Memory&&(D=N.exports.memory),I.instance=N,C=class{update(){let{buffer:o}=this;return o.dirty?(o.dirty=!1,{value:{pixels:o.data}}):null}reset(){}constructor(h,u,m,w){(0,B._)(this,"buffer",new aN.l(new Uint8Array(I.framebufferWidth*I.framebufferHeight*4))),I.clock=h,I.pins=u,I.attrs=m,I.vars=w,I.buffer=this.buffer;try{var C,S;null===(C=(S=N.exports).chipInit)||void 0===C||C.call(S),console.log("[".concat(o,"] \uD83C\uDF1F Custom chip instance created!"))}catch(h){console.error("[".concat(o,"] Custom chip instance creation failed:"),h)}}},(0,B._)(C,"pinNames",null!==(S=u.pins)&&void 0!==S?S:[]),C}var aE=u(95810),aU=u(26783);class aO{findPC(o){return this.dbg.lines.filter(h=>h.file.endsWith(this.fileName)&&h.line===o&&h.ns)}setBreakpoint(o){let h=this.findPC(o);for(let{pc:o}of h)this.dbg.setBreakpoint(o)}removeBreakpoint(o){let h=this.findPC(o);for(let{pc:o}of h)this.dbg.removeBreakpoint(o)}constructor(o,h){(0,B._)(this,"dbg",void 0),(0,B._)(this,"fileName",void 0),this.dbg=o,this.fileName=h}}var aL=u(12269);class aM{get type(){var o;let h=null===(o=this.typeAttr)||void 0===o?void 0:o.value;return null!=h?this.unit.getType(h):void 0}toJSON(){var o;return{name:this.name,type:null===(o=this.type)||void 0===o?void 0:o.name}}constructor(o,h){var u,m;(0,B._)(this,"unit",void 0),(0,B._)(this,"die",void 0),(0,B._)(this,"name",void 0),(0,B._)(this,"location",void 0),(0,B._)(this,"typeAttr",void 0),this.unit=o,this.die=h,this.name=null===(u=h.attrs.find(o=>o.name===aE.Bp.DW_AT_name))||void 0===u?void 0:u.value,this.location=null===(m=h.attrs.find(o=>o.name===aE.Bp.DW_AT_location))||void 0===m?void 0:m.value,this.typeAttr=h.attrs.find(o=>o.name===aE.Bp.DW_AT_type)}}class aV{resolveObjectTypeName(o){let{unit:h}=this,u=h.dieAtOffset(h.toUnitOffset(o));if(!u)return;if(u.tag===aE.Jf.DW_TAG_structure_type){let o=u.attrs.find(o=>o.name===aE.Bp.DW_AT_name);if(o)return o.value}let m=u.attrs.find(o=>o.name===aE.Bp.DW_AT_type);if(m)return this.resolveObjectTypeName(m.value)}resolveName(o){let h=o.attrs.find(o=>o.name===aE.Bp.DW_AT_MIPS_linkage_name);if(h)return(0,aL.G)(h.value);let u=o.attrs.find(o=>o.name===aE.Bp.DW_AT_name);if(u){let h=o.attrs.find(o=>o.name===aE.Bp.DW_AT_object_pointer),m="";if(h){let o=this.resolveObjectTypeName(h.value);o&&(m="".concat(o,"::"))}return m+u.value}let m=o.attrs.find(o=>o.name===aE.Bp.DW_AT_specification);if(m){let{unit:o}=this,h=o.dieAtOffset(o.toUnitOffset(m.value));if(h)return this.resolveName(h)}}get name(){let o=this.resolveName(this.die);if(o)return o;let h=this.die.attrs.find(o=>o.name===aE.Bp.DW_AT_abstract_origin);if(h){let{unit:o}=this,u=o.dieAtOffset(o.toUnitOffset(h.value));return u?this.resolveName(u):void 0}}*getLocals(){let{unit:o,die:h}=this;for(let m of o.dieChildren(h)){var u;if(m.depth>0)continue;let h=null===(u=m.attrs.find(o=>o.name===aE.Bp.DW_AT_location))||void 0===u?void 0:u.value;(m.tag===aE.Jf.DW_TAG_variable||m.tag===aE.Jf.DW_TAG_formal_parameter)&&null!=h&&(yield new aM(o,m))}}constructor(o,h){(0,B._)(this,"unit",void 0),(0,B._)(this,"die",void 0),this.unit=o,this.die=h}}class aF{locals(){var o;return null===(o=this.func)||void 0===o?void 0:o.getLocals()}constructor(o){(0,B._)(this,"index",void 0),(0,B._)(this,"pc",void 0),(0,B._)(this,"returnPC",void 0),(0,B._)(this,"sp",void 0),(0,B._)(this,"regs",void 0),(0,B._)(this,"func",void 0),(0,B._)(this,"file",void 0),(0,B._)(this,"line",void 0),(0,B._)(this,"column",void 0),this.index=o.index,this.pc=o.pc,this.returnPC=o.returnPC,this.sp=o.sp,this.regs=o.regs,this.func=o.func,o.line&&(this.file=o.line.file,this.line=o.line.line,this.column=o.line.col)}}class aJ{getFileName(o,h){let u=o.lineNumberMachine();if(u){let o=u.files[h-1];return o?'"'.concat(o.dir,"/").concat(o.name,'"'):null}return null}evaluateLocation(o,h){let u=null;if(o&&o instanceof Uint8Array&&(u=o),"number"==typeof o){for(let m of this.dwarf.readDebugLoc(o))if(null!=h&&m.start<=h&&m.end>h){u=m.expr;break}}if(!u)return null;let m=new aE.HC(new aE._R(u),{addressSize:4,readUint8:o=>this.target.readUint8(o),readUint32:o=>this.target.readUint32(o),readRegister:o=>this.target.readDwarfRegister(o),readFrameBase:()=>{throw Error("readFrameBase not implemented!")}}),w=m.evaluate();return w||null}evaluateVariable(o,h){var u;let m;let w=null;try{w=this.evaluateLocation(o.location,h)}catch(o){console.warn(o)}if(!w)return null;if((null===(u=o.type)||void 0===u?void 0:u.name)==="String"&&"number"==typeof w){let o=this.target.readUint16(8388608|w),h=this.target.readUint16(8388608|w+4),u=new Uint8Array(h>1024?1024:h);for(let h=0;h<u.length;h++)u[h]=this.target.readUint8(8388608|o+h);return String.fromCharCode(...u)}"number"==typeof w?m=new Uint8Array(new Uint32Array([this.target.readUint32(w)]).buffer):(w.length>4&&console.warn("Implicit value is too long"),m=w);let C=new DataView(m.buffer),{type:S}=o;if(!S)return null;for(;S.underlyingType&&void 0!==S.underlyingType.encoding;)S=S.underlyingType;let{byteSize:P,encoding:D}=S;switch(D){case aE.G5.DW_ATE_address:return C.getUint16(0,!0);case aE.G5.DW_ATE_boolean:return 0!==C.getUint8(0);case aE.G5.DW_ATE_float:switch(P){case 4:return C.getFloat32(0,!0);case 8:return C.getFloat64(0,!0);default:console.warn("Unsupported float byte size",P)}break;case aE.G5.DW_ATE_signed:switch(P){case 1:return C.getInt8(0);case 2:return C.getInt16(0,!0);case 4:return C.getInt32(0,!0);default:console.warn("Unsupported byte size",P)}break;case aE.G5.DW_ATE_signed_char:return C.getInt8(0);case aE.G5.DW_ATE_unsigned:switch(P){case 1:return C.getUint8(0);case 2:return C.getUint16(0,!0);case 4:return C.getUint32(0,!0);default:console.warn("Unsupported byte size",P)}break;case aE.G5.DW_ATE_unsigned_char:return C.getUint8(0);default:D&&console.warn("Unsupported encoding",aE.G5[D])}return null}*getGlobals(){for(let o of this.dwarf.units)for(let h of o.dieIterator())h.depth>1||h.tag!==aE.Jf.DW_TAG_variable||(yield new aM(o,h))}findFunction(o){for(let h of this.dwarf.units)for(let u of h.dieIterator())if(u.tag===aE.Jf.DW_TAG_subprogram){let m=u.attrs.find(o=>o.name===aE.Bp.DW_AT_low_pc),w=u.attrs.find(o=>o.name===aE.Bp.DW_AT_high_pc);if(m&&w){let C=m.value,S=w.value;if(o>=C&&o<S)return new aV(h,u)}}}findLine(o){let h=null;for(let u of this.lines){if(u.pc>o){if(h&&!h.es)return h;return null}h=u}}setBreakpoint(o){this.target.setBreakpoint(o)}removeBreakpoint(o){this.target.clearBreakpoint(o)}setTemporaryBreakpoint(o){this.tempBreakpoints.add(o),this.target.setBreakpoint(o)}nextInstruction(){let{target:o}=this;if(o.isCallInstruction(o.PC)){let h=o.PC+o.instructionSize(o.PC);this.setTemporaryBreakpoint(h),this.simulator.resume(),this.stepOverContext&&(this.stepOverContext.breakPC=h)}else o.stepInstruction()}*backtrace(){let o=new aE.SV(this.dwarf.debugFrame),h=new aE.yy(o,this.target),u=Array(this.target.registerCount).fill(0).map((o,h)=>this.target.readRegister(h)),m=0;for(let o of h.unwind(this.target.PC,this.target.SP,u)){var w;let{sp:h,regs:u}=o,C=o.pc;m>0&&(C=this.target.callAddressBefore(C));let S=null!==(w=this.findLine(C))&&void 0!==w?w:void 0,P=this.findFunction(C);yield new aF({index:m,pc:C,returnPC:o.pc,sp:h,regs:u,line:S,func:P}),m++}}updateActiveLine(o){var h;let u=o.file.endsWith("/sketch.ino")?this.files.find(o=>"sketch"===(0,av.r5)(o.name)):this.files.find(u=>o.file.endsWith(null!==(h=u.debuggerName)&&void 0!==h?h:u.name));this.prevActiveLineFile&&(this.prevActiveLineFile.debugger.setActiveLine(0),this.prevActiveLineFile=void 0),u&&(u.debugger.setActiveLine(o.line),this.prevActiveLineFile=u)}stepInto(){let o=this.findLine(this.target.PC);if(!o){console.warn("No line info for PC",this.target.PC.toString(16)),this.target.stepInstruction();return}for(;;){var h,u;this.target.stepInstruction();let m=this.findLine(this.target.PC);if((null===(h=m)||void 0===h?void 0:h.line)!==o.line||(null===(u=m)||void 0===u?void 0:u.file)!==o.file){m&&this.updateActiveLine(m);break}}}stepOver(){let o=this.findLine(this.target.PC);if(!o){console.warn("No line info for PC",this.target.PC.toString(16)),this.nextInstruction();return}this.stepOverContext={startLine:o,breakPC:-1},this.stepOverNext(o)}stepOverNext(o){for(;this.simulator.paused;){var h,u;let m=this.findLine(this.target.PC);if((null===(h=m)||void 0===h?void 0:h.line)!==o.line||(null===(u=m)||void 0===u?void 0:u.file)!==o.file){this.stepOverContext=void 0;return}this.nextInstruction()}return!1}stepOut(){let o=this.backtrace();o.next();let h=o.next();if(h.done){console.warn("Can't step out of the outermost frame");return}let u=h.value.returnPC;this.setTemporaryBreakpoint(u),this.simulator.resume()}onBreak(){for(let o of this.tempBreakpoints)this.target.clearBreakpoint(o);if(this.tempBreakpoints.clear(),this.stepOverContext){let{breakPC:o,startLine:h}=this.stepOverContext;o===this.target.PC?this.stepOverNext(h):this.stepOverContext=void 0}let o=this.findLine(this.target.PC);o&&this.updateActiveLine(o)}onResume(){for(let o of this.files)o.debugger.setActiveLine(0)}dispose(){for(let o of this.files)o.debugger.activeLine=0;for(let o of this.disposers)o()}constructor(o,h,u,m){for(let w of((0,B._)(this,"target",void 0),(0,B._)(this,"files",void 0),(0,B._)(this,"simulator",void 0),(0,B._)(this,"lines",void 0),(0,B._)(this,"dwarf",void 0),(0,B._)(this,"tempBreakpoints",void 0),(0,B._)(this,"disposers",void 0),(0,B._)(this,"stepOverContext",void 0),(0,B._)(this,"prevActiveLineFile",void 0),this.target=h,this.files=u,this.simulator=m,this.lines=[],this.tempBreakpoints=new Set,this.disposers=new Set,this.dwarf=new aE.X1(new aE.r2(o,new aU.aX(o).sections)),this.dwarf.units)){let o=w.lineNumberMachine();if(o)for(let h of o.run()){let u=o.files[h.file-1];u&&this.lines.push({file:u.dir+"/"+u.name,line:h.line,col:h.column,pc:h.address,ns:h.is_stmt,bb:h.basic_block,pe:h.prologue_end,eb:h.epilogue_begin,es:h.end_sequence})}}let w=u.find(o=>"sketch"===(0,av.r5)(o.name));for(let o of this.files){var C;let h=o.debugger,u=o.name===(null===(C=w)||void 0===C?void 0:C.name)?"sketch.ino":o.name,m=new aO(this,u);for(let o of h.breakpoints)m.setBreakpoint(o.lineNumber);this.disposers.add(h.addDebugger(m))}}}async function aW(o,h,m){var w;let{type:C,flashOffset:S,blockSize:P,numBlocks:D,mkdirs:I}=h;switch(C){case"fat":{let{makeFatFS:h}=await Promise.all([u.e(4102),u.e(1670)]).then(u.bind(u,41670));await h({flash:o.subarray(S),blockSize:P,numBlocks:D,noPartitionTable:!0,mkdirs:I},m);break}case"lfs":{let{makeLittlefs:h}=await Promise.all([u.e(6137),u.e(2235)]).then(u.bind(u,42235));await h({flash:o.subarray(S),blockSize:P,numBlocks:D,mkdirs:I},m)}}for(let u of null!==(w=h.overlays)&&void 0!==w?w:[])o.set(u.data,u.offset)}var aG=u(86954),aH=u(95700),aq=u(5219);class aK{start(){this.stopped=!1}stop(){this.stopped=!0}singleStep(){}runToBreak(){}get cpuMillis(){return this.clock.nanos/1e6}get cpuNanos(){return this.clock.nanos}get running(){return!this.stopped}addEvent(o,h){this.clock.addEvent(o,h)}createEvent(o){return this.clock.createEvent(o)}gdbMessage(){return null}rewindInstruction(){}constructor(){(0,B._)(this,"pins",[]),(0,B._)(this,"clock",void 0),(0,B._)(this,"flash",new Uint8Array(0)),(0,B._)(this,"stopped",!0),(0,B._)(this,"onBreak",void 0),(0,B._)(this,"onDebuggerBreakpoint",void 0),(0,B._)(this,"flashProgAddress",0),(0,B._)(this,"execute",o=>{let{clock:h}=this,u=h.cpu.cycles+this.clock.frequency*(o/1e3);for(;h.cpu.cycles<u&&!this.stopped;)h.skipToNextEvent(u),h.tick();return!this.stopped}),this.clock=new aq.$}}var aj=u(98859);let az=1e3/30;class aX{start(){this.stop(),this.animationFrame=requestAnimationFrame(this.run)}stop(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null)}constructor(o){(0,B._)(this,"execute",void 0),(0,B._)(this,"lastMillis",void 0),(0,B._)(this,"animationFrame",void 0),(0,B._)(this,"afterRun",void 0),(0,B._)(this,"run",void 0),this.execute=o,this.lastMillis=-1,this.animationFrame=null,this.run=o=>{var h,u;let{lastMillis:m}=this,w=o-m;this.lastMillis=o;let C=this.execute(w<az?w:az);null===(h=(u=this).afterRun)||void 0===h||h.call(u),C?this.animationFrame=requestAnimationFrame(this.run):this.animationFrame=null}}}var aQ=u(5301);class aZ{write(){}}var a$=u(94169),aY=u(81e3);class a5{get(o){this.pinNames.includes(o)||console.warn('Part "'.concat(this.partId,'" requested undefined pin: "').concat(o,'"'));let h=(0,a$.r4)(this.partId,o),u=this.pins.get(h);return u||new ie.U(new aY.Y(this.clock),h)}getIfAttached(o){return this.attached(o)?this.get(o):null}attached(o){let h=(0,a$.r4)(this.partId,o);return this.pinNames.includes(o)&&this.pins.has(h)}constructor(o,h,u,m){(0,B._)(this,"partId",void 0),(0,B._)(this,"pinNames",void 0),(0,B._)(this,"pins",void 0),(0,B._)(this,"clock",void 0),this.partId=o,this.pinNames=h,this.pins=u,this.clock=m}}var a3=u(24126),a6=u(16739),a8=u(93480);class a4{clear(){this.nodes.clear(),this.pins.clear()}getOrCreatePin(o){let h=this.pins.get(o);if(!h){let u=new aY.Y(this.clock);this.nodes.set(o,u),h=new ie.U(u,o),this.pins.set(o,h)}return h}constructor(o){(0,B._)(this,"clock",void 0),(0,B._)(this,"nodes",void 0),(0,B._)(this,"pins",void 0),this.clock=o,this.nodes=new Map,this.pins=new Map}}let a7="$mcu";class a9{attach(o){var h,u,m,w;this.netlist.clear();let C=[...o.connections],S=null!==(m=null===(h=o.findMCU())||void 0===h?void 0:h.id)&&void 0!==m?m:a7,P=null===(u=o.board)||void 0===u?void 0:u.pins;for(let o of null!=P?P:[])"string"!=typeof o.target||o.target.includes(":")||C.push(aQ.aG.create(["".concat(S,":").concat(o.name),"".concat(S,":_mcu$").concat(o.target),""]));let D=(0,a$.XP)(C);for(let{pins:o}of new Set(D.values())){let h=new aY.Y(this.mcu);for(let u of o)this.netlist.nodes.set(u,h),this.netlist.pins.set(u,new ie.U(h,u))}for(let o of(this.mcuPinToBoardPin.clear(),this.netPinToMCUPin.clear(),P||this.mcu.pins)){let h=this.netlist.getOrCreatePin((0,a$.r4)(S,o.name));if("target"in o){let u=this.mcu.pins.find(h=>h.name===o.target);if(u)u.attach(h),this.mcuPinToBoardPin.set(u.name,o.name),this.netPinToMCUPin.set((0,a$.r4)(S,o.name),u);else if("string"!=typeof o.target&&"power"===o.target.type){let u=new a6.E(o.name,o.target.voltage?ie.J.High:ie.J.Low);u.attach(h)}}else this.netPinToMCUPin.set((0,a$.r4)(S,o.name),o),o.attach(h)}let{chipControllers:I}=this,{pins:N}=this.netlist,A=[...o.parts.filter(o=>"wokwi-slide-switch"===o.type),...o.parts.filter(o=>"wokwi-slide-switch"!==o.type&&!o.type.startsWith("chip-")),...o.parts.filter(o=>o.type.startsWith("chip-"))];for(let o of A){let h=null!==(w=as[o.type])&&void 0!==w?w:I[o.type];if(h){let u={initFloat:(h,u)=>{o.setFloatVar(h,(0,a3.R)(o.attrs.get(h),u))},readFloat:h=>o.readFloatVar(h,0),listen:(h,u)=>{let m=(0,U.EH)(()=>{u(o.readFloatVar(h,0))});return()=>m()},autorun:U.EH},m=new h(this.mcu,new a5(o.id,h.pinNames,N,this.mcu),o.attrs,u,I);this.controllers.push([o,m])}}this.mcuId=S,this.createSerialMonitor()}async initSimulation(o,h){let u=this.controllers.map(u=>{var m,w;let[,C]=u;return null===(m=(w=C).init)||void 0===m?void 0:m.call(w,{files:o,wifi:h})});await Promise.all(u)}createSerialMonitor(){var o,h,u,m,w;let{mcu:C,mcuPinToBoardPin:S}=this,{pins:P}=this.netlist,{defaultUartPins:D}=this.mcu,I=new a5("$serialMonitor",["RX","TX"],P,C),N=I.getIfAttached("RX"),A=I.getIfAttached("TX"),B=o=>null!==(u=o&&S.get(o))&&void 0!==u?u:o,E=null!==(m=B(null===(o=D)||void 0===o?void 0:o.rx))&&void 0!==m?m:"$_RX",U=null!==(w=B(null===(h=D)||void 0===h?void 0:h.tx))&&void 0!==w?w:"$_TX",O=new a5(this.mcuId,[E,U],P,C);N?this.rx=new $.g(C,N):C.serialInterface?this.rx=C.serialInterface:this.rx=new $.g(C,O.get(E)),this.rx instanceof $.g&&(this.rx.autoBaudRate=!0),A?this.tx=new Y.x(C,A):C.serialInterface?this.tx=C.serialInterface:this.tx=new Y.x(C,O.get(U)),this.tx instanceof Y.x&&(this.tx.autoBaudRate=!0)}update(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],h=[];for(let[u,m]of this.controllers){let w=m.update(o);w&&h.push({id:u.id,update:w})}return h}dispatchEvent(o,h){for(let[w,C]of this.controllers)if(w.id===o){var u,m;null===(u=(m=C).onEvent)||void 0===u||u.call(m,h)}}pause(){for(let[,u]of this.controllers){var o,h;null===(o=(h=u).pause)||void 0===o||o.call(h)}}resume(){for(let[,u]of this.controllers){var o,h;null===(o=(h=u).resume)||void 0===o||o.call(h)}}reset(o){for(let[,h]of this.controllers)h.reset(o)}findPin(o){return this.netlist.pins.get(o)}queryPin(o,h){var u,m;let w=this.netPinToMCUPin.get((0,a$.r4)(o,h));if(!w||w instanceof a6.E||w instanceof a8.n)return null;let C=null===(u=(m=w).peripheralInfo)||void 0===u?void 0:u.call(m),S=this.netlist.getOrCreatePin((0,a$.r4)(this.mcuId,h)).state;return{mode:null!=C?"peripheral":"gpio",signalInfo:null!=C?C:void 0,outputEnable:w.outputEnable,state:S}}get serialRx(){return this.rx}get serialTx(){return this.tx}constructor(o,h){(0,B._)(this,"mcu",void 0),(0,B._)(this,"chipControllers",void 0),(0,B._)(this,"controllers",void 0),(0,B._)(this,"mcuId",void 0),(0,B._)(this,"rx",void 0),(0,B._)(this,"tx",void 0),(0,B._)(this,"netlist",void 0),(0,B._)(this,"mcuPinToBoardPin",void 0),(0,B._)(this,"netPinToMCUPin",void 0),this.mcu=o,this.chipControllers=h,this.controllers=[],this.mcuId=a7,this.rx=new ak,this.tx=new aZ,this.mcuPinToBoardPin=new Map,this.netPinToMCUPin=new Map,this.netlist=new a4(this.mcu)}}var ot=u(4154),oi=u(68490);function os(o,h){let u=o.toString();for(;u.length<h;)u="0"+u;return u}function or(o){let h=Math.floor(1e3*o)%1e3,u=Math.floor(o%60),m=Math.floor(o/60);return"".concat(os(m,2),":").concat(os(u,2),".").concat(os(h,3))}var oa=u(77351),oo=u(79876);async function ol(o){try{return[await o(),null]}catch(o){return[null,o]}}function oh(){return"undefined"!=typeof location&&location.search.includes("build-cache=disable")}!function(o){o[o.Stopped=0]="Stopped",o[o.Running=1]="Running",o[o.Paused=2]="Paused"}(A||(A={}));class od{get running(){return!!this.mcu}get status(){return this.running?this.paused?A.Paused:A.Running:A.Stopped}reportGCCErrors(o,h){if(!this.lastOptions)return;let u=(0,O.G_)(this.lastOptions.files);(0,O.oL)(u)===au.IK&&u.setGCCErrors(o,h)}async build(o,h){var u,m,w,C,S,P,D,I,N,A,B,E,U,O;this.lastOptions=o;let{diagram:L,files:V,listing:F,debug:J,elf:W}=o,G=L.findMCU(),H=parseInt(null!==(A=null===(u=G)||void 0===u?void 0:u.attrs.get("__fakeRamSize"))&&void 0!==A?A:"0",10),X=(0,i1.Z)(null!==(B=null===(m=G)||void 0===m?void 0:m.attrs.get("frequency"))&&void 0!==B?B:"0"),Q=null!==(E=null===(w=G)||void 0===w?void 0:w.attrs.get("env"))&&void 0!==E?E:"",Z=(0,M.nr)(null!==(U=null===(C=G)||void 0===C?void 0:C.type)&&void 0!==U?U:"",Q);if(!Z)return{hex:{hex:""},hexError:"No microcontroller found in project"};let $={elf:W||o.profile,listing:F,debug:J,skipCache:oh(),...H&&{ramSize:H},...X&&{cpuFreq:X},symbols:Z.startsWith("esp32")||Z.startsWith("rp2040")},[Y,tt]=await ol(()=>{var u;return(0,ap.b)(V,{abortSignal:h,board:Z,builder:null===(u=G)||void 0===u?void 0:u.attrs.get("builder"),options:$,userId:o.userId,machineId:o.machineId,localLibraryDirectory:this.localLibraryDirectory,projectId:o.projectId,tempProjectId:o.tempProjectId,buildType:o.preload?"preload":o.thumbnail?"thumbnail":"interactive"})});return(null===(P=Y)||void 0===P?void 0:null===(S=P.stderr)||void 0===S?void 0:S.includes("Error during build"))&&(Y.hex=""),this.reportGCCErrors((null===(D=Y)||void 0===D?void 0:D.stderr)||"",(null!==(O=null===(N=Y)||void 0===N?void 0:null===(I=N.hex)||void 0===I?void 0:I.length)&&void 0!==O?O:0)>0),{hex:Y,hexError:tt}}loadPrebuiltHex(o){return{hex:{hex:o,stderr:"",stdout:""},hexError:null}}skipSDCardDownload(){this.sdCardDownloadSkipped=!0}async ensureSDCardFiles(o){let h=o.filter(o=>o.downloading).map(o=>(0,U.gx)(()=>!o.downloading));return h.length&&(this.showSDCardDownload=!0,this.sdCardDownloadSkipped=!1,await Promise.race([Promise.all(h),(0,U.gx)(()=>this.sdCardDownloadSkipped)]),(0,U.z)(()=>{this.showSDCardDownload=!1})),o.filter(o=>o.buffer).map(o=>({name:o.name.substring(au.ir.length),content:new Uint8Array(o.buffer)}))}getRuntime(o,h,u){var m,w,C,S,P,D;let I=null===(m=h)||void 0===m?void 0:m.split("-"),N=null===(w=I)||void 0===w?void 0:w[0],A=null===(C=I)||void 0===C?void 0:C.slice(1).join("-"),B=o.environments[N];if(!B)return null;switch(N){case"kaluma":let E=null!==(P=null===(S=u.find(o=>"code.js"===o.name))||void 0===S?void 0:S.content)&&void 0!==P?P:"none";B.fs&&(B={...B,fs:{...B.fs,overlays:[{offset:1048576,data:new TextEncoder().encode(E+"\x00")}]}});break;case"circuitpython":B.fs||(B={...B,fs:{type:"fat",flashOffset:2097152,blockSize:512,numBlocks:1024}})}return B.firmware&&B.defaultVersion?{firmwareURL:B.firmware.replace("$VERSION",A||B.defaultVersion),type:null!==(D=B.type)&&void 0!==D?D:"binary",fs:B.fs}:null}async loadCustomBoards(o){await this.boardRegistry.loadBoards(o.parts.map(o=>o.type).filter(o=>o.startsWith("board-")).map(o=>o.replace(/^board-/,"")))}startBuildTimer(){this.buildStartTime&&(this.buildTime=new Date().getTime()-this.buildStartTime.getTime(),setTimeout(()=>this.startBuildTimer(),100))}async start(o){o.debug&&(o={...o,elf:!0}),this.lastOptions=o;let h=null;try{var u,m,w,C,S,P,D,I,N,A,B;null===(u=this.abortController)||void 0===u||u.abort(),this.debuggerEnabled=null!==(P=o.debugger)&&void 0!==P&&P,this.debugging=!!o.debug||this.debuggerEnabled,o.preload||(this.building=!0,this.buildStartTime=new Date),this.abortController=new AbortController,h=this.abortController;let E=this.abortController.signal;this.mcu&&this.stop(),o.preload||this.startBuildTimer(),await this.loadCustomBoards(o.diagram);let{board:U}=o.diagram,O=o.files.find(o=>"main.py"===o.name)?"micropython":"",L=U?this.getRuntime(U,null!==(D=null===(m=o.diagram.findMCU())||void 0===m?void 0:m.attrs.get("env"))&&void 0!==D?D:O,o.files):void 0;this.chipOutput=[];let M=L&&(null===(w=o.diagram.serialMonitor)||void 0===w?void 0:w.display)!=="plotter"?"terminal":null===(C=o.diagram.serialMonitor)||void 0===C?void 0:C.display;if(this.serial.init((0,ac.m)(M)),o.preload&&this.serial.preload(),this.showPioDebugger=!1,!U)return await this.loadHex("",o.diagram,!o.autoPause,new AbortController().signal,o.files,void 0,void 0,o.chips,o.preload);if(rO.files=await this.ensureSDCardFiles(null!==(I=o.sdCardFiles)&&void 0!==I?I:[]),L)return this.startRuntime(L,o,E);let V=null!==(N=o.sideHex)&&void 0!==N?N:this.overrideHex;if(V instanceof ArrayBuffer)return await this.loadHex("",o.diagram,!o.autoPause,E,o.files,V,void 0,o.chips,o.preload);let{hex:F,hexError:J}=V?this.loadPrebuiltHex(V):await this.build(o,E);if(E.aborted){console.log("Build aborted");return}if(this.buildResult=F,J){console.error(J),alert("Build server failure: "+J);return}if(!(null===(S=F)||void 0===S?void 0:S.hex)){this.onBuildFailure(null!==(B=null===(A=F)||void 0===A?void 0:A.stderr)&&void 0!==B?B:"Unknown build error");return}await this.loadHex(F.hex,o.diagram,!o.autoPause,E,o.files,void 0,void 0,o.chips,o.preload)}finally{h&&this.abortController===h&&!o.preload&&(this.building=!1,this.buildStartTime=null,this.abortController=null)}}async startRuntime(o,h,u){try{var m,w;let C=await fetch(o.firmwareURL);if(u.aborted)return;let S="hex"===o.type?await C.text():"",P="binary"===o.type?await C.arrayBuffer():void 0;if(u.aborted)return;let D=null===(m=h.files.find(o=>"requirements.txt"===o.name))||void 0===m?void 0:m.content,I=[...D?await aC(D):[],...h.files,...null!==(w=h.binaryFiles)&&void 0!==w?w:[]];await this.loadHex(S,h.diagram,!0,u,I,P,o.fs,h.chips,h.preload)}finally{this.building=!1}}async createMCURunner(o,h,m,w,C){var S,P,D,I,N,A,B,E;this.wifiManager=void 0,this.symbolStore.reset();let U=C?new Uint8Array(C):void 0;U&&(0,oa.n)(U)&&this.symbolStore.loadELF(U),(null===(S=this.buildResult)||void 0===S?void 0:S.elf)&&this.symbolStore.loadELF((0,aP.Xs)(this.buildResult.elf));let O=(null===(P=this.buildResult)||void 0===P?void 0:P.hex)===h?this.buildResult.symbols:void 0;if(O&&this.symbolStore.loadText(O),!m||!o||!(o in aH.v))return new aK;let L=null!==(D=m.attrs.get("env"))&&void 0!==D?D:"";switch(aH.v[o].family){case"esp32":{let S=new(await Promise.all([u.e(2206),u.e(3758),u.e(9866)]).then(u.bind(u,29866))).ESPRunner(h,m.attrs,{firmwareBinary:C,chip:o,partitionsCsv:(0,av.LR)(null===(I=w)||void 0===I?void 0:I.find(o=>"partitions.csv"===o.name)),symbolStore:this.symbolStore,profile:null===(N=this.lastOptions)||void 0===N?void 0:N.profile});return this.wifiManager=S.wifi,await S.loadBootrom(),await S.init(),S}case"rp2":{let o=new(await Promise.all([u.e(2981),u.e(8777)]).then(u.bind(u,28777))).RPRunner(h,m.attrs,{showPIODebugger:()=>{this.togglePIODebugger(!0)},firmwareBinary:C,patchCircuitPython:null!==(B=L.startsWith("circuitpython-"))&&void 0!==B&&B,symbolStore:this.symbolStore,profile:null===(A=this.lastOptions)||void 0===A?void 0:A.profile});return this.wifiManager=o.wifi,o}case"avr":{let{AVRRunner:w}=await Promise.all([u.e(5863),u.e(8911)]).then(u.bind(u,18911));return new w(h,m.attrs,{chip:o,firmwareBinary:C,profile:null===(E=this.lastOptions)||void 0===E?void 0:E.profile})}case"stm32":return new(await Promise.all([u.e(1311),u.e(5068),u.e(7862),u.e(2776)]).then(u.bind(u,72776))).STM32Runner(h,{chip:o,firmwareBinary:C})}}async loadChips(o){var h;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},w=arguments.length>3?arguments[3]:void 0,C={},S=!1,P=async(o,h)=>{let u="".concat(ar,"/").concat(encodeURIComponent(h)),m=await (await fetch(u+"/chip.json")).json(),w=await (await fetch(u+"/chip.wasm")).arrayBuffer();C[o]=await aB(o,new Uint8Array(w),m,this.chipDebuggerAPI,h=>{this.onChipOutput(o,h)})},D=[];for(let[o,h]of Object.entries(m))D.push(P(o,h));for(let o of u){let h="chip-"+o.name;C[h]=await aB(h,new Uint8Array(o.binary),o.json,this.chipDebuggerAPI,o=>{this.onChipOutput(h,o)})}let I=async h=>{var u,m,P;let D=h.name.split(".")[0],I=D+".chip.json",N="chip-"+D,A=null!==(m=null===(u=o.find(o=>o.name===I))||void 0===u?void 0:u.content)&&void 0!==m?m:"",B=null!==(P=(0,oo.C)("string"==typeof A?A:new TextDecoder().decode(A)))&&void 0!==P?P:{},E=await aR(N,h.content,B,h.name.endsWith(".rs")?"rust":h.name.endsWith(".v")?"verilog":"c",w,o=>{S=!0,this.reportGCCErrors(o,!1),this.onBuildFailure(o)},o=>{this.onChipOutput(N,o)},this.chipDebuggerAPI);E&&(C[N]=E)};return D.push(...null===(h=o)||void 0===h?void 0:h.filter(o=>"chip"===(0,av.r5)(o.name)).map(I)),await Promise.all(D),S?null:C}async loadHex(o,h){var u,m,w,C,S,P,D,I,N,A,B,E,U,O;let L=!(arguments.length>2)||void 0===arguments[2]||arguments[2],M=arguments.length>3?arguments[3]:void 0,V=arguments.length>4?arguments[4]:void 0,F=arguments.length>5?arguments[5]:void 0,J=arguments.length>6?arguments[6]:void 0,W=arguments.length>7?arguments[7]:void 0,G=arguments.length>8?arguments[8]:void 0,H=h.findMCU(),X={...h.dependencies.toJSON()};for(let o of h.parts)for(let h of this.boardRegistry.getBoardChips(o.type))X[h.type]=h.type;let Q=V?await this.loadChips(V,W,X,G?"preload":"interactive"):{};if(!Q)return;let Z=0,$=0,Y=()=>{let o=new Date().getTime(),h=tt.cpuMillis;if(this.speedElement&&o-Z>500){let u=(h-$)/(o-Z);$=h,Z=o,this.speedElement.textContent="".concat(Math.floor(100*u).toFixed(0),"%")}this.timeElement&&(this.timeElement.textContent=or(h/1e3))},tt=await this.createMCURunner(null!==(D=null===(u=h.board)||void 0===u?void 0:u.mcuType)&&void 0!==D?D:null,o,H,V,F);if(this.scheduler=new this.SimulationSchedulerFactory(tt.execute),this.scheduler.afterRun=Y,null===(m=M)||void 0===m?void 0:m.aborted)return;if((null===(w=this.buildResult)||void 0===w?void 0:w.hex)===o&&this.buildResult.elf&&this.debuggerEnabled&&tt.debuggerTarget){let o=(null!=V?V:[]).filter(o=>au.d$.is(o));this.debuggerSourceFiles=null!==(N=null===(I=this.buildResult.debugSources)||void 0===I?void 0:I.map(o=>{var h;let[u,m]=o,w=null!==(h=u.split("/").pop())&&void 0!==h?h:u;return{name:w,debuggerName:u,content:m,debugger:new ad.r,readonly:!0}}))&&void 0!==N?N:[],this.debugger=new aJ((0,aP.Xs)(this.buildResult.elf),tt.debuggerTarget,[...o,...this.debuggerSourceFiles],this)}if(V&&J&&(null===(A=(B=tt).adjustFSConfig)||void 0===A||A.call(B,J),await aW(tt.flash,J,V),null===(E=M)||void 0===E?void 0:E.aborted)||G)return;let te=new a9(tt,Q);te.attach(h),this.wifiManager||(this.wifiManager=new oi.c(tt)),this.wifiManager.setCredentials({user:null!==(U=null===(C=this.lastOptions)||void 0===C?void 0:C.userId)&&void 0!==U?U:"",project:null!==(O=null===(S=this.lastOptions)||void 0===S?void 0:S.projectId)&&void 0!==O?O:""}),this.wifiGateway&&this.wifiManager.setGateway(this.wifiGateway),await te.initSimulation(null!=V?V:[],this.wifiManager),this.simulationController=te,this.lastUpdatedNanos=-1,this.bufferedSerialRx.switchTo(te.serialRx),this.serialMontiorDisabled=(null===(P=h.serialMonitor)||void 0===P?void 0:P.display)==="never",tt.onBreak=()=>!!this.debugging&&(tt.rewindInstruction(),this.breakpoint=!0,this.pause(),!0),tt.onDebuggerBreakpoint=()=>{this.pause()},this.mcu=tt,this.breakpoint=!1,L?this.resume():this.paused=!0,this.restarting=!1,this.update()}update(){var o;let h=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{simulationController:u,mcu:m}=this;if(u&&m){if(m.cpuNanos!==this.lastUpdatedNanos){let o={};for(let{id:m,update:w}of(this.bufferedSerialRx.update(),u.update(h)))o[m]=w.value;this.lastUpdate=o,this.lastUpdatedNanos=m.cpuNanos,Object.assign(this.partValues,o)}(null===(o=this.mcu)||void 0===o?void 0:o.running)&&("undefined"!=typeof requestAnimationFrame?requestAnimationFrame(()=>this.update()):setTimeout(()=>this.update(),10))}}dispatchEvent(o,h){var u;null===(u=this.simulationController)||void 0===u||u.dispatchEvent(o,h)}pause(){var o,h,u,m,w;this.update(!0),null===(o=this.mcu)||void 0===o||o.stop(),null===(h=this.debugger)||void 0===h||h.onBreak(),this.updateDebugger(),null===(u=this.simulationController)||void 0===u||u.pause(),this.paused=!0;let C=null===(m=this.mcu)||void 0===m?void 0:m.profileEvents;(null===(w=this.lastOptions)||void 0===w?void 0:w.profile)&&C&&(0,aj.P)(C,this.symbolStore)}resume(){var o,h,u,m;this.paused=!1,this.breakpoint=!1,null===(o=this.debugger)||void 0===o||o.onResume(),null===(h=this.mcu)||void 0===h||h.start(),null===(u=this.scheduler)||void 0===u||u.start(),null===(m=this.simulationController)||void 0===m||m.resume(),this.update()}stop(){var o,h,u,m,w;null===(o=this.simulationController)||void 0===o||o.reset(!0),this.update(),this.debuggerSourceFiles=[],null===(h=this.debugger)||void 0===h||h.dispose(),null===(u=this.scheduler)||void 0===u||u.stop(),null===(m=this.mcu)||void 0===m||m.stop(),null===(w=this.wifi)||void 0===w||w.disconnect(),this.mcu=null,this.scheduler=null,this.paused=!1,this.simulationController=null,this.partValues={},this.speedElement&&(this.speedElement.textContent="0%")}abortBuild(){var o;null===(o=this.abortController)||void 0===o||o.abort()}feedSerial(o){var h;null===(h=this.simulationController)||void 0===h||h.serialTx.write(new TextEncoder().encode(o))}feedSerialBytes(o){var h;null===(h=this.simulationController)||void 0===h||h.serialTx.write(o)}serialControl(o){var h,u;null===(u=this.mcu)||void 0===u||null===(h=u.setSerialControlPins)||void 0===h||h.call(u,o)}get pins(){var o;return null===(o=this.simulationController)||void 0===o?void 0:o.netlist.pins}findPin(o){var h;return null===(h=this.simulationController)||void 0===h?void 0:h.findPin(o)}togglePIODebugger(o){this.showPioDebugger=o}singleStep(){var o,h;this.breakpoint=!1,null===(h=this.mcu)||void 0===h||null===(o=h.singleStep)||void 0===o||o.call(h),this.update(!0)}forceUpdate(){this.lastUpdatedNanos=-1,this.update(!0)}queryPin(o,h){var u,m;return null!==(m=null===(u=this.simulationController)||void 0===u?void 0:u.queryPin(o,h))&&void 0!==m?m:null}get lastUpdateNanos(){return this.lastUpdatedNanos}closeProject(){this.stop(),this.serial.clearSerial(),this.serial.hideSerial(),this.chipOutput=[],this.wifiManager=void 0}gdbMessage(o){var h;if("c"===o||o.startsWith("vCont;c"))return this.paused&&this.resume(),null;if("s"===o)return this.singleStep(),(0,aG.KC)("S05");if(o.startsWith("vFile:"))return this.gdbFileMessage(o);if(o.startsWith("qRcmd,")){let h=this.gdbMonitor((0,aG.nX)(o.split(",")[1]));if(h)return h}let u=null===(h=this.mcu)||void 0===h?void 0:h.gdbMessage(o,()=>{this.paused&&this.forceUpdate()});return u}gdbMonitor(o){var h;let u=null!==(h=o.split(" ")[1])&&void 0!==h?h:"";switch(o){case"reset":case"reset debug":case"reset halt":case"reset init":if(this.lastOptions)return console.log("Restarting simulation..."),this.restarting=!0,this.start({...this.lastOptions,autoPause:""!==u,..."debug"===u?{elf:!0,debug:!0}:{}}),(0,aG.KC)("O"+(0,aG.Nc)("Restarting simulation...\n"))+(0,aG.KC)("OK");return(0,aG.KC)("")}}gdbFileMessage(o){let[,h,u]=o.split(":");switch(h){case"open":{let o=u.split(","),h=(0,aG.nX)(o[0]);if("sketch.elf"===h)return(0,aG.KC)("F 1");break}case"pread":{let o=u.split(",").map(o=>parseInt(o,16)),[h,w,C]=o;if(1!==h)return(0,aG.KC)("F -1");{var m;let o=null===(m=this.buildResult)||void 0===m?void 0:m.elf;if(!o)return(0,aG.KC)("F 0;");let h=o.substr(C,w);return(0,aG.KC)("F ".concat(h.length.toString(16),";").concat(h))}}case"close":if("1"===u)return(0,aG.KC)("F 0");return(0,aG.KC)("F -1")}return(0,aG.KC)("")}get tempRunner(){return this.mcu}get serialRx(){return this.bufferedSerialRx}get wifi(){return this.wifiManager}get debuggerFiles(){return this.debuggerSourceFiles.filter(o=>o.debugger.activeLine>0)}stepInto(){var o;this.paused&&(null===(o=this.debugger)||void 0===o||o.stepInto(),this.updateDebugger())}stepOver(){var o;this.paused&&(null===(o=this.debugger)||void 0===o||o.stepOver(),this.updateDebugger())}stepOut(){var o;this.paused&&(null===(o=this.debugger)||void 0===o||o.stepOut(),this.updateDebugger())}updateDebugger(){this.debugger&&this.debuggerStore.update(this.debugger)}clearChipOutput(){this.chipOutput=[]}constructor(o){(0,B._)(this,"serial",void 0),(0,B._)(this,"abortController",void 0),(0,B._)(this,"simulationController",void 0),(0,B._)(this,"scheduler",void 0),(0,B._)(this,"lastOptions",void 0),(0,B._)(this,"bufferedSerialRx",void 0),(0,B._)(this,"boardRegistry",void 0),(0,B._)(this,"debuggerStore",void 0),(0,B._)(this,"symbolStore",void 0),(0,B._)(this,"chipDebuggerAPI",void 0),(0,B._)(this,"SimulationSchedulerFactory",void 0),(0,B._)(this,"mcu",void 0),(0,B._)(this,"building",void 0),(0,B._)(this,"buildTime",void 0),(0,B._)(this,"buildStartTime",void 0),(0,B._)(this,"paused",void 0),(0,B._)(this,"restarting",void 0),(0,B._)(this,"breakpoint",void 0),(0,B._)(this,"debugging",void 0),(0,B._)(this,"debuggerEnabled",void 0),(0,B._)(this,"buildResult",void 0),(0,B._)(this,"showPioDebugger",void 0),(0,B._)(this,"showSDCardDownload",void 0),(0,B._)(this,"sdCardDownloadSkipped",void 0),(0,B._)(this,"serialMontiorDisabled",void 0),(0,B._)(this,"lastUpdate",void 0),(0,B._)(this,"debuggerSourceFiles",void 0),(0,B._)(this,"lastUpdatedNanos",void 0),(0,B._)(this,"debugger",void 0),(0,B._)(this,"wifiManager",void 0),(0,B._)(this,"partValues",void 0),(0,B._)(this,"overrideHex",void 0),(0,B._)(this,"wifiGateway",void 0),(0,B._)(this,"localLibraryDirectory",void 0),(0,B._)(this,"speedElement",void 0),(0,B._)(this,"timeElement",void 0),(0,B._)(this,"chipOutput",void 0),(0,B._)(this,"onChipOutput",void 0),(0,B._)(this,"onBuildFailure",void 0),this.serial=o,this.abortController=null,this.simulationController=null,this.scheduler=null,this.lastOptions=null,this.bufferedSerialRx=new aS(new ak),this.boardRegistry=new al,this.debuggerStore=new ah,this.symbolStore=new ot.O,this.SimulationSchedulerFactory=aX,this.mcu=null,this.building=!1,this.buildTime=0,this.buildStartTime=null,this.paused=!1,this.restarting=!1,this.breakpoint=!1,this.debugging=!1,this.debuggerEnabled=!1,this.buildResult=null,this.showPioDebugger=!1,this.showSDCardDownload=!1,this.sdCardDownloadSkipped=!1,this.serialMontiorDisabled=!1,this.lastUpdate={},this.debuggerSourceFiles=[],this.lastUpdatedNanos=-1,this.partValues={},this.speedElement=null,this.timeElement=null,this.chipOutput=[],this.onChipOutput=(o,h)=>{this.chipOutput.length>1e3&&this.chipOutput.shift(),this.chipOutput.push({chip:o,message:h})},this.onBuildFailure=o=>{console.log(o),alert("Build failed!")},(0,U.rC)(this),this.chipDebuggerAPI=new ax(this,this.symbolStore),this.bufferedSerialRx.subscribe(o=>{if(!this.serialMontiorDisabled)for(let h of(this.serial.showSerial(),o))this.serial.appendSerial(h)}),window.addEventListener("visibilitychange",()=>{if(!this.paused){var o,h;document.hidden?null===(o=this.simulationController)||void 0===o||o.pause():null===(h=this.simulationController)||void 0===h||h.resume()}})}}(0,E.gn)([U.LO],od.prototype,"mcu",void 0),(0,E.gn)([U.LO],od.prototype,"building",void 0),(0,E.gn)([U.LO],od.prototype,"buildTime",void 0),(0,E.gn)([U.LO],od.prototype,"paused",void 0),(0,E.gn)([U.LO],od.prototype,"restarting",void 0),(0,E.gn)([U.LO],od.prototype,"breakpoint",void 0),(0,E.gn)([U.LO],od.prototype,"debugging",void 0),(0,E.gn)([U.LO],od.prototype,"debuggerEnabled",void 0),(0,E.gn)([U.LO],od.prototype,"buildResult",void 0),(0,E.gn)([U.LO],od.prototype,"showPioDebugger",void 0),(0,E.gn)([U.LO],od.prototype,"showSDCardDownload",void 0),(0,E.gn)([U.LO],od.prototype,"sdCardDownloadSkipped",void 0),(0,E.gn)([U.LO],od.prototype,"serialMontiorDisabled",void 0),(0,E.gn)([U.LO],od.prototype,"lastUpdate",void 0),(0,E.gn)([U.LO],od.prototype,"debuggerSourceFiles",void 0),(0,E.gn)([U.LO],od.prototype,"wifiManager",void 0),(0,E.gn)([U.LO],od.prototype,"partValues",void 0),(0,E.gn)([U.Fl],od.prototype,"running",null),(0,E.gn)([U.Fl],od.prototype,"status",null),(0,E.gn)([U.LO],od.prototype,"chipOutput",void 0),(0,E.gn)([U.aD],od.prototype,"start",null),(0,E.gn)([U.aD],od.prototype,"startRuntime",null),(0,E.gn)([U.aD],od.prototype,"loadHex",null),(0,E.gn)([U.aD],od.prototype,"update",null),(0,E.gn)([U.aD],od.prototype,"togglePIODebugger",null)},21375:function(o,h,u){u.d(h,{V:function(){return S},m:function(){return C}});var m=u(75766),w=u(68949);function C(o){switch(o){case"never":case"always":case"auto":case"plotter":case"terminal":return o;default:return"auto"}}class S{init(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";this.show="always"===o||"plotter"===o,this.showPlotter="plotter"===o,this.terminalMode="terminal"===o,this.clearSerial()}async preload(){this.terminalMode&&await Promise.all([u.e(6142),u.e(7203)]).then(u.bind(u,97203))}showSerial(){this.show=!0}hideSerial(){this.show=!1}clearSerial(){this.lines=[],this.textBuffer="",this.serialUTF8Sequence=[],this.bytesBuffer=[]}appendSerial(o){if(this.show=!0,this.terminalMode){var h,u;this.bytesBuffer.push(o),null===(h=(u=this).listener)||void 0===h||h.call(u);return}if(o>127&&this.serialUTF8Sequence.push(o),this.serialUTF8Sequence.length>1){let o=new TextDecoder("utf-8",{fatal:!0});try{let h=o.decode(new Uint8Array(this.serialUTF8Sequence));this.textBuffer=this.textBuffer.slice(0,-(this.serialUTF8Sequence.length-1))+h,this.serialUTF8Sequence=[];return}catch(o){}}if(this.textBuffer+=String.fromCharCode(o),this.textBuffer.endsWith("\n")){let o=this.textBuffer.substr(0,this.textBuffer.length-1);this.logToConsole&&console.log("[Serial] %c%s","color: blue",o),this.lines.push(o),this.textBuffer=""}}togglePlotter(){this.showPlotter=!this.showPlotter}constructor(){(0,m._)(this,"show",!1),(0,m._)(this,"terminalMode",!1),(0,m._)(this,"showPlotter",!1),(0,m._)(this,"logToConsole",!0),(0,m._)(this,"textBuffer",""),(0,m._)(this,"lines",[]),(0,m._)(this,"bytesBuffer",[]),(0,m._)(this,"serialUTF8Sequence",[]),(0,m._)(this,"listener",void 0),(0,w.ky)(this,{serialUTF8Sequence:!1})}}},96379:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{P:function(){return cacheKey},a:function(){return hashCacheKey}});let sortByName=(o,h)=>o.name<h.name?-1:o.name>h.name?1:0;function cacheKey(o){var h,u,m,w,C,S;let{builder:P,board:D,sketch:I,files:N,options:A}=o,B=[...N].sort(sortByName);return JSON.stringify([["version",1],["builder",P],["board",D],["file","sketch.ino",I.trim()],...(null===(h=A)||void 0===h?void 0:h.elf)?["option","elf"]:[],...(null===(u=A)||void 0===u?void 0:u.listing)?["option","listing"]:[],...(null===(m=A)||void 0===m?void 0:m.debug)?["option","debug"]:[],...(null===(w=A)||void 0===w?void 0:w.symbols)?["option","symbols"]:[],...(null===(C=A)||void 0===C?void 0:C.ramSize)?["option","ramSize",A.ramSize]:[],...(null===(S=A)||void 0===S?void 0:S.cpuFreq)?["option","cpuFreq",A.cpuFreq]:[],...B.map(o=>{let{name:h,content:u}=o;return["file",h,u.trim()]})])}async function hashCacheKey(key){if("undefined"==typeof crypto)return eval("require")("crypto").createHash("sha256").update(key).digest("hex");try{let encoder=new TextEncoder,hashBuffer=await crypto.subtle.digest("sha-256",encoder.encode(key)),hashArray=Array.from(new Uint8Array(hashBuffer));return hashArray.map(o=>o.toString(16).padStart(2,"0")).join("")}catch(err){return console.warn("Hash generation failed",err),null}}},8853:function(o,h,u){u.d(h,{I:function(){return O},b:function(){return M}});var m=u(75766);let w="/_cache/hexi/";class C{async put(o,h){try{let u=await this.cache,m=86400;await u.put(w+o,new Response(JSON.stringify(h),{headers:{"content-type":"application/json","cache-control":"public, max-age=".concat(30*m)}}))}catch(o){console.warn(o);return}}async get(o){try{let h=await this.cache,u=await h.match(w+o);if(u)return await u.json()}catch(o){console.warn(o)}return null}async clear(){throw Error("Method not implemented.")}constructor(){(0,m._)(this,"cache",void 0),this.cache=caches.open("hexi-cache")}}var S=u(96379),P=u(69246),D=u(54499),I=u(54619);async function N(o,h){if(!h)return[];let u=[];for(let m of(0,D.h)(null!=o?o:"")){let o=m.replace(/\s/g,"_"),w=await h.getDirectoryHandle(o).catch(()=>null);w&&u.push(...await (0,P.Jj)(w,async o=>{if(!["header","source","libraries","sketch"].includes((0,I.r5)(o.name))&&"library.properties"!==o.name)return;let u=await h.resolve(o);if(u&&"examples"!==u[1])return{name:"libraries/".concat(u.join("/")),content:await (await o.getFile()).text()}}))}return u}let A={name:"_wokwi_mbed_speedup_patch.cpp",content:'namespace{\nextern "C" void rtos_attach_idle_hook(void*ptr);\nstatic void idle() {asm("wfe");}\nclass M{public:M();};\nM::M(){rtos_attach_idle_hook((void*)idle);}\nstatic class M __attribute__((used)) c;\n}'};class B{put(o,h){this.cache.set(o,h)}get(o){var h;return null!==(h=this.cache.get(o))&&void 0!==h?h:null}clear(){this.cache.clear()}constructor(){(0,m._)(this,"cache",new Map)}}var E=u(83454);let U=E.env.HEXI_URL||"https://wokwi.com",O="undefined"!=typeof localStorage&&"1"===localStorage.getItem("__browserCache")?new C:new B;function L(){let o="undefined"!=typeof localStorage&&localStorage.getItem("__hexi");return o||U}async function M(o,h){var u,m,w,C,P,D,B,E;let U=o.find(o=>"sketch"===(0,I.r5)(o.name)),M=o.find(o=>"libraries"===(0,I.r5)(o.name)),V=["header","source","libraries","sketch","rust-manifest"],F=[...o.filter(o=>V.includes((0,I.r5)(o.name))&&o!==U),...await N(null!==(C=null===(u=M)||void 0===u?void 0:u.content)&&void 0!==C?C:"",h.localLibraryDirectory)],J=(null===(m=U)||void 0===m?void 0:m.content)||"",W=h.builder,G=null!==(P=h.board)&&void 0!==P?P:"uno";"pipico"!==G||W||F.push(A);let H=h.cache||O,X=await (0,S.a)((0,S.P)({builder:null!=W?W:"",board:G,sketch:J,files:F,options:h.options})),Q=X&&await H.get(X);if(Q)return Promise.resolve(Q);let Z={sketch:J,files:F,board:G,options:h.options,builder:W,infra:h.machineId&&"private:".concat(h.machineId),projectId:null!==(B=null!==(D=null===(w=h.projectId)||void 0===w?void 0:w.replace("wokwi:","wokwi-"))&&void 0!==D?D:h.tempProjectId)&&void 0!==B?B:"unknown",w:{b:h.buildType,p:null!==(E=h.projectId)&&void 0!==E?E:"undefined"!=typeof location?location.pathname:void 0,u:h.userId}},$=await fetch(L()+"/build",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z),signal:h.abortSignal});if(502===$.status)throw Error("Project compilation takes too long. Please remove some libraries and try again, or try to compile the project on your computer and use Wokwi for VS Code to simulate it.");let Y={...await $.json(),cacheKey:X};return X&&await H.put(X,Y),Y}},54499:function(o,h,u){function*m(o){for(let h of o.split("\n")){let o=h.trim();o.length&&"#"!==o[0]&&(yield o)}}u.d(h,{h:function(){return m},i:function(){return w}});let w={"Adafruit_NeoPixel.h":"Adafruit NeoPixel","Adafruit_GFX.h":"Adafruit GFX Library","DHT.h":"DHT sensor library","DHT_U.h":"DHT sensor library","FastLED.h":"FastLED","Key.h":"Keypad","Keypad.h":"Keypad","LiquidCrystal.h":"LiquidCrystal","LiquidCrystal_I2C.h":"LiquidCrystal I2C","MD_Parola.h":"MD_Parola","RTClib.h":"RTClib","SD.h":"SD","Servo.h":"Servo","SevSeg.h":"SevSeg","U8glib.h":"U8glib"}},58269:function(o,h,u){u.d(h,{Q:function(){return C}});var m=u(75766);let w=256;class C{peek(){return this.fifoIndex<this.fifo.length?this.fifo[this.fifoIndex]:null}get available(){return this.fifo.length-this.fifoIndex}next(){if(this.fifoIndex<this.fifo.length){let o=this.fifo[this.fifoIndex++];return this.fifoIndex>=w&&(this.fifo.splice(0,w),this.fifoIndex-=w),o}return null}write(o){this.fifo.push(...o)}writeByte(o){this.fifo.push(o)}constructor(){(0,m._)(this,"fifo",[]),(0,m._)(this,"fifoIndex",0)}}},24126:function(o,h,u){u.d(h,{R:function(){return m}});function m(o,h){if(null==o)return h;let u=parseFloat(o);return isNaN(u)?h:u}},70413:function(o,h,u){u.d(h,{Cb:function(){return C},al:function(){return D},bf:function(){return w}});var m=u(75766);let w=64,C=32,S=["R1","G1","B1","R2","G2","B2"],P=["A","B","C","D","E"];class D{update(){return this.updated?(this.updated=!1,{value:{pixels:this.pixels}}):null}reset(){for(let o of this.input)o.fill(0);for(let o of this.buffer)o.fill(0);this.pixels.fill(0)}constructor(o,h){(0,m._)(this,"pixels",new Uint32Array(C*w)),(0,m._)(this,"input",S.map(()=>new Uint8Array(w/8))),(0,m._)(this,"buffer",S.map(()=>new Uint8Array(w/8))),(0,m._)(this,"address",0),(0,m._)(this,"updated",!1),(0,m._)(this,"copy",()=>{this.updated=!0;let{buffer:o}=this,h=this.address*w,u=(C/2+this.address)*w;for(let m=0;m<w;m++){let C=m>>3,S=7&m,P=o[0][C]&1<<S?255:0,D=o[1][C]&1<<S?255:0,I=o[2][C]&1<<S?255:0,N=o[3][C]&1<<S?255:0,A=o[4][C]&1<<S?255:0,B=o[5][C]&1<<S?255:0;this.pixels[h+w-1-m]=P<<16|D<<8|I,this.pixels[u+w-1-m]=N<<16|A<<8|B}});let u=S.map(o=>h.get(o)),D=P.map(o=>h.get(o)),I=h.get("OE");D.forEach((o,h)=>{let u=1<<h;this.address|=o.value?u:0,o.onValueChange(o=>{o?this.address|=u:this.address&=~u,I.value||this.copy()})});let N=(o,h)=>{let u=h?1:0;for(let h=0;h<o.length;h++){let m=o[h]<<1|u;u=128&o[h]?1:0,o[h]=m}},{input:A,buffer:B}=this;h.get("CLK").onValueChange(o=>{o&&(N(A[0],u[0].value),N(A[1],u[1].value),N(A[2],u[2].value),N(A[3],u[3].value),N(A[4],u[4].value),N(A[5],u[5].value))}),h.get("OE").onValueChange(o=>{o||this.copy()}),h.get("LAT").onValueChange(o=>{o&&(B[0].set(A[0]),B[1].set(A[1]),B[2].set(A[2]),B[3].set(A[3]),B[4].set(A[4]),B[5].set(A[5]),I.value||this.copy())})}}(0,m._)(D,"pinNames",[...S,...P,"CLK","LAT","OE","GND"])},44982:function(o,h,u){u.d(h,{j:function(){return A},s:function(){return m}});var m,w=u(75766),C=u(37991);!function(o){o.load="load"}(m||(m={}));let S=1e3,P=60*S,D=10,I=Math.round(1e9/D),N=3.28125;class A{updateGain(){switch(this.bitIndex){case 24:this.channel=0,this.gain=128;break;case 25:this.channel=1,this.gain=32;break;default:this.channel=0,this.gain=64}}read(){return 1==this.channel?0:this.vars.readFloat(m.load)*N*this.gain}update(){return null}reset(){this.lastChange=0,this.nextSampleTime=0}constructor(o,h,u,m){(0,w._)(this,"clock",void 0),(0,w._)(this,"vars",void 0),(0,w._)(this,"outValue",void 0),(0,w._)(this,"bitIndex",void 0),(0,w._)(this,"lastChange",void 0),(0,w._)(this,"channel",void 0),(0,w._)(this,"gain",void 0),(0,w._)(this,"nextSampleTime",void 0),(0,w._)(this,"sck",void 0),(0,w._)(this,"dt",void 0),(0,w._)(this,"acquireSample",void 0),this.clock=o,this.vars=m,this.outValue=0,this.bitIndex=0,this.lastChange=0,this.channel=0,this.gain=128,this.nextSampleTime=0,this.acquireSample=()=>{let{clock:o}=this;o.cpuNanos<=this.nextSampleTime?this.sck.value||(this.nextSampleTime+=I,o.addEvent(I,this.acquireSample),this.outValue=this.read(),this.bitIndex=0,this.dt.setState(C.J.Low)):this.clock.addEvent(this.clock.cpuNanos-I,this.acquireSample)},this.sck=h.get("SCK"),this.dt=h.get("DT"),this.sck.setState(C.J.PullUp),this.dt.setState(C.J.High),this.sck.onValueChange(h=>{let{lastChange:u,bitIndex:m}=this;if(h){if(m<24){let o=this.outValue&1<<23-m;this.dt.setState(o?C.J.High:C.J.Low)}else this.dt.setState(C.J.High),this.updateGain(),this.nextSampleTime=o.cpuNanos+I;this.bitIndex++}else o.cpuNanos-u>P&&(this.nextSampleTime=o.cpuNanos+I,o.addEvent(I,this.acquireSample));this.lastChange=o.cpuNanos})}}(0,w._)(A,"pinNames",["GND","DT","SCK","VCC"])},39555:function(o,h,u){u.d(h,{_:function(){return tm},g:function(){return m}});var m,w=u(57121),C=u(82463),S=u(25321),P=u(75766),D=u(25025),I=u(7436),N=u(96094);function A(o,h,u){let m=null,w=()=>{let w=o.driven&&h.driven&&o.value&&!h.value;m!==w&&u(m=w)};w(),o.onValueChange(w),h.onValueChange(w)}let B=104,E=118,U=13,O=27,L=28,M=52,V=55,F=56,J=59,W=60,G=61,H=62,X=63,Q=64,Z=65,$=66,Y=67,tt=68,te=69,ti=70,tn=71,tr=72,ta=99,to=107,tl=116,th=117,td=3,tu=3,tc=3,tp=3,tv=-32768,tg=32767;!function(o){o.temperature="temperature",o.accelX="accelX",o.accelY="accelY",o.accelZ="accelZ",o.rotationX="rotationX",o.rotationY="rotationY",o.rotationZ="rotationZ"}(m||(m={}));var tf=new WeakMap;class tm{setTemperature(o){let h=Math.round((o-36.53)*340);this.registers[Z]=h>>8&255,this.registers[$]=255&h}setAcceleration(o,h,u){let m=this.registers[L]>>tc&tp,w=[16384,8192,4096,2048][m],C=0|(0,D.u)(w*o,tv,tg),S=0|(0,D.u)(w*h,tv,tg),P=0|(0,D.u)(w*u,tv,tg);this.registers[J]=C>>8&255,this.registers[W]=255&C,this.registers[G]=S>>8&255,this.registers[H]=255&S,this.registers[X]=P>>8&255,this.registers[Q]=255&P}setRotation(o,h,u){let m=this.registers[O]>>td&tu,w=[131,65.5,32.8,16.4][m],C=0|(0,D.u)(w*o,tv,tg),S=0|(0,D.u)(w*h,tv,tg),P=0|(0,D.u)(w*u,tv,tg);this.registers[Y]=C>>8&255,this.registers[tt]=255&C,this.registers[te]=S>>8&255,this.registers[ti]=255&S,this.registers[tn]=P>>8&255,this.registers[tr]=255&P}update(){return this.updated?(this.updated=!1,{value:{ledOn:this.ledOn}}):null}reset(){let{vars:o}=this;this.registers.fill(0),this.registers[to]=64,this.registers[th]=104,this.addr=0,o.initFloat(m.accelX,0),o.initFloat(m.accelY,0),o.initFloat(m.accelZ,1),o.initFloat(m.rotationX,0),o.initFloat(m.rotationY,0),o.initFloat(m.rotationZ,0),o.initFloat(m.temperature,24)}constructor(o,h,u,D){(0,P._)(this,"clock",void 0),(0,P._)(this,"vars",void 0),(0,P._)(this,"registers",void 0),(0,P._)(this,"addr",void 0),(0,P._)(this,"updated",void 0),(0,P._)(this,"ledOn",void 0),(0,C._)(this,tf,{writable:!0,value:void 0}),this.clock=o,this.vars=D,this.registers=new Uint8Array(E),this.addr=0,this.updated=!1,this.ledOn=!1,(0,S._)(this,tf,!1);let J=h.get("AD0"),W=new N.A({scl:h.get("SCL"),sda:h.get("SDA")});(0,I.u)(W,B,[J]),A(h.get("VCC"),h.get("GND"),o=>{this.ledOn=o,this.updated=!0}),this.reset();let G=()=>{this.setAcceleration(D.readFloat(m.accelX),D.readFloat(m.accelY),D.readFloat(m.accelZ))},H=()=>{this.setRotation(D.readFloat(m.rotationX),D.readFloat(m.rotationY),D.readFloat(m.rotationZ))};D.autorun(G),D.autorun(H),D.autorun(()=>{this.setTemperature(D.readFloat(m.temperature))}),W.onConnect=()=>((0,S._)(this,tf,!0),!0),W.onReadByte=()=>{let o=this.registers[this.addr];return this.addr=(this.addr+1)%E,o},W.onWriteByte=o=>{if((0,w._)(this,tf))return this.addr=o,(0,S._)(this,tf,!1),!0;let h=!0,u=!1,{addr:m}=this;switch(m){case to:this.registers[to]=127&o;break;case V:case F:u=!0;break;default:m>=U&&m<=M||m>=ta&&m<=tl?(u=!0,h=!0):h=!1}return u&&(this.registers[m]=o),m===L?G():m===O&&H(),this.addr=(this.addr+1)%E,h}}}(0,P._)(tm,"pinNames",["VCC","GND","SCL","SDA","AD0","INT"])},68720:function(o,h,u){u.d(h,{W:function(){return S},l:function(){return P}});var m=u(75766),w=u(37991),C=u(24126);let S=500;class P{onEvent(o){this.lux=o.lux,this.luxUpdated()}luxUpdated(){let{gamma:o,c:h,lux:u}=this,m=5,C=10**h/Math.max(u,.001)**o,S=C/(1e4+C)*m;this.analogOut.node.analogPort.write(S);let P=S>this.threshold;this.digitalOut.setState(P?w.J.High:w.J.Low),!P!==this.ledOut&&(this.ledOut=!P,this.updated=!0)}update(){return this.updated?{value:{ledOn:!0,ledDigitalOut:this.ledOut}}:null}reset(){}constructor(o,h,u){(0,m._)(this,"lux",void 0),(0,m._)(this,"gamma",void 0),(0,m._)(this,"c",void 0),(0,m._)(this,"threshold",void 0),(0,m._)(this,"ledOut",!1),(0,m._)(this,"updated",!0),(0,m._)(this,"analogOut",void 0),(0,m._)(this,"digitalOut",void 0),this.digitalOut=h.get("DO"),this.analogOut=h.get("AO"),this.lux=(0,C.R)(u.get("lux"),S),this.gamma=(0,C.R)(u.get("gamma"),.7),this.threshold=(0,C.R)(u.get("threshold"),2.5);let w=(0,C.R)(u.get("rl10"),50);this.c=Math.log10(1e3*w)+this.gamma,this.luxUpdated()}}(0,m._)(P,"pinNames",["VCC","GND","DO","AO"])},27039:function(o,h,u){u.d(h,{v:function(){return G},O:function(){return W}});var m,w,C=u(75766),S=u(87260),P=u(82465),D=u(96094),I=u(20050),N=u(67938),A=u(34814),B=u(57564);class E{readFloat(){var o;return null!==(o=this.vars.readFloat(this.name))&&void 0!==o?o:this.defaultValue}constructor(o,h,u){(0,C._)(this,"vars",void 0),(0,C._)(this,"name",void 0),(0,C._)(this,"defaultValue",void 0),this.vars=o,this.name=h,this.defaultValue=u}}var U=u(23340),O=u(37991);!function(o){o[o.INPUT=0]="INPUT",o[o.OUTPUT=1]="OUTPUT",o[o.INPUT_PULLUP=2]="INPUT_PULLUP",o[o.INPUT_PULLDOWN=3]="INPUT_PULLDOWN",o[o.ANALOG=4]="ANALOG",o[o.OUTPUT_LOW=16]="OUTPUT_LOW",o[o.OUTPUT_HIGH=17]="OUTPUT_HIGH"}(m||(m={})),function(o){o[o.NONE=0]="NONE",o[o.RISING=1]="RISING",o[o.FALLING=2]="FALLING",o[o.BOTH=3]="BOTH"}(w||(w={}));let L=0,M=1;class V{get mode(){return this._mode}set mode(o){(o===m.OUTPUT_HIGH||o===m.OUTPUT_LOW)&&(this._value=o===m.OUTPUT_HIGH,o=m.OUTPUT),o!==m.ANALOG||isNaN(this._dacValue)||this.pin.node.analogPort.write(this._dacValue),this._mode=o,this.pin.state=this.outputState}get analogMode(){return this.mode===m.ANALOG}get value(){return this._value}set value(o){this._value=o,this.pin.state=this.outputState}get edge(){return this._edge}set edge(o){o&&this.pin.onValueChange(this.listener),this._edge=o}dacWrite(o){this._dacValue=o,this.analogMode&&this.pin.node.analogPort.write(this._dacValue)}get outputState(){switch(this._mode){case m.INPUT:return O.J.HighZ;case m.INPUT_PULLUP:return O.J.PullUp;case m.INPUT_PULLDOWN:return O.J.PullDown;default:return this._value?O.J.High:O.J.Low}}constructor(o,h,u=m.INPUT){(0,C._)(this,"name",void 0),(0,C._)(this,"pin",void 0),(0,C._)(this,"_mode",void 0),(0,C._)(this,"_value",void 0),(0,C._)(this,"_edge",void 0),(0,C._)(this,"_dacValue",void 0),(0,C._)(this,"callback",void 0),(0,C._)(this,"listener",void 0),this.name=o,this.pin=h,this._mode=m.INPUT,this._value=!1,this._edge=0,this._dacValue=NaN,this.callback=()=>{},this.listener=o=>{(o&&this._edge&w.RISING||!o&&this._edge&w.FALLING)&&this.callback(o?M:L)},this.mode=u}}class F{start(o,h){this.bufferPtr=o,this.bufferLen=h,this.bufferIndex=0,this.spi.sendByte(new Uint8Array(this.memory.buffer)[o]),this.spi.paused?this.spi.paused=!1:this.spi.enable()}stop(){this.spi.disable(),this.spiConfig.doneCallback(this.spiConfig.userData,this.bufferPtr,this.bufferIndex)}next(o){let{bufferPtr:h}=this,u=new Uint8Array(this.memory.buffer);u[h+this.bufferIndex]=o,this.bufferIndex++,this.bufferIndex===this.bufferLen?(this.spi.paused=!0,this.spiConfig.doneCallback(this.spiConfig.userData,this.bufferPtr,this.bufferIndex)):this.spi.sendByte(u[h+this.bufferIndex])}constructor(o,h,u){(0,C._)(this,"memory",void 0),(0,C._)(this,"spi",void 0),(0,C._)(this,"spiConfig",void 0),(0,C._)(this,"bufferPtr",void 0),(0,C._)(this,"bufferLen",void 0),(0,C._)(this,"bufferIndex",void 0),this.memory=o,this.spi=h,this.spiConfig=u,this.bufferPtr=0,this.bufferLen=0,this.bufferIndex=0,h.onTransmit=o=>this.next(o)}}let J=!1;function W(){J=!0}class G{callbackPtr(o){var h,u,m,w;let C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0,{instance:S}=this,P=null!==(m=null===(h=S)||void 0===h?void 0:h.exports.__indirect_function_table)&&void 0!==m?m:null===(u=S)||void 0===u?void 0:u.exports.table;return o&&P instanceof WebAssembly.Table&&null!==(w=P.get(o))&&void 0!==w?w:C}traceLog(o,h,u){console.log("[".concat(this.name,"] ").concat(o,"(").concat(h.join(", "),")").concat(u?" -> ".concat(u):""))}traceEvent(o,h){console.log("[".concat(this.name,"] event ").concat(o,"(").concat(h.join(", "),")"))}i2cInit(o){let h=new B.B(new Uint8Array(this.memory().buffer,o)),u=h.readUint32(),m=h.readUint32(),w=h.readUint32(),C=h.readUint32(),S=this.callbackPtr(h.readUint32(),()=>0),P=this.callbackPtr(h.readUint32(),()=>0),I=this.callbackPtr(h.readUint32()),N=this.callbackPtr(h.readUint32()),A=new D.A({scl:this.pinList[w].pin,sda:this.pinList[C].pin},m);A.onConnect=(o,h)=>S(u,o,!h),A.onReadByte=()=>P(u),A.onWriteByte=o=>I(u,o),A.onDisconnect=()=>N(u)}uartInit(o){let h=new B.B(new Uint8Array(this.memory().buffer,o)),u=h.readUint32(),m=h.readUint32(),w=h.readUint32(),C=h.readUint32(),S=this.callbackPtr(h.readUint32(),()=>0),P=this.callbackPtr(h.readUint32(),()=>0);if(!this.clock){console.warn("uartInit() called at invalid time");return}let D={};if(m>=0){let o=new N.g(this.clock,this.pinList[m].pin,C);o.subscribe(o=>{for(let h of o)S(u,h)})}return w>=0&&(D.encoder=new A.x(this.clock,this.pinList[w].pin,C),D.encoder.onTxComplete=()=>{P(u)}),this.uartDevices.push(D),this.uartDevices.length-1}uartWrite(o,h,u){let m=this.uartDevices[o];if(!m||!m.encoder)return console.warn("uart_write_buf() called with invalid uart_dev_t pointer: 0x".concat((0,S.MS)(o))),!1;if(u<1)return console.warn("uart_write_buf() called with invalid buffer size"),!1;if(m.encoder.isBusy)return!1;let w=new Uint8Array(this.memory().buffer).slice(h,h+u);return m.encoder.write(w),!0}spiInit(o){let h=new B.B(new Uint8Array(this.memory().buffer,o)),u={userData:h.readUint32(),sck:h.readInt32(),mosi:h.readInt32(),miso:h.readInt32(),mode:h.readUint32(),doneCallback:this.callbackPtr(h.readUint32(),()=>0)},{spiDevices:m}=this,{sck:w,mosi:C,miso:S,mode:P}=u,D=new I.g({clk:this.pinList[w].pin,mosi:C>=0?this.pinList[C].pin:void 0,miso:S>=0?this.pinList[S].pin:void 0},0===P||1===P||2===P||3===P?P:0),N=m.length;return m.push(new F(this.memory(),D,u)),N}spiStart(o,h,u){return o<0||o>=this.spiDevices.length?(console.warn("spi_start() called with invalid SPI interface: ".concat(o)),-1):(this.spiDevices[o].start(h,u),0)}spiStop(o){return o<0||o>=this.spiDevices.length?(console.warn("spi_stop() called with invalid SPI interface: ".concat(o)),-1):(this.spiDevices[o].stop(),0)}pinInit(o,h){var u,w;let{pinList:C}=this,S=(0,P.V)(this.memory(),o,256),D=null===(u=this.pins)||void 0===u?void 0:u.get(S);return(J&&this.traceLog("pin_init",[S,null!==(w=m[h])&&void 0!==w?w:h.toString()]),D)?(C.push(new V(S,D,h)),C.length-1):-1}pinMode(o,h){if(o<0||o>=this.pinList.length){console.warn("pin_mode() called with invalid pin: ".concat(o));return}let u=this.pinList[o];if(J){var w;this.traceLog("pin_mode",[u.name,null!==(w=m[h])&&void 0!==w?w:h.toString()])}u.mode=h}pinRead(o){if(o<0||o>=this.pinList.length)return console.warn("pin_read() called with invalid pin: ".concat(o)),0;let h=this.pinList[o];return J&&this.traceLog("pin_read",[h.name],h.pin.value?"1":"0"),h.pin.value?1:0}pinWrite(o,h){if(o<0||o>=this.pinList.length){console.warn("pin_write() called with invalid pin: ".concat(o));return}let u=this.pinList[o];J&&this.traceLog("pin_write",[u.name,h?"1":"0"]),u.value=0!==h}pinWatch(o,h){let u=new B.B(new Uint8Array(this.memory().buffer,h)),m={userData:u.readUint32(),edge:u.readUint32(),pinChange:this.callbackPtr(u.readUint32(),()=>0)};if(o<0||o>=this.pinList.length){console.warn("pin_watch() called with invalid pin: ".concat(o));return}let C=this.pinList[o];if(J){var S;this.traceLog("pin_watch",[C.name,null!==(S=w[m.edge])&&void 0!==S?S:m.edge.toString()],C.edge?"false":"true")}return!C.edge&&(C.edge=m.edge,C.callback=h=>{J&&this.traceEvent("pin_chage",[C.name,h?"1":"0"]),m.pinChange(m.userData,o,h)},!0)}pinWatchStop(o){if(o<0||o>=this.pinList.length){console.warn("pin_watch() called with invalid pin: ".concat(o));return}let h=this.pinList[o];J&&this.traceLog("pin_watch_stop",[h.name]),h.edge=0}pinADCRead(o){if(o<0||o>=this.pinList.length)return console.warn("pin_adc_read() called with invalid pin: ".concat(o)),NaN;let h=this.pinList[o];if(!h.analogMode)return console.warn("pin_adc_read() called for pin ".concat(o,", which is not in ANALOG mode. Returning NaN.")),NaN;let u=h.pin.node.analogPort.read();return J&&this.traceLog("pin_adc_read",[h.name],u.toString()),u}pinDACWrite(o,h){if(o<0||o>=this.pinList.length){console.warn("pin_dac_write() called with invalid pin: ".concat(o));return}let u=this.pinList[o];return J&&this.traceLog("pin_dac_write",[u.name,h.toString()]),this.pinList[o].dacWrite(h)}attrInit(o,h){let{attrList:u}=this,m=(0,P.V)(this.memory(),o,256),w=this.attrs.get(m),C=w?parseFloat(w):h;return this.vars?(this.vars.initFloat(m,isNaN(C)?h:C),u.push(new E(this.vars,m,h)),u.length-1):-1}attrRead(o){let{attrList:h}=this;return o<h.length?h[o].readFloat():(console.warn("attr_read() called with invalid value: ".concat(o)),0)}attrStringInit(o){let h=(0,P.V)(this.memory(),o,256),u=this.attrs.get(h);return u?(this.stringList.push(u),this.stringList.length-1):0}attrInitFloat(o,h){return this.attrInit(o,h)}attrReadFloat(o){return this.attrRead(o)}stringGetLength(o){return o<this.stringList.length?this.stringList[o].length:(console.warn("string_get_length() called with invalid value: ".concat(o)),0)}stringRead(o,h,u){if(o<this.stringList.length){let m=this.stringList[o],w=new TextEncoder().encode(m),C=new Uint8Array(this.memory().buffer,h,u);return C.set(w.subarray(0,u-1)),C[Math.min(w.length,u-1)]=0,w.length}return console.warn("string_read() called with invalid value: ".concat(o)),0}getSimNanos(){var o,h;return null!==(h=null===(o=this.clock)||void 0===o?void 0:o.cpuNanos)&&void 0!==h?h:0}timerInit(o){var h;let u=new B.B(new Uint8Array(this.memory().buffer,o)),m={userData:u.readUint32(),callback:this.callbackPtr(u.readUint32(),()=>0)},w=this.timers.length,C=null===(h=this.clock)||void 0===h?void 0:h.createEvent(()=>{m.callback(m.userData);let o=this.timerRepeat[w];if(o){var h;null===(h=C)||void 0===h||h.schedule(o)}});return C?(this.timers.push(C),this.timerRepeat.push(0),w):-1}timerStart(o,h,u){this.timerStartNanos(o,1e3*h,u)}timerStartNanos(o,h,u){var m;null===(m=this.timers[o])||void 0===m||m.schedule(h),this.timerRepeat[o]=u?h:0}timerStop(o){var h;null===(h=this.timers[o])||void 0===h||h.unschedule()}framebufferInit(o,h){let u=this.framebufferWidth,m=this.framebufferHeight,w=new DataView(this.memory().buffer);w.setUint32(o,u,!0),w.setUint32(h,m,!0);let C=this.buffers.indexOf(this.buffer);return C>=0?C:(this.buffers.push(this.buffer),this.buffers.length-1)}bufferRead(o,h,u,m){let w=this.buffers[o].data;if(!w){console.warn("buffer_read() called with invalid buffer: ".concat(o));return}if(h+m>w.length||h<0||m<1){console.warn("buffer_read() out of bounds: offset=".concat(h,", data_len=").concat(m,", size=").concat(w.length));return}new Uint8Array(this.memory().buffer).set(w.slice(h,h+m),u)}bufferWrite(o,h,u,m){let w=this.buffers[o];if(!w){console.warn("buffer_write called with invalid buffer: ".concat(o));return}if(h+m>w.data.length||h<0||m<1){console.warn("buffer_write() out of bounds: offset=".concat(h,", data_len=").concat(m,", buffer_size=").concat(w.data.length));return}w.data.set(new Uint8Array(this.memory().buffer,u,m),h),w.dirty=!0}symbolResolve(o){var h,u;let m=(0,P.V)(this.memory(),o,256);return null!==(u=null===(h=this.debuggerApi.resolveSymbol(m))||void 0===h?void 0:h.value)&&void 0!==u?u:0}mcuReadMemory(o,h,u){let m=new Uint8Array(this.memory().buffer,h,u);for(let h=0;h<u;h++)m[h]=this.debuggerApi.readUint8(o+h);return!0}mcuReadUint32(o){var h;return null!==(h=this.debuggerApi.readUint32(o))&&void 0!==h?h:0}constructor(o,h,u,m){var w,S,P,D;(0,C._)(this,"name",void 0),(0,C._)(this,"memory",void 0),(0,C._)(this,"debuggerApi",void 0),(0,C._)(this,"clock",void 0),(0,C._)(this,"instance",void 0),(0,C._)(this,"pins",void 0),(0,C._)(this,"attrs",void 0),(0,C._)(this,"vars",void 0),(0,C._)(this,"buffer",void 0),(0,C._)(this,"attrList",void 0),(0,C._)(this,"stringList",void 0),(0,C._)(this,"pinList",void 0),(0,C._)(this,"timers",void 0),(0,C._)(this,"timerRepeat",void 0),(0,C._)(this,"uartDevices",void 0),(0,C._)(this,"spiDevices",void 0),(0,C._)(this,"buffers",void 0),(0,C._)(this,"framebufferWidth",void 0),(0,C._)(this,"framebufferHeight",void 0),this.name=o,this.memory=h,this.debuggerApi=m,this.attrs=new Map,this.buffer=new U.l(new Uint8Array(0)),this.attrList=[],this.stringList=[""],this.pinList=[],this.timers=[],this.timerRepeat=[],this.uartDevices=[],this.spiDevices=[],this.buffers=[],this.framebufferWidth=Math.floor(null!==(P=null===(w=u.display)||void 0===w?void 0:w.width)&&void 0!==P?P:0),this.framebufferHeight=Math.floor(null!==(D=null===(S=u.display)||void 0===S?void 0:S.height)&&void 0!==D?D:0)}}},23340:function(o,h,u){u.d(h,{l:function(){return w}});var m=u(75766);class w{constructor(o){(0,m._)(this,"data",void 0),(0,m._)(this,"dirty",void 0),this.data=o,this.dirty=!1}}},12269:function(o,h,u){function m(o){if(!o.startsWith("_Z"))return o;let h=o.slice(2),u=0,m=!1,S="",P="";for(;u<h.length;)switch(h[u]){case"N":m=!0,u++;break;case"I":S+="<",u++;break;case"E":if(m)return m=!1,C(S);S+=">",u++;break;case"C":S+="::"+P,"I"===h[u+1]&&u++,u+=2;break;case"D":S+="::~"+P,u+=2;break;default:{let o=/^\d*/.exec(h.substring(u));if(o){let D=parseInt(o[0],10);if(m&&S.length>0&&(S+="::"),S+=P=w(h.substring(u+o[0].length,u+o[0].length+D)),u+=o[0].length+D,!m)return C(S)}else u++}}return C(S)}function w(o){let h={SP:"@",BP:"*",RF:"&",LT:"<",GT:">",LP:"(",RP:")",C:","};return o.replace(/\.\./g,"::").replace(/_?\$([A-Z]{1,2}|u[0-9a-f]+)\$/g,(o,u)=>{var m;return"u"===u[0]?String.fromCharCode(parseInt(u.slice(1),16)):null!==(m=h[u])&&void 0!==m?m:o})}function C(o){return o.replace(/::h[0-9a-f]+$/,"")}u.d(h,{G:function(){return m}})},86954:function(o,h,u){u.d(h,{$_:function(){return w},H_:function(){return P},KC:function(){return I},NC:function(){return D},Nc:function(){return N},ZY:function(){return m},nX:function(){return A}});let m=I("S02"),w=I("S05");function C(o){return(o>>4).toString(16)+(15&o).toString(16)}function S(o){return C(255&o.split("").map(o=>o.charCodeAt(0)).reduce((o,h)=>o+h,0))}function P(o){let h=new Uint8Array(o.length/2);for(let u=0;u<h.length;u++)h[u]=parseInt(o.substr(2*u,2),16);return h}function D(o){return Array.from(o).map(C).join("")}function I(o){return"+$".concat(o,"#").concat(S(o))}function N(o){return D(new TextEncoder().encode(o))}function A(o){return new TextDecoder().decode(P(o))}},30852:function(o,h,u){var m;u.d(h,{q:function(){return m}}),function(o){o[o.BRG=0]="BRG",o[o.RGBA=1]="RGBA"}(m||(m={}))},16739:function(o,h,u){u.d(h,{E:function(){return w}});var m=u(75766);class w{attach(o){o.state=this.state}get outputEnable(){return!0}constructor(o,h){(0,m._)(this,"name",void 0),(0,m._)(this,"state",void 0),this.name=o,this.state=h}}},93480:function(o,h,u){u.d(h,{n:function(){return C}});var m=u(75766),w=u(37991);class C{attach(o){o.state=w.J.PullUp,o.onValueChange(this.onChange)}constructor(o,h){(0,m._)(this,"name",void 0),(0,m._)(this,"onChange",void 0),(0,m._)(this,"outputEnable",void 0),this.name=o,this.onChange=h,this.outputEnable=!1}}},81e3:function(o,h,u){u.d(h,{Y:function(){return D}});var m=u(75766);let w=Symbol.iterator;class C{[w](){var o;return(null!==(o=this.unionSet)&&void 0!==o?o:this.set)[Symbol.iterator]()}unionWith(o){if(this.unionSet=o,o)for(let h of this.set)o.add(h)}get size(){var o;return(null!==(o=this.unionSet)&&void 0!==o?o:this.set).size}add(o){var h;this.set.add(o),null===(h=this.unionSet)||void 0===h||h.add(o)}delete(o){var h;this.set.delete(o),null===(h=this.unionSet)||void 0===h||h.delete(o)}has(o){var h;return(null!==(h=this.unionSet)&&void 0!==h?h:this.set).has(o)}forEach(o){var h;(null!==(h=this.unionSet)&&void 0!==h?h:this.set).forEach(o)}entries(){var o;return(null!==(o=this.unionSet)&&void 0!==o?o:this.set).entries()}keys(){var o;return(null!==(o=this.unionSet)&&void 0!==o?o:this.set).keys()}values(){var o;return(null!==(o=this.unionSet)&&void 0!==o?o:this.set).values()}get ownPins(){return this.set}constructor(o){(0,m._)(this,"set",void 0),(0,m._)(this,"unionSet",null),this.set=new Set(o)}}var S=u(37991);class P{read(){if(this.hasVoltage)return this.voltage;switch(this.node.state){case S.J.High:case S.J.PullUp:return this.voltage=5,this.high;case S.J.PullDown:case S.J.Low:return this.voltage=0,0;default:return this.voltage=.9*this.voltage+Math.random()*this.high*.1,this.voltage}}readNormalized(){return this.read()/this.high}write(o){if(!this.hasVoltage||o!==this.voltage){this.voltage=o,this.hasVoltage=!0;let h=o/this.high;for(let u of this.listeners)u(o,h)}}writeNormalized(o){this.write(o*this.high)}addListener(o){return this.listeners.add(o),()=>this.listeners.delete(o)}constructor(o){(0,m._)(this,"node",void 0),(0,m._)(this,"high",void 0),(0,m._)(this,"voltage",void 0),(0,m._)(this,"hasVoltage",void 0),(0,m._)(this,"listeners",void 0),this.node=o,this.high=5,this.voltage=Math.random()*this.high,this.hasVoltage=!1,this.listeners=new Set}}class D{get value(){return this.digitalValue}get state(){return this.currentState}get pins(){return this.pinSet}attachPin(o){this.pinSet.add(o)}subscribe(o){return this.listeners.add(o),()=>this.listeners.delete(o)}subscribeState(o){return this.stateListeners.add(o),()=>this.stateListeners.delete(o)}resolve(){let o,h,u=null,m=null,w=null,C=null;for(let o of this.pins)switch(o.internalState){case S.J.Low:m=o;break;case S.J.High:u=o;break;case S.J.PullUp:w=o;break;case S.J.PullDown:C=o}m&&u&&console.warn('Short circuit! pins: "'.concat(m.name,'" and "').concat(u.name,'"'));let P=null;for(let D of(u?(o=!0,h=S.J.High,P=u):m?(o=!1,h=S.J.Low,P=m):w?(o=!0,h=S.J.PullUp,P=w):C?(o=!1,h=S.J.PullDown,P=C):(o=Math.random()>.5,h=S.J.HighZ,P=null),this.bridgedNodes)){let u=D.digitalValue,m=D.currentState;if(D.digitalValue=o,D.currentState=h,D._drivingPin=P,m!==h)for(let o of D.stateListeners)o();if(u!==D.digitalValue){let o=D.digitalValue,{cpuNanos:h}=D.clock,u=h-D.valueChangedNanos;for(let m of(D.valueChangedNanos=h,D.listeners))m(o,{nanos:u})}}}get drivingPin(){return this._drivingPin}updateBridges(){let o=new Set([this]),h=new Set,u=Array.from(this.bridges);for(;u.length;){let m=u.pop();m&&!h.has(m)&&(h.add(m),o.add(m.node),u.push(...m.node.bridges))}if(o.size<2)this.pinSet.unionWith(null),this.bridgedNodes=new Set([this]);else{let h=new Set(this.pinSet.ownPins);for(let u of o)u.pinSet.unionWith(h),u.bridgedNodes=o}this.resolve()}constructor(o){(0,m._)(this,"clock",void 0),(0,m._)(this,"analogPort",void 0),(0,m._)(this,"listeners",void 0),(0,m._)(this,"stateListeners",void 0),(0,m._)(this,"pinSet",void 0),(0,m._)(this,"bridges",void 0),(0,m._)(this,"bridgedNodes",void 0),(0,m._)(this,"digitalValue",void 0),(0,m._)(this,"currentState",void 0),(0,m._)(this,"valueChangedNanos",void 0),(0,m._)(this,"_drivingPin",void 0),this.clock=o,this.analogPort=new P(this),this.listeners=new Set,this.stateListeners=new Set,this.pinSet=new C,this.bridges=new Set,this.bridgedNodes=new Set([this]),this.digitalValue=!1,this.currentState=S.J.HighZ,this._drivingPin=null,this.valueChangedNanos=this.clock.cpuNanos}}},37991:function(o,h,u){u.d(h,{J:function(){return m},U:function(){return C}});var m,w=u(75766);!function(o){o[o.Low=0]="Low",o[o.High=1]="High",o[o.HighZ=2]="HighZ",o[o.PullUp=3]="PullUp",o[o.PullDown=4]="PullDown"}(m||(m={}));class C{get value(){return this.node.value}get driven(){return this.node.state!==m.HighZ}onStateChange(o){return this.node.subscribeState(o)}onValueChange(o){return this.node.subscribe(o)}get state(){return this.node.state}get internalState(){return this.currentState}set state(o){o!==this.currentState&&(this.currentState=o,this.node.resolve())}setState(o){this.state=o}constructor(o,h){(0,w._)(this,"node",void 0),(0,w._)(this,"name",void 0),(0,w._)(this,"currentState",void 0),(0,w._)(this,"protocols",void 0),this.node=o,this.name=h,this.currentState=m.HighZ,this.protocols={},o.attachPin(this)}}},98859:function(o,h,u){u.d(h,{P:function(){return S},t:function(){return m}});var m,w=u(3341),C=u(12269);function S(o,h){let u=100,S=101,P=102,D=[{args:{data:{frameTreeNodeId:2120,frames:[{frame:"451F3E0F876BB3CD3D0CAE2CBB732CD6",name:"",processId:u,url:"https://wokwi.com/"}],persistentIds:!0}},cat:"disabled-by-default-devtools.timeline",name:"TracingStartedInBrowser",ph:"I",pid:u,s:"t",tid:S,ts:0,tts:0},{ph:"M",cat:"__metadata",name:"thread_name",pid:u,tid:S,args:{name:"Main"}}],I=new Map,N=new Map,A=new Map;for(let w of o)switch(w.type){case m.Call:{let o=h.symbolAt(w.pc),u=o&&(0,C.G)(o.name),m=null!=u?u:"0x".concat(w.pc.toString(16));I.set(w.sp,[m,w.ts]);break}case m.Return:let o=I.get(w.sp);o&&(D.push({name:"JSFrame",ph:"X",cat:"disabled-by-default-devtools.timeline",pid:u,tid:S,ts:o[1]/1e3,dur:(w.ts-o[1])/1e3,args:{data:{functionName:o[0]}}}),I.delete(w.sp));break;case m.Interrupt:w.int&&N.set(w.int,w);break;case m.InterruptReturn:{let o=w.int&&N.get(w.int);if(w.int&&o){var B;o.sp!==w.sp&&(A.set(o.sp,S),A.has(w.sp)?S=A.get(w.sp):(S=P++,w.task&&D.push({ph:"M",cat:"__metadata",name:"thread_name",pid:u,tid:S,args:{name:w.task}})));let h=o.ts,m="<vector 0x".concat(null===(B=w.int)||void 0===B?void 0:B.toString(16),">");D.push({name:"JSFrame",ph:"X",cat:"disabled-by-default-devtools.timeline",pid:u,tid:S,ts:h/1e3,dur:(w.ts-h)/1e3,args:{data:{functionName:m}}}),N.delete(w.int)}}}(0,w.Sv)("profile.json","["+D.map(o=>JSON.stringify(o)).join(",\n")+"]")}!function(o){o[o.Call=0]="Call",o[o.Return=1]="Return",o[o.Interrupt=2]="Interrupt",o[o.InterruptReturn=3]="InterruptReturn"}(m||(m={}))},7436:function(o,h,u){u.d(h,{u:function(){return m}});function m(o,h,u){let m=()=>{let o=h,m=0;for(let h of u)o|=h.value?1<<m:0,m++;return o};for(let h of(o.addressFilter=m(),u))h.onValueChange(()=>{o.addressFilter=m()})}},96094:function(o,h,u){u.d(h,{A:function(){return S}});var m,w=u(75766),C=u(37991);!function(o){o[o.Idle=0]="Idle",o[o.Start=1]="Start",o[o.Stop=2]="Stop",o[o.Read=3]="Read",o[o.Write=4]="Write"}(m||(m={}));class S{setHandler(o){this.onConnect=o.i2cConnect.bind(o),this.onReadByte=o.i2cReadByte.bind(o),this.onWriteByte=o.i2cWriteByte.bind(o),this.onDisconnect=o.i2cDisconnect.bind(o)}constructor(o,h=0){(0,w._)(this,"addressFilter",void 0),(0,w._)(this,"outgoingByte",void 0),(0,w._)(this,"incomingByte",void 0),(0,w._)(this,"clockIndex",void 0),(0,w._)(this,"ack",void 0),(0,w._)(this,"firstByte",void 0),(0,w._)(this,"state",void 0),(0,w._)(this,"onStart",void 0),(0,w._)(this,"onConnect",void 0),(0,w._)(this,"onReadByte",void 0),(0,w._)(this,"onWriteByte",void 0),(0,w._)(this,"onDisconnect",void 0),this.addressFilter=h,this.outgoingByte=0,this.incomingByte=0,this.clockIndex=0,this.ack=!1,this.firstByte=!1,this.state=m.Idle;let{scl:u,sda:S}=o;u.setState(C.J.PullUp),S.setState(C.J.PullUp),S.onValueChange(o=>{var h,w,C,S;u.value&&!o&&(this.state=m.Start,this.clockIndex=0,this.incomingByte=0,null===(h=(w=this).onStart)||void 0===h||h.call(w)),u.value&&o&&(this.state=m.Stop,null===(C=(S=this).onDisconnect)||void 0===C||C.call(S))}),u.onValueChange(o=>{var h,u,w,P,D,I,N,A,B;let E=this.state===m.Start,U=this.state===m.Write,O=this.state===m.Read;if(o||S.setState(C.J.PullUp),o&&8===this.clockIndex){this.incomingByte=0,this.clockIndex=0;return}if(E||U){if(o&&this.clockIndex<8)this.incomingByte<<=1,this.incomingByte|=S.value?1:0;else if(!o&&8===this.clockIndex){if(E){let o=this.incomingByte>>>1,C=!(1&this.incomingByte);this.addressFilter&&o!==this.addressFilter?this.ack=!1:this.ack=null!==(w=null===(h=(u=this).onConnect)||void 0===h?void 0:h.call(u,o,C))&&void 0!==w&&w,this.ack?this.state=C?m.Write:m.Read:this.state=m.Idle,this.firstByte=!0}else this.ack=null!==(I=null===(P=(D=this).onWriteByte)||void 0===P?void 0:P.call(D,this.incomingByte))&&void 0!==I&&I;S.setState(this.ack?C.J.Low:C.J.PullUp)}}if(O&&!o&&this.clockIndex<8){if(0===this.clockIndex&&S.value&&!this.firstByte)this.state=m.Idle;else{0===this.clockIndex&&(this.outgoingByte=null!==(B=null===(N=(A=this).onReadByte)||void 0===N?void 0:N.call(A))&&void 0!==B?B:255,this.firstByte=!1);let o=this.outgoingByte&1<<7-this.clockIndex;S.setState(o?C.J.PullUp:C.J.Low)}}o&&this.clockIndex++})}}},20050:function(o,h,u){u.d(h,{g:function(){return C}});var m=u(75766),w=u(37991);class C{sendByte(o){this.outgoingByte=o}constructor(o,h=0,u=!1){var C,S;(0,m._)(this,"outgoingByte",0),(0,m._)(this,"incomingByte",0),(0,m._)(this,"bitIndex",0),(0,m._)(this,"selected",!1),(0,m._)(this,"onTransmit",void 0),(0,m._)(this,"paused",!1),(0,m._)(this,"enable",void 0),(0,m._)(this,"disable",void 0);let P=h>=2,D=1===h||3===h,{ss:I,miso:N,clk:A,mosi:B}=o;null===(C=N)||void 0===C||C.setState(u?w.J.PullUp:w.J.HighZ);let E=u?w.J.PullUp:w.J.High,U=N?()=>{N.setState(this.outgoingByte&1<<7-this.bitIndex?E:w.J.Low)}:()=>0,O=()=>{var o,h,u;this.incomingByte=this.incomingByte<<1|((null===(o=B)||void 0===o?void 0:o.value)?1:0),this.bitIndex++,8===this.bitIndex&&(this.bitIndex=0,this.outgoingByte=0,null===(h=(u=this).onTransmit)||void 0===h||h.call(u,this.incomingByte),this.incomingByte=0)};this.selected=null==I||I.driven&&!1===I.value,this.enable=()=>{this.selected||(this.bitIndex=0,P||U(),this.selected=!0,this.paused=!1)},this.disable=()=>{var o;null===(o=N)||void 0===o||o.setState(u?w.J.PullUp:w.J.HighZ),this.selected=!1},null===(S=I)||void 0===S||S.onStateChange(()=>{var o,h;let u=(null===(o=I)||void 0===o?void 0:o.driven)&&(null===(h=I)||void 0===h?void 0:h.value)===!1;u?this.enable():this.disable()}),A.onValueChange(()=>{if(!this.selected||this.paused)return;let o=P!==A.value;D===o?U():O()})}}},67938:function(o,h,u){u.d(h,{g:function(){return C}});var m=u(75766),w=u(40207);class C{subscribe(o){return this.listeners.add(o),()=>this.listeners.delete(o)}constructor(o,h,u=9600){(0,m._)(this,"baudRate",void 0),(0,m._)(this,"listeners",void 0),(0,m._)(this,"autoBaudRate",void 0),(0,m._)(this,"rxInProgress",void 0),(0,m._)(this,"bits",void 0),(0,m._)(this,"stopBits",void 0),(0,m._)(this,"parity",void 0),this.baudRate=u,this.listeners=new Set,this.autoBaudRate=!1,this.rxInProgress=!1,this.bits=8,this.stopBits=1,this.parity=w.A.None,h.protocols.uartRX=this,h.onValueChange(()=>{if(this.autoBaudRate)for(let o of h.node.pins){let h=o.protocols.uartTX;h&&!h.autoBaudRate&&(this.baudRate=h.baudRate)}let u=1e9/this.baudRate;if(!h.value&&!this.rxInProgress){this.rxInProgress=!0;let m=0,{bits:C}=this;o.addEvent(Math.round(.5*u),()=>{if(h.value){this.rxInProgress=!1;return}for(let w=0;w<C;w++)o.addEvent(Math.round(u*(w+1)),()=>{m|=h.value?1<<w:0});let S=C+this.stopBits;this.parity!==w.A.None&&S++,o.addEvent(Math.round(u*S),()=>{if(h.value)for(let o of this.listeners)o(new Uint8Array([m]));this.rxInProgress=!1})})}})}}},34814:function(o,h,u){u.d(h,{x:function(){return P}});var m=u(75766),w=u(58269),C=u(37991),S=u(40207);class P{transmit(o){let{tx:h,bits:u}=this;if(this.busy)return!1;if(this.autoBaudRate)for(let o of h.node.pins){let h=o.protocols.uartRX;h&&!h.autoBaudRate&&(this.baudRate=h.baudRate)}this.busy=!0;let m=Math.round(1e9/this.baudRate);h.state=C.J.Low;let w=0;for(let S=0;S<u;S++)this.clock.addEvent(m*(S+1),()=>{h.state=o&1<<S?C.J.PullUp:C.J.Low,w^=h.state?1:0});let P=u+1;return this.parity!==S.A.None&&(this.parity===S.A.Odd&&(w^=1),this.clock.addEvent(m*P++,()=>{h.state=w?C.J.PullUp:C.J.Low})),this.clock.addEvent(m*P++,()=>{h.state=C.J.PullUp}),2===this.stopBits&&P++,this.clock.addEvent(m*P++,()=>{this.busy=!1,this.transmitNext()}),!0}transmitNext(){if(this.busy)return;let o=this.fifo.next();if(null!=o)this.transmit(o);else{var h,u;null===(h=(u=this).onTxComplete)||void 0===h||h.call(u)}}write(o){this.fifo.write(o),this.transmitNext()}writeByte(o){this.busy?this.fifo.writeByte(o):this.transmit(o)}get isBusy(){return this.busy}constructor(o,h,u=9600){(0,m._)(this,"clock",void 0),(0,m._)(this,"tx",void 0),(0,m._)(this,"baudRate",void 0),(0,m._)(this,"onTxComplete",void 0),(0,m._)(this,"fifo",void 0),(0,m._)(this,"busy",void 0),(0,m._)(this,"autoBaudRate",void 0),(0,m._)(this,"bits",void 0),(0,m._)(this,"stopBits",void 0),(0,m._)(this,"parity",void 0),this.clock=o,this.tx=h,this.baudRate=u,this.fifo=new w.Q,this.busy=!1,this.autoBaudRate=!1,this.bits=8,this.stopBits=1,this.parity=S.A.None,h.protocols.uartTX=this,h.state=C.J.PullUp}}},40207:function(o,h,u){var m;u.d(h,{A:function(){return m}}),function(o){o[o.None=0]="None",o[o.Odd=1]="Odd",o[o.Even=2]="Even"}(m||(m={}))},94169:function(o,h,u){function m(o,h){let u=/^\d+\.\d+V/.test(h),m=u?h.replace(/\.\d+$/,""):h.split(".")[0];return"".concat(o,":").concat(m)}function w(o){let h=o.split(":");return{partId:h[0],pinName:h[1]}}function C(o,h,u){for(let m of u.pins)h.pins.add(m),o.set(m,h)}function S(o){let h=new Map;for(let{fromPart:u,fromPin:w,toPart:S,toPin:P}of o){let o=m(u,w),D=m(S,P),I=h.get(o)||{pins:new Set([o])},N=h.get(D)||{pins:new Set([D])};h.set(o,I),h.set(D,N),C(h,I,N)}return h}u.d(h,{XP:function(){return S},_N:function(){return w},r4:function(){return m}})},5219:function(o,h,u){u.d(h,{$:function(){return C}});var m=u(75766);class w{pause(){}resume(){}constructor(o){(0,m._)(this,"callback",void 0),this.callback=o}}class C{get micros(){return this.cpuNanos/1e3}get cpuMillis(){return this.cpu.cycles/this.frequency*1e3}get ticks(){return this.cpuNanos}get cpuNanos(){return this.cpu.cycles/this.frequency*1e9}get nanos(){return this.cpuNanos}addEvent(o,h){let u=Math.round(o/1e9*this.frequency);return this.addEventCycles(u,h)}clearEvent(o){let{nextClockEvent:h}=this;if(!h)return!1;let{clockEventPool:u}=this,m=null;for(;h;){if(h.callback===o)return m?m.next=h.next:this.nextClockEvent=h.next,u.length<10&&u.push(h),!0;m=h,h=h.next}return!1}schedule(o,h){return this.addEvent(h,o)}addEventCycles(o,h){let{clockEventPool:u}=this;o=this.cpu.cycles+Math.max(1,o);let m=u.pop(),w=null!=m?m:{cycles:o,callback:h,next:null};w.cycles=o,w.callback=h;let{nextClockEvent:C}=this,S=null;for(;C&&C.cycles<o;)S=C,C=C.next;return S?S.next=w:this.nextClockEvent=w,w.next=C,h}pause(){}resume(){}tick(){let{nextClockEvent:o}=this;o&&o.cycles<=this.cpu.cycles&&(this.nextClockEvent=o.next,this.clockEventPool.length<10&&this.clockEventPool.push(o),o.callback())}createTimer(o,h){let u=new w(h);return this.addEvent(1e3*o,h),u}deleteTimer(o){o instanceof w&&this.clearEvent(o.callback)}createEvent(o){let h=this;return{schedule(u){h.clearEvent(o),h.addEvent(u,o)},unschedule(){h.clearEvent(o)}}}skipToNextEvent(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{nextClockEvent:h}=this;h&&(!o||h.cycles<=o)?(this.cpu.cycles=h.cycles,this.nextClockEvent=h.next,this.clockEventPool.length<10&&this.clockEventPool.push(h),h.callback()):o>this.cpu.cycles&&(this.cpu.cycles=o)}get nextClockEventCycles(){var o,h;return null!==(h=null===(o=this.nextClockEvent)||void 0===o?void 0:o.cycles)&&void 0!==h?h:0}constructor(o=125e6){(0,m._)(this,"frequency",void 0),(0,m._)(this,"nextClockEvent",void 0),(0,m._)(this,"clockEventPool",void 0),(0,m._)(this,"skippedCycles",void 0),(0,m._)(this,"cpu",void 0),(0,m._)(this,"unschedule",void 0),this.frequency=o,this.nextClockEvent=null,this.clockEventPool=[],this.skippedCycles=0,this.cpu={cycles:0},this.unschedule=this.clearEvent}}},4154:function(o,h,u){u.d(h,{O:function(){return S}});var m=u(75766),w=u(26783),C=u(57564);class S{loadText(o){if(o.startsWith("#")){for(let h of o.split(";")){let[o,u]=h.split("="),m=parseInt(u,10);m>0&&"#"===o[0]&&(this.symbols.set(o,{name:o,value:m,size:0}),this.sortedSymbols=null)}return!0}if(!o.startsWith("$wokwisym,version=1\n"))return console.warn("Invalid symbol file format"),!1;let h=!0;for(let u of o.split("\n")){if(h){h=!1;continue}let[o,m]=u.split("="),[w,C]=m.split(",");if(o){let h=decodeURIComponent(o);this.symbols.set(h,{name:h,value:"#"===o[0]?parseInt(w,10):parseInt(w,16),size:parseInt(null!=C?C:"0",16)}),this.sortedSymbols=null}}return!0}loadWokwiSym(o){let h=new C.B(o),u=h.readChars(8),m=h.readUint32(),w=h.readUint32();if("WOKWISYM"!==u||1!==m||0===w||!h.remaining)return!1;for(;h.remaining>0;){let o=h.readUint32(),u=h.readUint32(),m=h.readUint32();if(!m)continue;let w=h.readChars(m);o&&(this.symbols.set(w,{name:w,value:o,size:u}),this.sortedSymbols=null)}}loadELF(o){let h=new w.aX(o);for(let o of h.symbols)this.symbols.set(o.name,{name:o.name,value:o.value,size:o.size}),this.sortedSymbols=null}lookup(o){return this.symbols.get(o)}symbolAt(o){this.sortedSymbols||(this.sortedSymbols=Array.from(this.symbols.values()).filter(o=>o.name.length>0).sort((o,h)=>o.value-h.value));let{sortedSymbols:h}=this,u=0,m=h.length-1;for(;u<=m;){let w=u+m>>1,C=h[w];if(o>=C.value&&o<C.value+C.size)return C;o<C.value?m=w-1:u=w+1}}reset(){this.symbols.clear()}constructor(){(0,m._)(this,"symbols",new Map),(0,m._)(this,"sortedSymbols",null)}}},6678:function(o,h,u){var m,w,C,S;u.d(h,{Eu:function(){return V},HU:function(){return $},JP:function(){return F},Ky:function(){return X},Lc:function(){return M},No:function(){return S},Pc:function(){return H},Qp:function(){return C},Tq:function(){return G},d0:function(){return Z},eN:function(){return L},iq:function(){return w},n4:function(){return Q},tK:function(){return E},yg:function(){return W}}),function(o){o[o.SSID=0]="SSID",o[o.SupportedRates=1]="SupportedRates",o[o.FHParameterSet=2]="FHParameterSet",o[o.DSParameterSet=3]="DSParameterSet",o[o.CFParameterSet=4]="CFParameterSet",o[o.TrafficIndicationMap=5]="TrafficIndicationMap",o[o.IBSSParameterSet=6]="IBSSParameterSet",o[o.Country=7]="Country",o[o.HoppingPatternParameters=8]="HoppingPatternParameters",o[o.HoppingPatternTable=9]="HoppingPatternTable",o[o.Request=10]="Request",o[o.ChallengeText=16]="ChallengeText",o[o.PowerConstraint=32]="PowerConstraint",o[o.PowerCapability=33]="PowerCapability",o[o.TPCRequest=34]="TPCRequest",o[o.TPCReport=35]="TPCReport",o[o.SupportedChannels=36]="SupportedChannels",o[o.ChannelSwitchAnnouncement=37]="ChannelSwitchAnnouncement",o[o.MeasurementRequest=38]="MeasurementRequest",o[o.MeasurementReport=39]="MeasurementReport",o[o.Quiet=40]="Quiet",o[o.IBSSDFS=41]="IBSSDFS",o[o.ERPInformation=42]="ERPInformation",o[o.RobustSecurityNetwork=48]="RobustSecurityNetwork",o[o.ExtendedSupportedRates=50]="ExtendedSupportedRates",o[o.WPA=221]="WPA"}(m||(m={})),function(o){o[o.ToDS=1]="ToDS",o[o.FromDS=2]="FromDS",o[o.MoreFragments=4]="MoreFragments",o[o.Retry=8]="Retry",o[o.PowerManagement=16]="PowerManagement",o[o.MoreData=32]="MoreData",o[o.ProtectedFrame=64]="ProtectedFrame",o[o.Order=128]="Order"}(w||(w={}));let P=[255,255,255,255,255,255];function D(o,h){return[o,h.length,...Array.from(h)]}function I(o){return"undefined"!=typeof TextEncoder?new TextEncoder().encode(o):o.split("").map(o=>o.charCodeAt(0))}function N(o){return"undefined"!=typeof TextDecoder?new TextDecoder().decode(o):Array.from(o).map(o=>String.fromCharCode(o)).join("")}function A(o,h){return o[h+1]<<8|o[h]}function B(o){return[255&o,o>>8&255]}function E(o){let h=o[0]>>2&3,u=o.slice(4,10),m=o.slice(10,16),w=o.slice(16,22);return{version:3&o[0],type:h,subtype:o[0]>>4&15,flags:o[1],duration:(o[3]>>8)+o[2],target:h===C.Data?w:u,source:m,bssid:h===C.Data?u:w}}function U(o,h){return(3&o)<<2|(15&h)<<4}function O(o){let h=0,u=[];for(;h+1<o.length;){let m=o[h++],w=o[h++];o.length>=h+w&&u.push({id:m,value:o.slice(h,h+w)}),h+=w}return u}function L(o){return o.slice(10,16)}function M(o){let h=O(o.subarray(24)),u=h.find(o=>o.id===m.SSID);return{source:L(o),ssid:u?N(u.value):""}}function V(o){return{source:L(o),algorithm:A(o,24),authSeq:A(o,26),status:A(o,28)}}function F(o){let h=O(o.subarray(28)),u=h.find(o=>o.id===m.SSID);return{source:L(o),ssid:u?N(u.value):""}}function J(o,h){let{target:u,bssid:m,seq:w}=h;return[U(C.Management,o),0,0,0,...Array.from(u),...Array.from(m),...Array.from(m),w>>4&255,w<<4&255]}function W(o){let{target:h,ssid:u,bssid:w,seq:C,channel:P}=o;return new Uint8Array([...J(S.ProbeResponse,{target:h,bssid:w,seq:C}),0,0,0,0,0,0,0,0,100,0,33,4,...D(m.SSID,I(u)),...D(m.SupportedRates,[140,18,152,36,176,72,96,108]),...D(m.DSParameterSet,[P])])}function G(o){let{target:h,bssid:u,seq:m,authSeq:w}=o;return new Uint8Array([...J(S.Authentication,{target:h,bssid:u,seq:m}),0,0,...B(w),0,0])}function H(o){let{target:h,bssid:u,seq:w}=o;return new Uint8Array([...J(S.AssociationResponse,{target:h,bssid:u,seq:w}),33,4,0,0,1,192,...D(m.SupportedRates,[140,18,152,36,176,72,96,108])])}function X(o){let{bssid:h,seq:u,channel:w,ssid:C}=o;return new Uint8Array([...J(S.Beacon,{target:P,bssid:h,seq:u}),0,0,0,0,0,0,0,0,100,0,33,4,...D(m.SSID,I(C)),...D(m.SupportedRates,[140,18,152,36,176,72,96,108]),...D(m.DSParameterSet,[w]),...D(m.TrafficIndicationMap,[0,2,0,0,0,0])])}function Q(o){let h=128&o[0];return new Uint8Array([...o.slice(16,22),...o.slice(10,16),...o.slice(h?32:30)])}function Z(o,h){return new Uint8Array([U(C.Data,0),2,0,0,...o.slice(0,6),...Array.from(h),...o.slice(6,12),0,0,170,170,3,0,0,0,...o.slice(12)])}function $(o,h){return new Uint8Array([U(C.Data,0),1,0,0,...Array.from(h),...o.slice(6,12),...o.slice(0,6),0,0,170,170,3,0,0,0,...o.slice(12)])}!function(o){o[o.Management=0]="Management",o[o.Control=1]="Control",o[o.Data=2]="Data"}(C||(C={})),function(o){o[o.AssociationRequest=0]="AssociationRequest",o[o.ReassociationRequest=2]="ReassociationRequest",o[o.ProbeRequest=4]="ProbeRequest",o[o.TimingAdvertisement=6]="TimingAdvertisement",o[o.Beacon=8]="Beacon",o[o.Disassociation=10]="Disassociation",o[o.Deauthentication=12]="Deauthentication",o[o.Authentication=11]="Authentication",o[o.Action=14]="Action",o[o.AssociationResponse=1]="AssociationResponse",o[o.ReassociationResponse=3]="ReassociationResponse",o[o.ProbeResponse=5]="ProbeResponse",o[o.Reserved=7]="Reserved"}(S||(S={}))},61478:function(o,h,u){u.d(h,{Tj:function(){return D},VE:function(){return P},Wl:function(){return C},kB:function(){return S},pj:function(){return w},zh:function(){return m}});let m="__proxy",w="ws://localhost:9011";function C(o){let h=["297588808377958922","300574786540536333","324549257843442260","316487782954435136","334081863635173972","341084517319049811","341045744203989588"];return o.club||h.includes(o.id||"")||"espressif"===o.organization}function S(){try{if(localStorage.getItem(m)===w)return!0}catch(o){}return!1}function P(o){o?localStorage.setItem(m,w):localStorage.removeItem(m)}function D(){return"undefined"!=typeof localStorage?localStorage.getItem(m):null}},54964:function(o,h,u){u.d(h,{a:function(){return m}});function m(){let o=Math.random();return o<.1?-Math.floor(60+10*(o/.1)):o<.3?-Math.floor(70+10*((o-.1)/.2)):o<.7?-Math.floor(80+10*((o-.3)/.4)):-Math.floor(90+10*((o-.7)/.3))}},68490:function(o,h,u){u.d(h,{c:function(){return $}});var m,w,C,S=u(75766),P=u(15191),D=u(6678);let I=1e6,N=100*I;class A{onDataFrame(o,h){}onClientConnected(o){}transmit(o){this.medium.transmit({data:o,channel:this.config.channel})}managementFrame(o,h){let{config:u}=this;switch(o){case D.No.ProbeRequest:{let o=(0,D.Lc)(h);(o.ssid===u.ssid||""===o.ssid)&&this.transmit((0,D.yg)({target:o.source,bssid:u.bssid.bytes,ssid:u.ssid,channel:u.channel,seq:0}));break}case D.No.Deauthentication:this.clients.delete(new P.o((0,D.eN)(h)).toString());break;case D.No.Authentication:{let o=(0,D.Eu)(h);this.transmit((0,D.Tq)({target:o.source,bssid:u.bssid.bytes,seq:0,authSeq:o.authSeq+1}));break}case D.No.AssociationRequest:{let o=(0,D.JP)(h),m=new P.o(o.source);if(!this.clients.has(m.toString())){let o={mac:m};this.clients.set(m.toString(),o),this.onClientConnected(o)}this.transmit((0,D.Pc)({target:o.source,bssid:u.bssid.bytes,seq:0}))}}}constructor(o,h,u){(0,S._)(this,"clock",void 0),(0,S._)(this,"medium",void 0),(0,S._)(this,"config",void 0),(0,S._)(this,"clients",void 0),(0,S._)(this,"onReceive",void 0),(0,S._)(this,"sendBeacon",void 0),this.clock=o,this.medium=h,this.config=u,this.clients=new Map,this.onReceive=o=>{let{data:h,channel:u}=o,{config:m}=this;if(u!==m.channel&&u!==m.channel+2||h.length<10)return;let{type:w,subtype:C,target:S,bssid:I,source:N}=(0,D.tK)(h);switch(w){case D.Qp.Management:m.bssid.match(new P.o(S))&&this.managementFrame(C,h);break;case D.Qp.Data:{let o=new P.o(N).toString(),u=this.clients.get(o),w=4&C;u&&m.bssid.match(new P.o(I))&&!w&&this.onDataFrame(u,h)}}},this.sendBeacon=()=>{let{config:o}=this;this.medium.transmit({channel:o.channel,data:(0,D.Ky)({bssid:o.bssid.bytes,ssid:o.ssid,channel:o.channel,seq:0}),apBeacon:!0}),this.clock.addEvent(N,this.sendBeacon)},this.config.hidden||this.clock.addEvent(N,this.sendBeacon),h.listen(this.onReceive)}}var B=u(19469);class E{toString(){let{bytes:o}=this;return"".concat(o[0],".").concat(o[1],".").concat(o[2],".").concat(o[3])}constructor(o){if((0,S._)(this,"address",void 0),(0,S._)(this,"bytes",void 0),this.address=o,"string"==typeof o){let h=o.split(".");this.bytes=new Uint8Array([parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),parseInt(h[3],10)])}else this.bytes=o.subarray(0,4)}}function U(o){let h={frame:o,frameLength:o.length,etherType:0,packetType:"unknown"};if(o.length<14)return h;h.destinationMAC=new P.o(o.slice(0,6)).toString(),h.sourceMAC=new P.o(o.slice(6,12)).toString(),h.etherType=o[12]<<8|o[13];let u=o.subarray(14);switch(h.etherType){case m.ARP:h.packetType="arp";break;case m.IP:{if(h.packetType="ip",u.length<20)break;let o=(15&u[0])*4;h.protocol=u[9],h.sourceIP=new E(u.slice(12,16)).toString(),h.destinationIP=new E(u.slice(16,20)).toString();let m=u.subarray(o);switch(h.protocol){case w.ICMP:h.packetType="icmp";break;case w.IGMP:h.packetType="igmp";break;case w.TCP:if(h.packetType="tcp",m.length<20)break;h.sourcePort=m[0]<<8|m[1],h.destinationPort=m[2]<<8|m[3];break;case w.UDP:if(h.packetType="udp",m.length<8)break;h.sourcePort=m[0]<<8|m[1],h.destinationPort=m[2]<<8|m[3]}break}case m.IPv6:h.packetType="ip6"}return h}!function(o){o[o.IP=2048]="IP",o[o.ARP=2054]="ARP",o[o.IPv6=34525]="IPv6"}(m||(m={})),function(o){o[o.ICMP=1]="ICMP",o[o.IGMP=2]="IGMP",o[o.TCP=6]="TCP",o[o.UDP=17]="UDP"}(w||(w={}));class O{connect(o){let h=new WebSocket(this.url+"?"+o.toString());h.binaryType="arraybuffer",this.socket=h;let u=!1;h.addEventListener("close",()=>{if(!u){var o,h;null===(o=(h=this).onGatewayError)||void 0===o||o.call(h,"IoT Gateway ".concat(this.url," unexpectedly closed the connection"))}this.socket=void 0}),h.addEventListener("open",()=>{if(this.buffer){for(let o of this.buffer)h.send(o);this.buffer=[]}}),h.addEventListener("message",o=>{let{data:h}=o;if(h instanceof ArrayBuffer){var u,m;null===(u=(m=this).onRecvFrame)||void 0===u||u.call(m,new Uint8Array(h))}else if(this.enableWarning){try{let o=JSON.parse(h);if("aloha"===o.type&&"wokwigw"===o.protocol){console.log("WiFi proxy",o.gatewayVersion),this.gatewayType=o.gatewayVersion.startsWith("netwi")?"public":"private",this.status.setGatewayType(this.gatewayType),(0,B.c)("wifi:connect",{gateway:o.gatewayVersion,gatewayType:this.gatewayType}),(0,B.L)({action:this.gatewayType,category:"wifi",label:o.gatewayVersion});return}}catch(o){}console.warn("Unknown WiFi data",h),this.enableWarning=!1}}),h.addEventListener("error",o=>{var h,m;null===(h=(m=this).onGatewayError)||void 0===h||h.call(m,"Connection to IoT Gateway ".concat(this.url," failed")),console.error("WiFi Internet error",o),u=!0})}get connected(){return null!=this.socket}send(o){var h;let u=U(o);("public"!==this.gatewayType||"udp"!==u.packetType||5353!==u.sourcePort||5353!==u.destinationPort)&&((null===(h=this.socket)||void 0===h?void 0:h.readyState)===WebSocket.OPEN?this.socket.send(o):this.buffer.push(o))}constructor(o,h){(0,S._)(this,"url",void 0),(0,S._)(this,"status",void 0),(0,S._)(this,"socket",void 0),(0,S._)(this,"buffer",void 0),(0,S._)(this,"enableWarning",void 0),(0,S._)(this,"gatewayType",void 0),(0,S._)(this,"onRecvFrame",void 0),this.url=o,this.status=h,this.buffer=[],this.enableWarning=!0,this.gatewayType="public"}}class L extends A{attachGateway(o){this.gateway.onRecvFrame=void 0,this.gateway=o,this.gateway.onRecvFrame=o=>{this.status.onConnected(),this.transmit((0,D.d0)(o,this.config.bssid.bytes))},this.gateway.onGatewayError=o=>{this.status.onGatewayError(o)}}onClientConnected(o){this.connectedClients++,this.gateway.connect(this.proxyParams),this.status.onClientAssociated(this.config.ssid,o)}onDataFrame(o,h){let u=(0,D.n4)(h);this.gateway.send(u)}constructor(o,h,u,m,w){super(o,h,u),(0,S._)(this,"proxy",void 0),(0,S._)(this,"status",void 0),(0,S._)(this,"proxyParams",void 0),(0,S._)(this,"gateway",void 0),(0,S._)(this,"connectedClients",void 0),this.proxy=m,this.status=w,this.proxyParams=new URLSearchParams,this.connectedClients=0,this.gateway=new O(this.proxy,w),this.attachGateway(this.gateway)}}var M=u(61478),V=u(57121),F=u(82463),J=u(25321),W=u(3341);function G(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.IEEE802_11,h=new Uint8Array(24),u=new DataView(h.buffer);return u.setUint32(0,2712812621,!0),u.setUint16(4,2,!0),u.setUint16(6,4,!0),u.setUint16(16,65535,!0),u.setUint16(20,o,!0),h}function H(o){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e6*new Date().getTime(),u=new Uint8Array(16+o.length),m=new DataView(u.buffer);return m.setUint32(0,Math.floor(h/1e9),!0),m.setUint32(4,Math.floor(h%1e9),!0),m.setUint32(8,o.length,!0),m.setUint32(12,o.length,!0),u.set(o,16),u}!function(o){o[o.ETHERNET=1]="ETHERNET",o[o.IEEE802_11=105]="IEEE802_11",o[o.IEEE802_11_RADIOTAP=127]="IEEE802_11_RADIOTAP"}(C||(C={}));var X=new WeakMap;class Q{listen(o){this.listeners.add(o)}transmit(o){for(let h of(this.frames.push({nanos:this.clock.cpuNanos,data:o.data}),this.framesBytes+=o.data.length,this.listeners))h(o)}downloadPcap(){let o=24+16*this.frames.length,h=new Uint8Array(o+this.framesBytes);h.set(G());let u=24;for(let{data:o,nanos:m}of this.frames)h.set(H(o,m),u),u+=16+o.length;(0,W.Sv)("wokwi.pcap",h,"application/vnd.tcpdump.pcap")}constructor(o){var h;(0,S._)(this,"clock",void 0),(0,F._)(this,X,{writable:!0,value:void 0}),(0,S._)(this,"listeners",void 0),(0,S._)(this,"frames",void 0),(0,S._)(this,"framesBytes",void 0),this.clock=o,(0,J._)(this,X,"undefined"!=typeof BroadcastChannel?new BroadcastChannel("WiFi"):void 0),this.listeners=new Set,this.frames=[],this.framesBytes=0,null===(h=(0,V._)(this,X))||void 0===h||h.addEventListener("message",o=>{let h=o.data;for(let o of this.listeners)o(h)}),u.g.downloadPcap=()=>{console.log('To download a PCAP file, press "F1" in the code editor and select "Download WiFi Packet Capture (PCAP) file"')}}}var Z=u(1373);class ${setCredentials(o){for(let h of this.accessPoints)h instanceof L&&(h.proxyParams=new URLSearchParams({u:o.user||"anonymous",p:o.project}))}setGateway(o){for(let h of this.accessPoints)h instanceof L&&h.attachGateway(o)}disconnect(){this.status.reset()}constructor(o){var h;(0,S._)(this,"clock",void 0),(0,S._)(this,"medium",void 0),(0,S._)(this,"accessPoints",void 0),(0,S._)(this,"status",void 0),this.clock=o,this.status=new Z.h,this.medium=new Q(this.clock),this.medium.listen(o=>{this.status.onFrame(o)}),this.accessPoints=[new L(this.clock,this.medium,{channel:6,ssid:"Wokwi-GUEST",bssid:new P.o("42:13:37:55:aa:01"),hidden:!1},null!==(h=(0,M.Tj)())&&void 0!==h?h:"wss://netwi.wokwi.com/",this.status)]}}},1373:function(o,h,u){u.d(h,{h:function(){return I},w:function(){return m}});var m,w=u(75766),C=u(68949),S=u(6678),P=u(61478);let D=21;!function(o){o[o.Disconnected=0]="Disconnected",o[o.Connecting=1]="Connecting",o[o.Connected=2]="Connected",o[o.AccessPointNotFound=3]="AccessPointNotFound",o[o.GatewayError=4]="GatewayError"}(m||(m={}));class I{get state(){return this._state}get errorMessage(){return this._errorMessage}get ssid(){return this._ssid}get gatewayType(){return this._gatewayType}get privateGateway(){return this._privateGateway}get rxFrames(){return this._rxFrames}get rxBytes(){return this._rxBytes}get txFrames(){return this._txFrames}get txBytes(){return this._txBytes}reset(){this._state=m.Disconnected,this._errorMessage="",this._ssid="",this._gatewayType="public",this._privateGateway=!1,this._rxFrames=0,this._rxBytes=0,this._txFrames=0,this._txBytes=0,this.probeRequestCount=0}onFrame(o){this._state!==m.Disconnected||o.apBeacon||(this._state=m.Connecting);let{type:h,subtype:u,flags:w}=(0,S.tK)(o.data);h===S.Qp.Management&&u===S.No.ProbeRequest&&(this.probeRequestCount++,this.probeRequestCount>D&&this._state===m.Connecting&&(this._state=m.AccessPointNotFound)),h===S.Qp.Management&&u===S.No.ProbeResponse&&(this.probeRequestCount=0,this._state===m.AccessPointNotFound&&(this._state=m.Connecting)),h===S.Qp.Data&&(w&S.iq.ToDS&&(this._txFrames++,this._txBytes+=o.data.length),w&S.iq.FromDS&&(this._rxFrames++,this._rxBytes+=o.data.length))}onClientAssociated(o,h){this._ssid=o}onConnected(){this._state=m.Connected,this._errorMessage=""}onGatewayError(o){this._state=m.GatewayError,this._errorMessage=o}setGatewayType(o){this._gatewayType=o}setPrivateGateway(o){(0,P.VE)(o),this._privateGateway=o}constructor(){(0,w._)(this,"_state",m.Disconnected),(0,w._)(this,"_errorMessage",""),(0,w._)(this,"_ssid",""),(0,w._)(this,"_gatewayType","public"),(0,w._)(this,"_privateGateway",!1),(0,w._)(this,"_rxFrames",0),(0,w._)(this,"_rxBytes",0),(0,w._)(this,"_txFrames",0),(0,w._)(this,"_txBytes",0),(0,w._)(this,"probeRequestCount",0),(0,C.ky)(this),this._privateGateway=(0,P.kB)(),window.addEventListener("storage",o=>{o.key===P.zh&&(this._privateGateway=o.newValue===P.pj)})}}},69246:function(o,h,u){function m(){return window.showDirectoryPicker}function w(){return window.showDirectoryPicker()}async function C(o,h){let u=[];for await(let m of o.values())if("directory"===m.kind)u.push(...await C(m,h));else{let o=h(m);o&&"then"in o&&(o=await o),null!=o&&u.push(o)}return u}u.d(h,{Jj:function(){return C},Uf:function(){return m},Y1:function(){return w}})},25025:function(o,h,u){u.d(h,{u:function(){return m}});function m(o,h,u){return o<h?h:o>u?u:o}},79838:function(o,h,u){function m(o){let h=o.replace(/[_,]/g,"").trim().toLowerCase(),u=/^([\d.]+)\s*([mk]|[mk]hz|hz|)$/.exec(h);if(!u)return 0;let[,m,w]=u,C=parseFloat(m);switch(w[0]){case"m":return Math.round(1e6*C);case"k":return Math.round(1e3*C);default:return C}}function w(o){let h="";o>=1e3&&o<1e6?(h="k",o/=1e3):o>=1e6&&o<1e9?(h="m",o/=1e6):o>=1e9&&(h="g",o/=1e9);let u=3,m=o.toFixed(u);for(;u&&(m.endsWith("0")||m.endsWith(".")||m.length>4);)u--,m=o.toFixed(u);return"".concat(m).concat(h)}u.d(h,{Z:function(){return m},w:function(){return w}})},87260:function(o,h,u){function m(o){return o>=16?o.toString(16):"0"+o.toString(16)}function w(o){return m(o>>8&255)+m(255&o)}function C(o){return w(o>>16&65535)+w(65535&o)}u.d(h,{MS:function(){return C},Tf:function(){return w},sA:function(){return m}})},77351:function(o,h,u){u.d(h,{n:function(){return m}});function m(o){return o.length>=113&&127===o[0]&&69===o[1]&&76===o[2]&&70===o[3]}},15191:function(o,h,u){u.d(h,{o:function(){return C}});var m=u(75766),w=u(87260);class C{static valid(o){return/^([0-9a-f]{2}:){5}[0-9a-f]{2}$/i.test(o)}match(o){return o.equals(C.broadcast)||this.equals(o)}equals(o){return o instanceof C&&this.toString()===o.toString()}toString(){var o,h,u,m,C,S;let{bytes:P}=this;return[(0,w.sA)(null!==(o=P[0])&&void 0!==o?o:0),(0,w.sA)(null!==(h=P[1])&&void 0!==h?h:0),(0,w.sA)(null!==(u=P[2])&&void 0!==u?u:0),(0,w.sA)(null!==(m=P[3])&&void 0!==m?m:0),(0,w.sA)(null!==(C=P[4])&&void 0!==C?C:0),(0,w.sA)(null!==(S=P[5])&&void 0!==S?S:0)].join(":")}constructor(o){if((0,m._)(this,"bytes",void 0),"string"==typeof o){let h=o.split(":");this.bytes=new Uint8Array([parseInt(h[0],16),parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16),parseInt(h[4],16),parseInt(h[5],16)])}else this.bytes=o}}(0,m._)(C,"broadcast",new C("ff:ff:ff:ff:ff:ff"))},46888:function(o,h,u){u.d(h,{r:function(){return m}});function m(o,h){return o+Math.round(Math.random()*(h-o))}},82465:function(o,h,u){u.d(h,{V:function(){return m}});function m(o,h){let u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65536,m=new Uint8Array(o.buffer),w=Math.min(m.indexOf(0,h),h+u+1),C=m.subarray(h,w);return new TextDecoder().decode(C)}}}]);